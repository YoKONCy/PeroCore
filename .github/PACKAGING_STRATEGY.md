# PeroCore èµ„æºä¸å¤–éƒ¨åº“æ‰“åŒ…ç­–ç•¥è¯¦è§£

**æ—¥æœŸ**ï¼š2026-01-08  
**ç‰ˆæœ¬**ï¼š1.0  

---

## ğŸ“¦ èµ„æºæ‰“åŒ…é…ç½®

### å½“å‰é…ç½® (`tauri.conf.json`)

```json
"bundle": {
  "resources": [
    "src-tauri/python/**/*",    // Python åµŒå…¥å¼è¿è¡Œæ—¶ + æ‰€æœ‰ä¾èµ–
    "../backend/**/*"            // å®Œæ•´åç«¯ä»£ç  + é™æ€èµ„æº
  ]
}
```

---

## âœ… é™æ€èµ„æºæ‰“åŒ…æƒ…å†µ

### 1ï¸âƒ£ **æç¤ºè¯ .md æ–‡ä»¶** - âœ… **å·²æ‰“åŒ…**

**ä½ç½®**ï¼š`backend/prompts/`  
**å®é™…æ–‡ä»¶**ï¼š
- `scorer_prompt.md` (2.9 KB)

**æ‰“åŒ…è·¯å¾„**ï¼š
```
èµ„æºé…ç½®: "../backend/**/*"
  â†“
åŒ…å«: backend/prompts/scorer_prompt.md
  â†“
æ‰“åŒ…åˆ°: resources/backend/prompts/scorer_prompt.md
```

**éªŒè¯æ–¹æ³•**ï¼š
å®‰è£… MSI åæ£€æŸ¥ï¼š
```powershell
dir "C:\Program Files\PeroCore\resources\backend\prompts\"
```

---

### 2ï¸âƒ£ **å…¶ä»–é™æ€èµ„æº** - âœ… **å·²æ‰“åŒ…**

æ ¹æ® `backend/` ç›®å½•ç»“æ„ï¼Œä»¥ä¸‹æ‰€æœ‰å†…å®¹éƒ½ä¼šè¢«æ‰“åŒ…ï¼š

| ç›®å½•/æ–‡ä»¶ | å†…å®¹ | è¯´æ˜ |
|-----------|------|------|
| `backend/core/**` | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ | âœ… æ‰“åŒ… |
| `backend/services/**` | 46+ ä¸ªæœåŠ¡æ¨¡å— | âœ… æ‰“åŒ… |
| `backend/models/**` | 7 ä¸ªæ¨¡å‹å®šä¹‰ | âœ… æ‰“åŒ… |
| `backend/prompts/**` | æç¤ºè¯æ¨¡æ¿ | âœ… æ‰“åŒ… |
| `backend/nit_core/**` | NIT æ™ºèƒ½å·¥å…·ç³»ç»Ÿ | âœ… æ‰“åŒ… |
| `backend/utils/**` | å·¥å…·å‡½æ•° | âœ… æ‰“åŒ… |
| `backend/main.py` | åç«¯å…¥å£æ–‡ä»¶ | âœ… æ‰“åŒ… |
| `backend/config.json` | é…ç½®æ–‡ä»¶ | âœ… æ‰“åŒ… |
| `backend/requirements.txt` | ä¾èµ–æ¸…å•ï¼ˆä»…ä½œå‚è€ƒï¼Œå®é™…ä¾èµ–å·²å®‰è£…åˆ° Pythonï¼‰ | âœ… æ‰“åŒ… |

**æ³¨æ„**ï¼šä»¥ä¸‹ç›®å½•**ä¸ä¼š**æ‰“åŒ…ï¼ˆä¸å½±å“è¿è¡Œï¼‰ï¼š
- `backend/venv/` - å¼€å‘ç¯å¢ƒè™šæ‹Ÿç¯å¢ƒï¼ˆç”Ÿäº§ç”¨åµŒå…¥å¼ Pythonï¼‰
- `backend/__pycache__/` - ç¼–è¯‘ç¼“å­˜ï¼ˆä¼šåœ¨è¿è¡Œæ—¶é‡æ–°ç”Ÿæˆï¼‰
- `backend/data/` - è¿è¡Œæ—¶æ•°æ®ï¼ˆåº”ç”±ç”¨æˆ·ç”Ÿæˆï¼‰
- `backend/temp_*` - ä¸´æ—¶æ–‡ä»¶å¤¹

---

## ğŸ”Œ å¤–éƒ¨åº“æ‰“åŒ…ç­–ç•¥

### ç­–ç•¥æ¦‚è¿°

PeroCore é‡‡ç”¨ **"æŒ‰éœ€ä¸‹è½½ + ç”¨æˆ·è‡ªå®šä¹‰"** çš„æ··åˆç­–ç•¥ï¼š

| ä¾èµ–ç±»å‹ | æ‰“åŒ…ç­–ç•¥ | åŸå›  |
|----------|----------|------|
| **Python è¿è¡Œæ—¶** | âœ… é¢„æ‰“åŒ… | æ ¸å¿ƒä¾èµ–ï¼Œå¿…é¡»å†…ç½® |
| **Python ç¬¬ä¸‰æ–¹åº“** | âœ… é¢„æ‰“åŒ… | é¿å…é¦–æ¬¡å¯åŠ¨æ…¢ï¼Œç½‘ç»œä¾èµ– |
| **NapCat (QQ åè®®)** | ğŸ”½ é¦–æ¬¡å¯åŠ¨ä¸‹è½½ | ä½“ç§¯å¤§ (~50MB)ï¼Œéå¼ºåˆ¶åŠŸèƒ½ |
| **Everything æœç´¢** | ğŸ”½ é¦–æ¬¡å¯åŠ¨ä¸‹è½½ | å°å·¥å…· (~600KB)ï¼ŒæŒ‰éœ€ä½¿ç”¨ |
| **Node.js** | âš ï¸ å¯é€‰æ‰“åŒ…/ä¸‹è½½ | ä»… NapCat éœ€è¦ |

---

## ğŸ“¥ NapCat æ‰“åŒ…ç­–ç•¥è¯¦è§£

### 1ï¸âƒ£ **ç­–ç•¥ï¼šé¦–æ¬¡å¯åŠ¨è‡ªåŠ¨ä¸‹è½½**

**å®ç°ä½ç½®**ï¼š`PeroLauncher/src/napcat.rs`

**ä¸‹è½½è§¦å‘æ¡ä»¶**ï¼š
```rust
// æ£€æŸ¥æ˜¯å¦å·²å®‰è£…
pub fn check_napcat_installed() -> bool {
    let dir = get_napcat_dir();  
    // backend/nit_core/plugins/social_adapter/NapCat
    
    let exe = dir.join("NapCat.Shell.exe");
    let mjs = dir.join("napcat.mjs");
    exe.exists() || mjs.exists()
}
```

**ä¸‹è½½æ—¶æœº**ï¼š
- ç”¨æˆ·åœ¨ Dashboard ä¸­ç‚¹å‡»"å®‰è£… NapCat"æŒ‰é’®
- ORï¼šåç«¯æœåŠ¡å°è¯•å¯åŠ¨ NapCat æ—¶æ£€æµ‹ä¸å­˜åœ¨

**ä¸‹è½½æº**ï¼š
```rust
// ä¸»æºï¼ˆGitHub Releaseï¼‰
let url = "https://github.com/NapNeko/NapCatQQ/releases/download/v4.10.10/NapCat.Shell.Windows.Node.zip";

// å¤‡ç”¨é•œåƒï¼ˆå›½å†…åŠ é€Ÿï¼‰
let mirror = "https://mirror.ghproxy.com/https://github.com/...";
```

**å®‰è£…ä½ç½®**ï¼š
```
backend/nit_core/plugins/social_adapter/NapCat/
  â”œâ”€â”€ NapCat.Shell.exe        (ä¸»æ‰§è¡Œæ–‡ä»¶)
  â”œâ”€â”€ napcat.mjs              (Node.js æ¨¡å¼)
  â”œâ”€â”€ index.js                (æ—§ç‰ˆå…¥å£)
  â”œâ”€â”€ node_modules/           (ä¾èµ–)
  â””â”€â”€ config/                 (é…ç½®æ–‡ä»¶)
```

**ä¸ºä»€ä¹ˆä¸é¢„æ‰“åŒ…**ï¼š
1. **ä½“ç§¯é—®é¢˜**ï¼šNapCat + Node.js â‰ˆ 50-80 MBï¼Œä¼šæ˜¾è‘—å¢åŠ å®‰è£…åŒ…å¤§å°
2. **éå¿…éœ€åŠŸèƒ½**ï¼šç¤¾äº¤è¿æ¥åŠŸèƒ½å¯é€‰ï¼Œä¸æ˜¯æ¯ä¸ªç”¨æˆ·éƒ½éœ€è¦
3. **æ›´æ–°é¢‘ç¹**ï¼šNapCat ç‰ˆæœ¬è¿­ä»£å¿«ï¼ŒæŒ‰éœ€ä¸‹è½½å¯çµæ´»æ›´æ–°
4. **è®¸å¯è¯éš”ç¦»**ï¼šç¬¬ä¸‰æ–¹ä¾èµ–ç‹¬ç«‹ä¸‹è½½ï¼Œé¿å…æ½œåœ¨è®¸å¯é—®é¢˜

---

### 2ï¸âƒ£ **æ£€æµ‹é€»è¾‘**

**å¯åŠ¨æ—¶æ£€æŸ¥**ï¼š
```rust
// lib.rs æ³¨å†Œçš„å‘½ä»¤
check_napcat()           // æ£€æŸ¥æ˜¯å¦å·²å®‰è£…
install_napcat()         // ä¸‹è½½å¹¶å®‰è£…
start_napcat()           // å¯åŠ¨æœåŠ¡
```

**å‰ç«¯è°ƒç”¨æµç¨‹** (æ¨æµ‹ Dashboard é€»è¾‘)ï¼š
```javascript
// 1. æ£€æŸ¥
const installed = await invoke('check_napcat');

if (!installed) {
  // 2. æç¤ºç”¨æˆ·ä¸‹è½½
  showInstallDialog();
  
  // 3. ç”¨æˆ·ç¡®è®¤åä¸‹è½½
  await invoke('install_napcat');
}

// 4. å¯åŠ¨
await invoke('start_napcat');
```

---

## ğŸ” Everything æœç´¢å·¥å…·ç­–ç•¥

### ç­–ç•¥ï¼šé¦–æ¬¡ä½¿ç”¨ä¸‹è½½

**å®ç°ä½ç½®**ï¼š`PeroLauncher/src/everything.rs`

**ä¸‹è½½æº**ï¼š
```rust
let url = "https://www.voidtools.com/ES-1.1.0.27.x64.zip";
```

**å®‰è£…ä½ç½®**ï¼š
```
backend/nit_core/tools/core/FileSearch/
  â””â”€â”€ es.exe  (ä»… 600 KB å·¦å³)
```

**è§¦å‘æ—¶æœº**ï¼š
- ç”¨æˆ·åœ¨ Dashboard ç‚¹å‡»"å®‰è£…æ–‡ä»¶æœç´¢å·¥å…·"
- ORï¼šåç«¯æœåŠ¡å°è¯•ä½¿ç”¨æ–‡ä»¶æœç´¢åŠŸèƒ½æ—¶æ£€æµ‹ç¼ºå¤±

**ä¸ºä»€ä¹ˆä¸é¢„æ‰“åŒ…**ï¼š
1. ä½“ç§¯å°ï¼ˆå¯ä»¥æ‰“åŒ…ï¼‰ï¼Œä½†ä¸ºäº†ä¿æŒç­–ç•¥ä¸€è‡´æ€§
2. å®˜æ–¹æ›´æ–°é¢‘ç¹ï¼ŒæŒ‰éœ€ä¸‹è½½ç¡®ä¿æœ€æ–°ç‰ˆæœ¬
3. éæ ¸å¿ƒåŠŸèƒ½ï¼Œä¸å½±å“åŸºç¡€ä½¿ç”¨

---

## ğŸ¯ å¯¹æ¯”ï¼šå®Œæ•´æ‰“åŒ… vs æŒ‰éœ€ä¸‹è½½

### âœ… **å®Œæ•´æ‰“åŒ…çš„å¥½å¤„** (å½“å‰ç­–ç•¥)

**Python ç”Ÿæ€**ï¼š
- âœ… æ— éœ€ç½‘ç»œå³å¯è¿è¡Œ
- âœ… é¿å… pip å®‰è£…å¤±è´¥ï¼ˆå›½å†…ç½‘ç»œé—®é¢˜ï¼‰
- âœ… é¦–æ¬¡å¯åŠ¨é€Ÿåº¦å¿«
- âœ… ä¾èµ–ç‰ˆæœ¬å®Œå…¨å¯æ§

**æç¤ºè¯ç­‰é™æ€èµ„æº**ï¼š
- âœ… ä¿è¯æ ¸å¿ƒåŠŸèƒ½å¯ç”¨
- âœ… é¿å…è·¯å¾„é…ç½®é—®é¢˜
- âœ… ç¦»çº¿å¯ç”¨

---

### ğŸ”½ **æŒ‰éœ€ä¸‹è½½çš„å¥½å¤„** (NapCat/Everything)

**å¤–éƒ¨å·¥å…·**ï¼š
- âœ… å®‰è£…åŒ…ä½“ç§¯å°ï¼ˆMSI < 200 MB vs > 300 MBï¼‰
- âœ… åŠŸèƒ½æ¨¡å—åŒ–ï¼ˆç”¨æˆ·é€‰æ‹©å®‰è£…ï¼‰
- âœ… æ›´æ–°çµæ´»ï¼ˆæ— éœ€é‡æ–°æ‰“åŒ…æ•´ä¸ªåº”ç”¨ï¼‰
- âœ… è®¸å¯è¯æ¸…æ™°ï¼ˆç¬¬ä¸‰æ–¹å·¥å…·ç‹¬ç«‹ç®¡ç†ï¼‰

---

## ğŸ“Š æ‰“åŒ…äº§ç‰©å¤§å°ä¼°ç®—

### å½“å‰é…ç½®é¢„è®¡å¤§å°

```
MSI å®‰è£…åŒ… (Windows x64)
â”œâ”€â”€ Tauri æ¡†æ¶ + Rust äºŒè¿›åˆ¶           ~15 MB
â”œâ”€â”€ å‰ç«¯ Vue.js åº”ç”¨                  ~10 MB
â”œâ”€â”€ Python 3.10 åµŒå…¥å¼è¿è¡Œæ—¶           ~30 MB
â”œâ”€â”€ Python ä¾èµ– (PyTorch, FastAPIç­‰)  ~500 MB
â”œâ”€â”€ Backend ä»£ç  + æç¤ºè¯              ~5 MB
â””â”€â”€ å›¾æ ‡ã€é…ç½®ç­‰                       ~2 MB
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
æ€»è®¡                                  ~562 MB

âš ï¸ æ³¨æ„ï¼šå®é™…å¤§å°å–å†³äº backend/requirements.txt
   å¦‚æœåŒ…å« PyTorchï¼Œå¯èƒ½è¾¾åˆ° 800 MB+
```

---

## ğŸ”§ ä¼˜åŒ–å»ºè®®

### 1ï¸âƒ£ **Python ä¾èµ–ç²¾ç®€** (å¯é€‰)

å¦‚æœ MSI è¿‡å¤§ï¼Œå¯è€ƒè™‘ï¼š
```powershell
# ä»…å®‰è£… CPU ç‰ˆæœ¬çš„æ·±åº¦å­¦ä¹ åº“
pip install torch --index-url https://download.pytorch.org/whl/cpu
```

### 2ï¸âƒ£ **æŒ‰æ¨¡å—æ‰“åŒ…** (æœªæ¥ä¼˜åŒ–)

å¯ä»¥å°†ä¸åŒåŠŸèƒ½åˆ†æˆå¤šä¸ªå®‰è£…åŒ…ï¼š
- `PeroCore-Base.msi` - åŸºç¡€åŠŸèƒ½ï¼ˆæ—  AIï¼‰
- `PeroCore-AI.msi` - AI æ‰©å±•ï¼ˆPyTorch ç­‰ï¼‰
- `PeroCore-Social.msi` - ç¤¾äº¤è¿æ¥ï¼ˆNapCatï¼‰

### 3ï¸âƒ£ **å¢é‡æ›´æ–°** (æœªæ¥ä¼˜åŒ–)

ä½¿ç”¨ Tauri Updater å®ç°ï¼š
- ä»…ä¸‹è½½å˜æ›´çš„æ–‡ä»¶
- å‡å°‘ç”¨æˆ·å‡çº§æµé‡

---

## ğŸ“ éªŒè¯æ¸…å•

### é™æ€èµ„æºéªŒè¯

å®‰è£… MSI åæ‰§è¡Œï¼š
```powershell
# 1. æ£€æŸ¥ Python
dir "C:\Program Files\PeroCore\resources\python\python.exe"

# 2. æ£€æŸ¥åç«¯ä»£ç 
dir "C:\Program Files\PeroCore\resources\backend\main.py"

# 3. æ£€æŸ¥æç¤ºè¯
dir "C:\Program Files\PeroCore\resources\backend\prompts\*.md"

# 4. æ£€æŸ¥æ¨¡å—
dir "C:\Program Files\PeroCore\resources\backend\services\"
dir "C:\Program Files\PeroCore\resources\backend\core\"
```

### å¤–éƒ¨åº“éªŒè¯

```powershell
# 1. é¦–æ¬¡å¯åŠ¨ - NapCat åº”è¯¥ä¸å­˜åœ¨
dir "C:\Program Files\PeroCore\resources\backend\nit_core\plugins\social_adapter\NapCat\" 
# é¢„æœŸï¼šä¸å­˜åœ¨

# 2. ç‚¹å‡»å®‰è£…å
dir "C:\Program Files\PeroCore\resources\backend\nit_core\plugins\social_adapter\NapCat\NapCat.Shell.exe"
# é¢„æœŸï¼šå­˜åœ¨
```

---

## ğŸ¯ æ€»ç»“

### é—®é¢˜ 1ï¼šæç¤ºè¯ .md ç­‰é™æ€èµ„æºæ˜¯å¦æ‰“åŒ…ï¼Ÿ
**âœ… æ˜¯çš„ï¼**

é€šè¿‡ `"../backend/**/*"` é…ç½®ï¼Œä»¥ä¸‹æ‰€æœ‰å†…å®¹éƒ½ä¼šæ‰“åŒ…ï¼š
- `backend/prompts/*.md` (æç¤ºè¯)
- `backend/core/` (æ ¸å¿ƒé€»è¾‘)
- `backend/services/` (æœåŠ¡)
- `backend/models/` (æ¨¡å‹å®šä¹‰)
- `backend/nit_core/` (å·¥å…·ç³»ç»Ÿ)
- æ‰€æœ‰ `.py`ã€`.json`ã€`.md`ã€`.txt` ç­‰æ–‡ä»¶

---

### é—®é¢˜ 2ï¼šNapCat çš„æ‰“åŒ…ç­–ç•¥ï¼Ÿ
**ğŸ”½ ç”¨æˆ·é¦–æ¬¡ä½¿ç”¨æ—¶è‡ªåŠ¨ä¸‹è½½**

åŸå› ï¼š
- ä½“ç§¯å¤§ (~50-80 MB)
- éå¼ºåˆ¶åŠŸèƒ½
- æ›´æ–°é¢‘ç¹
- è®¸å¯è¯ç‹¬ç«‹

æµç¨‹ï¼š
1. ç”¨æˆ·å¯åŠ¨ PeroCore
2. å°è¯•ä½¿ç”¨ç¤¾äº¤åŠŸèƒ½ â†’ æ£€æµ‹ NapCat ä¸å­˜åœ¨
3. æç¤ºç”¨æˆ·ä¸‹è½½ â†’ ä» GitHub Release è‡ªåŠ¨ä¸‹è½½
4. è§£å‹åˆ° `backend/nit_core/plugins/social_adapter/NapCat/`
5. å¯åŠ¨æœåŠ¡

---

**å…³é”®ç»“è®º**ï¼š
- âœ… **æ ¸å¿ƒèµ„æºå…¨éƒ¨æ‰“åŒ…**ï¼ˆPythonã€Backend ä»£ç ã€æç¤ºè¯ï¼‰
- ğŸ”½ **å¤–éƒ¨å·¥å…·æŒ‰éœ€ä¸‹è½½**ï¼ˆNapCatã€Everythingï¼‰
- ğŸ¯ **å…¼é¡¾ä½“ç§¯å’ŒåŠŸèƒ½** - å®‰è£…åŒ…ä½“ç§¯å¯æ§ï¼Œé¦–æ¬¡å¯åŠ¨å¿«
