var Fl=Object.defineProperty;var $l=(n,t,e)=>t in n?Fl(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var k=(n,t,e)=>$l(n,typeof t!="symbol"?t+"":t,e);import{j as m,h as H,k as ye,g as Wi}from"./codemirror-core-DIzFijqu.js";import{c as Xi,d as Hl,b as ot,p as zl,m as Vl,i as Gl,j as Kl,n as Zl,o as Wl}from"./index-tO5nu8Yv.js";import{D as Xl,aH as gn,n as Yl,H as Yi,x as li,t as Ql,r as Jl,v as to,_ as cs,c as eo}from"./react-dom-BT-HHJs9.js";import{p as Qi,j as oi,q as so,i as Ji,s as Vn,t as tl,u as yr,a as ro,v as no,w as io,x as lo,S as oo,y as ao,f as co,z as uo,g as ho,h as fo,m as Ne}from"./_baseIsEqual-DpqT7ENi.js";import{t as yt}from"./chunk-6LIX6LVT-BOuIs8hJ.js";import{u as po}from"./use-dialog-B1H9r95P.js";import{i as Vt}from"./chunk-2QAN2V2R-CXqfx2Mo.js";import{p as Dt,a as Ut,b as Pt}from"./chunk-2QQAR2RD-B5zbPDun.js";import{d as go,e as mo}from"./index-DhICtZLt.js";import{o as ai,p as bo,q as yo}from"./index-COqcsWk-.js";import{e as xr,f as Nr,g as vo,h as xo,i as No,j as Eo}from"./index-DZDDEAAG.js";import{g as Ao,h as wo}from"./index-3atF2w48.js";import{i as To}from"./chunk-MLPFQTYO-lAEKjCEv.js";import{l as ci}from"./qface-CqvgXw72.js";import{i as Lo}from"./index-BbUFirlM.js";import{F as Co}from"./chunk-SLABUSGS-Kc2I43iC.js";import{t as So,a as ui,s as qo,l as ko}from"./chunk-KVDW62ZT-DlWCkB-8.js";import{u as Oo,C as Ts}from"./react-hook-form-D03iFOdR.js";import{e as hi,f as Io}from"./code_editor-CGQ3u1wT.js";import{G as Ro}from"./iconBase-ClXMXqAg.js";var _o=n=>m.jsxs("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",viewBox:"0 0 24 24",width:"1em",...n,children:[m.jsx("path",{d:"M16 17.1c0 3.5-1.4 4.9-4.9 4.9H6.9C3.4 22 2 20.6 2 17.1v-4.2C2 9.4 3.4 8 6.9 8h4.2c3.5 0 4.9 1.4 4.9 4.9Z"}),m.jsx("path",{d:"M8 8V6.9C8 3.4 9.4 2 12.9 2h4.2C20.6 2 22 3.4 22 6.9v4.2c0 3.5-1.4 4.9-4.9 4.9H16"}),m.jsx("path",{d:"M16 12.9C16 9.4 14.6 8 11.1 8"})]}),jo=n=>m.jsx("svg",{"aria-hidden":"true",fill:"none",focusable:"false",height:"1em",role:"presentation",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,viewBox:"0 0 24 24",width:"1em",...n,children:m.jsx("polyline",{points:"20 6 9 17 4 12"})}),Mo=H.forwardRef(function(t,e){var s,r;const i=Xi(),o=(r=(s=t.validationBehavior)!=null?s:i==null?void 0:i.validationBehavior)!=null?r:"aria";return m.jsx(Co,{...t,ref:e,validationBehavior:o})}),Bo=Object.prototype,Do=Bo.hasOwnProperty;function Uo(n){var t=n.length,e=new n.constructor(t);return t&&typeof n[0]=="string"&&Do.call(n,"index")&&(e.index=n.index,e.input=n.input),e}function Po(n,t){var e=Qi(n.buffer);return new n.constructor(e,n.byteOffset,n.byteLength)}var Fo=/\w*$/;function $o(n){var t=new n.constructor(n.source,Fo.exec(n));return t.lastIndex=n.lastIndex,t}var di=oi?oi.prototype:void 0,fi=di?di.valueOf:void 0;function Ho(n){return fi?Object(fi.call(n)):{}}var zo="[object Boolean]",Vo="[object Date]",Go="[object Map]",Ko="[object Number]",Zo="[object RegExp]",Wo="[object Set]",Xo="[object String]",Yo="[object Symbol]",Qo="[object ArrayBuffer]",Jo="[object DataView]",ta="[object Float32Array]",ea="[object Float64Array]",sa="[object Int8Array]",ra="[object Int16Array]",na="[object Int32Array]",ia="[object Uint8Array]",la="[object Uint8ClampedArray]",oa="[object Uint16Array]",aa="[object Uint32Array]";function ca(n,t,e){var s=n.constructor;switch(t){case Qo:return Qi(n);case zo:case Vo:return new s(+n);case Jo:return Po(n);case ta:case ea:case sa:case ra:case na:case ia:case la:case oa:case aa:return so(n,e);case Go:return new s;case Ko:case Xo:return new s(n);case Zo:return $o(n);case Wo:return new s;case Yo:return Ho(n)}}var ua="[object Map]";function ha(n){return Ji(n)&&Vn(n)==ua}var pi=yr&&yr.isMap,da=pi?tl(pi):ha,fa="[object Set]";function pa(n){return Ji(n)&&Vn(n)==fa}var gi=yr&&yr.isSet,ga=gi?tl(gi):pa,ma=1,el="[object Arguments]",ba="[object Array]",ya="[object Boolean]",va="[object Date]",xa="[object Error]",sl="[object Function]",Na="[object GeneratorFunction]",Ea="[object Map]",Aa="[object Number]",rl="[object Object]",wa="[object RegExp]",Ta="[object Set]",La="[object String]",Ca="[object Symbol]",Sa="[object WeakMap]",qa="[object ArrayBuffer]",ka="[object DataView]",Oa="[object Float32Array]",Ia="[object Float64Array]",Ra="[object Int8Array]",_a="[object Int16Array]",ja="[object Int32Array]",Ma="[object Uint8Array]",Ba="[object Uint8ClampedArray]",Da="[object Uint16Array]",Ua="[object Uint32Array]",ht={};ht[el]=ht[ba]=ht[qa]=ht[ka]=ht[ya]=ht[va]=ht[Oa]=ht[Ia]=ht[Ra]=ht[_a]=ht[ja]=ht[Ea]=ht[Aa]=ht[rl]=ht[wa]=ht[Ta]=ht[La]=ht[Ca]=ht[Ma]=ht[Ba]=ht[Da]=ht[Ua]=!0;ht[xa]=ht[sl]=ht[Sa]=!1;function gr(n,t,e,s,r,i){var o,a=t&ma;if(o!==void 0)return o;if(!ro(n))return n;var u=ho(n);if(u)o=Uo(n);else{var h=Vn(n),b=h==sl||h==Na;if(no(n))return io(n,a);if(h==rl||h==el||b&&!r)o=b?{}:lo(n);else{if(!ht[h])return r?n:{};o=ca(n,h,a)}}i||(i=new oo);var v=i.get(n);if(v)return v;i.set(n,o),ga(n)?n.forEach(function(y){o.add(gr(y,t,e,y,n,i))}):da(n)&&n.forEach(function(y,N){o.set(N,gr(y,t,e,N,n,i))});var d=ao,f=u?void 0:d(n);return co(f||n,function(y,N){f&&(N=y,y=n[N]),uo(o,N,gr(y,t,e,N,n,i))}),o}var Pa=1,Fa=4;function es(n){return gr(n,Pa|Fa)}function Gn(n,t){return fo(n,t)}var U=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(U||{});class ne{constructor(t,e,s={}){this.attrName=t,this.keyName=e;const r=U.TYPE&U.ATTRIBUTE;this.scope=s.scope!=null?s.scope&U.LEVEL|r:U.ATTRIBUTE,s.whitelist!=null&&(this.whitelist=s.whitelist)}static keys(t){return Array.from(t.attributes).map(e=>e.name)}add(t,e){return this.canAdd(t,e)?(t.setAttribute(this.keyName,e),!0):!1}canAdd(t,e){return this.whitelist==null?!0:typeof e=="string"?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class ss extends Error{constructor(t){t="[Parchment] "+t,super(t),this.message=t,this.name=this.constructor.name}}const nl=class Cn{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(t==null)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let s=null;try{s=t.parentNode}catch{return null}return this.find(s,e)}return null}create(t,e,s){const r=this.query(e);if(r==null)throw new ss(`Unable to create ${e} blot`);const i=r,o=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:i.create(s),a=new i(t,o,s);return Cn.blots.set(a.domNode,a),a}find(t,e=!1){return Cn.find(t,e)}query(t,e=U.ANY){let s;return typeof t=="string"?s=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?s=this.types.text:typeof t=="number"?t&U.LEVEL&U.BLOCK?s=this.types.block:t&U.LEVEL&U.INLINE&&(s=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some(r=>(s=this.classes[r],!!s)),s=s||this.tags[t.tagName]),s==null?null:"scope"in s&&e&U.LEVEL&s.scope&&e&U.TYPE&s.scope?s:null}register(...t){return t.map(e=>{const s="blotName"in e,r="attrName"in e;if(!s&&!r)throw new ss("Invalid definition");if(s&&e.blotName==="abstract")throw new ss("Cannot register abstract class");const i=s?e.blotName:r?e.attrName:void 0;return this.types[i]=e,r?typeof e.keyName=="string"&&(this.attributes[e.keyName]=e):s&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(o=>o.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(o=>{(this.tags[o]==null||e.className==null)&&(this.tags[o]=e)}))),e})}};nl.blots=new WeakMap;let ns=nl;function mi(n,t){return(n.getAttribute("class")||"").split(/\s+/).filter(e=>e.indexOf(`${t}-`)===0)}class $a extends ne{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(t,e){return this.canAdd(t,e)?(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0):!1}remove(t){mi(t,this.keyName).forEach(e=>{t.classList.remove(e)}),t.classList.length===0&&t.removeAttribute("class")}value(t){const e=(mi(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}}const Wt=$a;function mn(n){const t=n.split("-"),e=t.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("");return t[0]+e}class Ha extends ne{static keys(t){return(t.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(t,e){return this.canAdd(t,e)?(t.style[mn(this.keyName)]=e,!0):!1}remove(t){t.style[mn(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[mn(this.keyName)];return this.canAdd(t,e)?e:""}}const Ee=Ha;class za{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(t.value(this.domNode)!=null?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=ns.find(this.domNode);if(t==null)return;const e=ne.keys(this.domNode),s=Wt.keys(this.domNode),r=Ee.keys(this.domNode);e.concat(s).concat(r).forEach(i=>{const o=t.scroll.query(i,U.ATTRIBUTE);o instanceof ne&&(this.attributes[o.attrName]=o)})}copy(t){Object.keys(this.attributes).forEach(e=>{const s=this.attributes[e].value(this.domNode);t.format(e,s)})}move(t){this.copy(t),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t),{})}}const Er=za,il=class{constructor(t,e){this.scroll=t,this.domNode=e,ns.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(this.tagName==null)throw new ss("Blot definition missing tagName");let e,s;return Array.isArray(this.tagName)?(typeof t=="string"?(s=t.toUpperCase(),parseInt(s,10).toString()===s&&(s=parseInt(s,10))):typeof t=="number"&&(s=t),typeof s=="number"?e=document.createElement(this.tagName[s-1]):s&&this.tagName.indexOf(s)>-1?e=document.createElement(s):e=document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){this.parent!=null&&this.parent.removeChild(this),ns.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,s,r){const i=this.isolate(t,e);if(this.scroll.query(s,U.BLOT)!=null&&r)i.wrap(s,r);else if(this.scroll.query(s,U.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);i.wrap(o),o.format(s,r)}}insertAt(t,e,s){const r=s==null?this.scroll.create("text",e):this.scroll.create(e,s),i=this.split(t);this.parent.insertBefore(r,i||void 0)}isolate(t,e){const s=this.split(t);if(s==null)throw new Error("Attempt to isolate at end");return s.split(e),s}length(){return 1}offset(t=this.parent){return this.parent==null||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const s=typeof t=="string"?this.scroll.create(t,e):t;return this.parent!=null&&(this.parent.insertBefore(s,this.next||void 0),this.remove()),s}split(t,e){return t===0?this:this.next}update(t,e){}wrap(t,e){const s=typeof t=="string"?this.scroll.create(t,e):t;if(this.parent!=null&&this.parent.insertBefore(s,this.next||void 0),typeof s.appendChild!="function")throw new ss(`Cannot wrap ${t}`);return s.appendChild(this),s}};il.blotName="abstract";let ll=il;const ol=class extends ll{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let s=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(s+=1),[this.parent.domNode,s]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};ol.scope=U.INLINE_BLOT;let Va=ol;const Tt=Va;class Ga{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let s=e();for(;s&&t>0;)t-=1,s=e();return s}contains(t){const e=this.iterator();let s=e();for(;s;){if(s===t)return!0;s=e()}return!1}indexOf(t){const e=this.iterator();let s=e(),r=0;for(;s;){if(s===t)return r;r+=1,s=e()}return-1}insertBefore(t,e){t!=null&&(this.remove(t),t.next=e,e!=null?(t.prev=e.prev,e.prev!=null&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,s=this.head;for(;s!=null;){if(s===t)return e;e+=s.length(),s=s.next}return-1}remove(t){this.contains(t)&&(t.prev!=null&&(t.prev.next=t.next),t.next!=null&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return t!=null&&(t=t.next),e}}find(t,e=!1){const s=this.iterator();let r=s();for(;r;){const i=r.length();if(t<i||e&&t===i&&(r.next==null||r.next.length()!==0))return[r,t];t-=i,r=s()}return[null,0]}forEach(t){const e=this.iterator();let s=e();for(;s;)t(s),s=e()}forEachAt(t,e,s){if(e<=0)return;const[r,i]=this.find(t);let o=t-i;const a=this.iterator(r);let u=a();for(;u&&o<t+e;){const h=u.length();t>o?s(u,t-o,Math.min(e,o+h-t)):s(u,0,Math.min(h,t+e-o)),o+=h,u=a()}}map(t){return this.reduce((e,s)=>(e.push(t(s)),e),[])}reduce(t,e){const s=this.iterator();let r=s();for(;r;)e=t(e,r),r=s();return e}}function bi(n,t){const e=t.find(n);if(e)return e;try{return t.create(n)}catch{const s=t.create(U.INLINE);return Array.from(n.childNodes).forEach(r=>{s.domNode.appendChild(r)}),n.parentNode&&n.parentNode.replaceChild(s.domNode,n),s.attach(),s}}const al=class be extends ll{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach(t=>{t.attach()})}attachUI(t){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=t,be.uiClass&&this.uiNode.classList.add(be.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new Ga,Array.from(this.domNode.childNodes).filter(t=>t!==this.uiNode).reverse().forEach(t=>{try{const e=bi(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(e){if(e instanceof ss)return;throw e}})}deleteAt(t,e){if(t===0&&e===this.length())return this.remove();this.children.forEachAt(t,e,(s,r,i)=>{s.deleteAt(r,i)})}descendant(t,e=0){const[s,r]=this.children.find(e);return t.blotName==null&&t(s)||t.blotName!=null&&s instanceof t?[s,r]:s instanceof be?s.descendant(t,r):[null,-1]}descendants(t,e=0,s=Number.MAX_VALUE){let r=[],i=s;return this.children.forEachAt(e,s,(o,a,u)=>{(t.blotName==null&&t(o)||t.blotName!=null&&o instanceof t)&&r.push(o),o instanceof be&&(r=r.concat(o.descendants(t,a,i))),i-=u}),r}detach(){this.children.forEach(t=>{t.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(e=>{t||this.statics.allowedChildren.some(s=>e instanceof s)||(e.statics.scope===U.BLOCK_BLOT?(e.next!=null&&this.splitAfter(e),e.prev!=null&&this.splitAfter(e.prev),e.parent.unwrap(),t=!0):e instanceof be?e.unwrap():e.remove())})}formatAt(t,e,s,r){this.children.forEachAt(t,e,(i,o,a)=>{i.formatAt(o,a,s,r)})}insertAt(t,e,s){const[r,i]=this.children.find(t);if(r)r.insertAt(i,e,s);else{const o=s==null?this.scroll.create("text",e):this.scroll.create(e,s);this.appendChild(o)}}insertBefore(t,e){t.parent!=null&&t.parent.children.remove(t);let s=null;this.children.insertBefore(t,e||null),t.parent=this,e!=null&&(s=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==s)&&this.domNode.insertBefore(t.domNode,s),t.attach()}length(){return this.children.reduce((t,e)=>t+e.length(),0)}moveChildren(t,e){this.children.forEach(s=>{t.insertBefore(s,e)})}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(t,e=!1){const[s,r]=this.children.find(t,e),i=[[this,t]];return s instanceof be?i.concat(s.path(r,e)):(s!=null&&i.push([s,r]),i)}removeChild(t){this.children.remove(t)}replaceWith(t,e){const s=typeof t=="string"?this.scroll.create(t,e):t;return s instanceof be&&this.moveChildren(s),super.replaceWith(s)}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const s=this.clone();return this.parent&&this.parent.insertBefore(s,this.next||void 0),this.children.forEachAt(t,this.length(),(r,i,o)=>{const a=r.split(i,e);a!=null&&s.appendChild(a)}),s}splitAfter(t){const e=this.clone();for(;t.next!=null;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const s=[],r=[];t.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(s.push(...i.addedNodes),r.push(...i.removedNodes))}),r.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(i);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),s.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,o)=>i===o?0:i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let o=null;i.nextSibling!=null&&(o=this.scroll.find(i.nextSibling));const a=bi(i,this.scroll);(a.next!==o||a.next==null)&&(a.parent!=null&&a.parent.removeChild(this),this.insertBefore(a,o||void 0))}),this.enforceAllowedChildren()}};al.uiClass="";let Ka=al;const Kt=Ka;function Za(n,t){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(n[e]!==t[e])return!1;return!0}const Ge=class Ke extends Kt{static create(t){return super.create(t)}static formats(t,e){const s=e.query(Ke.blotName);if(!(s!=null&&t.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new Er(this.domNode)}format(t,e){if(t===this.statics.blotName&&!e)this.children.forEach(s=>{s instanceof Ke||(s=s.wrap(Ke.blotName,!0)),this.attributes.copy(s)}),this.unwrap();else{const s=this.scroll.query(t,U.INLINE);if(s==null)return;s instanceof ne?this.attributes.attribute(s,e):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e)}}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,s,r){this.formats()[s]!=null||this.scroll.query(s,U.ATTRIBUTE)?this.isolate(t,e).format(s,r):super.formatAt(t,e,s,r)}optimize(t){super.optimize(t);const e=this.formats();if(Object.keys(e).length===0)return this.unwrap();const s=this.next;s instanceof Ke&&s.prev===this&&Za(e,s.formats())&&(s.moveChildren(this),s.remove())}replaceWith(t,e){const s=super.replaceWith(t,e);return this.attributes.copy(s),s}update(t,e){super.update(t,e),t.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}wrap(t,e){const s=super.wrap(t,e);return s instanceof Ke&&this.attributes.move(s),s}};Ge.allowedChildren=[Ge,Tt],Ge.blotName="inline",Ge.scope=U.INLINE_BLOT,Ge.tagName="SPAN";let Wa=Ge;const Kn=Wa,Ze=class Sn extends Kt{static create(t){return super.create(t)}static formats(t,e){const s=e.query(Sn.blotName);if(!(s!=null&&t.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new Er(this.domNode)}format(t,e){const s=this.scroll.query(t,U.BLOCK);s!=null&&(s instanceof ne?this.attributes.attribute(s,e):t===this.statics.blotName&&!e?this.replaceWith(Sn.blotName):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,s,r){this.scroll.query(s,U.BLOCK)!=null?this.format(s,r):super.formatAt(t,e,s,r)}insertAt(t,e,s){if(s==null||this.scroll.query(e,U.INLINE)!=null)super.insertAt(t,e,s);else{const r=this.split(t);if(r!=null){const i=this.scroll.create(e,s);r.parent.insertBefore(i,r)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(t,e){const s=super.replaceWith(t,e);return this.attributes.copy(s),s}update(t,e){super.update(t,e),t.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}};Ze.blotName="block",Ze.scope=U.BLOCK_BLOT,Ze.tagName="P",Ze.allowedChildren=[Kn,Ze,Tt];let Xa=Ze;const Rs=Xa,qn=class extends Kt{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,s,r){super.formatAt(t,e,s,r),this.enforceAllowedChildren()}insertAt(t,e,s){super.insertAt(t,e,s),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};qn.blotName="container",qn.scope=U.BLOCK_BLOT;let Ya=qn;const Ar=Ya;class Qa extends Tt{static formats(t,e){}format(t,e){super.formatAt(0,this.length(),t,e)}formatAt(t,e,s,r){t===0&&e===this.length()?this.format(s,r):super.formatAt(t,e,s,r)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Ot=Qa,Ja={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},tc=100,We=class extends Kt{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver(s=>{this.update(s)}),this.observer.observe(this.domNode,Ja),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const s=this.registry.find(t,e);return s?s.scroll===this?s:e?this.find(s.scroll.domNode.parentNode,!0):null:null}query(t,e=U.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),t===0&&e===this.length()?this.children.forEach(s=>{s.remove()}):super.deleteAt(t,e)}formatAt(t,e,s,r){this.update(),super.formatAt(t,e,s,r)}insertAt(t,e,s){this.update(),super.insertAt(t,e,s)}optimize(t=[],e={}){super.optimize(e);const s=e.mutationsMap||new WeakMap;let r=Array.from(this.observer.takeRecords());for(;r.length>0;)t.push(r.pop());const i=(u,h=!0)=>{u==null||u===this||u.domNode.parentNode!=null&&(s.has(u.domNode)||s.set(u.domNode,[]),h&&i(u.parent))},o=u=>{s.has(u.domNode)&&(u instanceof Kt&&u.children.forEach(o),s.delete(u.domNode),u.optimize(e))};let a=t;for(let u=0;a.length>0;u+=1){if(u>=tc)throw new Error("[Parchment] Maximum optimize iterations reached");for(a.forEach(h=>{const b=this.find(h.target,!0);b!=null&&(b.domNode===h.target&&(h.type==="childList"?(i(this.find(h.previousSibling,!1)),Array.from(h.addedNodes).forEach(v=>{const d=this.find(v,!1);i(d,!1),d instanceof Kt&&d.children.forEach(f=>{i(f,!1)})})):h.type==="attributes"&&i(b.prev)),i(b))}),this.children.forEach(o),a=Array.from(this.observer.takeRecords()),r=a.slice();r.length>0;)t.push(r.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const s=new WeakMap;t.map(r=>{const i=this.find(r.target,!0);return i==null?null:s.has(i.domNode)?(s.get(i.domNode).push(r),null):(s.set(i.domNode,[r]),i)}).forEach(r=>{r!=null&&r!==this&&s.has(r.domNode)&&r.update(s.get(r.domNode)||[],e)}),e.mutationsMap=s,s.has(this.domNode)&&super.update(s.get(this.domNode),e),this.optimize(t,e)}};We.blotName="scroll",We.defaultChild=Rs,We.allowedChildren=[Rs,Ar],We.scope=U.BLOCK_BLOT,We.tagName="DIV";let ec=We;const Zn=ec,kn=class cl extends Tt{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,s){s==null?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,s)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof cl&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const s=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(s,this.next||void 0),this.text=this.statics.value(this.domNode),s}update(t,e){t.some(s=>s.type==="characterData"&&s.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};kn.blotName="text",kn.scope=U.INLINE_BLOT;let sc=kn;const vr=sc,rc=Object.freeze(Object.defineProperty({__proto__:null,Attributor:ne,AttributorStore:Er,BlockBlot:Rs,ClassAttributor:Wt,ContainerBlot:Ar,EmbedBlot:Ot,InlineBlot:Kn,LeafBlot:Tt,ParentBlot:Kt,Registry:ns,Scope:U,ScrollBlot:Zn,StyleAttributor:Ee,TextBlot:vr},Symbol.toStringTag,{value:"Module"}));var lr={exports:{}},bn,yi;function nc(){if(yi)return bn;yi=1;var n=-1,t=1,e=0;function s(g,C,x,O,S){if(g===C)return g?[[e,g]]:[];if(x!=null){var T=dt(g,C,x);if(T)return T}var q=a(g,C),M=g.substring(0,q);g=g.substring(q),C=C.substring(q),q=h(g,C);var P=g.substring(g.length-q);g=g.substring(0,g.length-q),C=C.substring(0,C.length-q);var R=r(g,C);return M&&R.unshift([e,M]),P&&R.push([e,P]),I(R,S),O&&v(R),R}function r(g,C){var x;if(!g)return[[t,C]];if(!C)return[[n,g]];var O=g.length>C.length?g:C,S=g.length>C.length?C:g,T=O.indexOf(S);if(T!==-1)return x=[[t,O.substring(0,T)],[e,S],[t,O.substring(T+S.length)]],g.length>C.length&&(x[0][0]=x[2][0]=n),x;if(S.length===1)return[[n,g],[t,C]];var q=b(g,C);if(q){var M=q[0],P=q[1],R=q[2],G=q[3],z=q[4],K=s(M,R),Y=s(P,G);return K.concat([[e,z]],Y)}return i(g,C)}function i(g,C){for(var x=g.length,O=C.length,S=Math.ceil((x+O)/2),T=S,q=2*S,M=new Array(q),P=new Array(q),R=0;R<q;R++)M[R]=-1,P[R]=-1;M[T+1]=0,P[T+1]=0;for(var G=x-O,z=G%2!==0,K=0,Y=0,F=0,ct=0,ut=0;ut<S;ut++){for(var Z=-ut+K;Z<=ut-Y;Z+=2){var nt=T+Z,Q;Z===-ut||Z!==ut&&M[nt-1]<M[nt+1]?Q=M[nt+1]:Q=M[nt-1]+1;for(var et=Q-Z;Q<x&&et<O&&g.charAt(Q)===C.charAt(et);)Q++,et++;if(M[nt]=Q,Q>x)Y+=2;else if(et>O)K+=2;else if(z){var it=T+G-Z;if(it>=0&&it<q&&P[it]!==-1){var st=x-P[it];if(Q>=st)return o(g,C,Q,et)}}}for(var pt=-ut+F;pt<=ut-ct;pt+=2){var it=T+pt,st;pt===-ut||pt!==ut&&P[it-1]<P[it+1]?st=P[it+1]:st=P[it-1]+1;for(var mt=st-pt;st<x&&mt<O&&g.charAt(x-st-1)===C.charAt(O-mt-1);)st++,mt++;if(P[it]=st,st>x)ct+=2;else if(mt>O)F+=2;else if(!z){var nt=T+G-pt;if(nt>=0&&nt<q&&M[nt]!==-1){var Q=M[nt],et=T+Q-nt;if(st=x-st,Q>=st)return o(g,C,Q,et)}}}}return[[n,g],[t,C]]}function o(g,C,x,O){var S=g.substring(0,x),T=C.substring(0,O),q=g.substring(x),M=C.substring(O),P=s(S,T),R=s(q,M);return P.concat(R)}function a(g,C){if(!g||!C||g.charAt(0)!==C.charAt(0))return 0;for(var x=0,O=Math.min(g.length,C.length),S=O,T=0;x<S;)g.substring(T,S)==C.substring(T,S)?(x=S,T=x):O=S,S=Math.floor((O-x)/2+x);return B(g.charCodeAt(S-1))&&S--,S}function u(g,C){var x=g.length,O=C.length;if(x==0||O==0)return 0;x>O?g=g.substring(x-O):x<O&&(C=C.substring(0,x));var S=Math.min(x,O);if(g==C)return S;for(var T=0,q=1;;){var M=g.substring(S-q),P=C.indexOf(M);if(P==-1)return T;q+=P,(P==0||g.substring(S-q)==C.substring(0,q))&&(T=q,q++)}}function h(g,C){if(!g||!C||g.slice(-1)!==C.slice(-1))return 0;for(var x=0,O=Math.min(g.length,C.length),S=O,T=0;x<S;)g.substring(g.length-S,g.length-T)==C.substring(C.length-S,C.length-T)?(x=S,T=x):O=S,S=Math.floor((O-x)/2+x);return X(g.charCodeAt(g.length-S))&&S--,S}function b(g,C){var x=g.length>C.length?g:C,O=g.length>C.length?C:g;if(x.length<4||O.length*2<x.length)return null;function S(Y,F,ct){for(var ut=Y.substring(ct,ct+Math.floor(Y.length/4)),Z=-1,nt="",Q,et,it,st;(Z=F.indexOf(ut,Z+1))!==-1;){var pt=a(Y.substring(ct),F.substring(Z)),mt=h(Y.substring(0,ct),F.substring(0,Z));nt.length<mt+pt&&(nt=F.substring(Z-mt,Z)+F.substring(Z,Z+pt),Q=Y.substring(0,ct-mt),et=Y.substring(ct+pt),it=F.substring(0,Z-mt),st=F.substring(Z+pt))}return nt.length*2>=Y.length?[Q,et,it,st,nt]:null}var T=S(x,O,Math.ceil(x.length/4)),q=S(x,O,Math.ceil(x.length/2)),M;if(!T&&!q)return null;q?T?M=T[4].length>q[4].length?T:q:M=q:M=T;var P,R,G,z;g.length>C.length?(P=M[0],R=M[1],G=M[2],z=M[3]):(G=M[0],z=M[1],P=M[2],R=M[3]);var K=M[4];return[P,R,G,z,K]}function v(g){for(var C=!1,x=[],O=0,S=null,T=0,q=0,M=0,P=0,R=0;T<g.length;)g[T][0]==e?(x[O++]=T,q=P,M=R,P=0,R=0,S=g[T][1]):(g[T][0]==t?P+=g[T][1].length:R+=g[T][1].length,S&&S.length<=Math.max(q,M)&&S.length<=Math.max(P,R)&&(g.splice(x[O-1],0,[n,S]),g[x[O-1]+1][0]=t,O--,O--,T=O>0?x[O-1]:-1,q=0,M=0,P=0,R=0,S=null,C=!0)),T++;for(C&&I(g),L(g),T=1;T<g.length;){if(g[T-1][0]==n&&g[T][0]==t){var G=g[T-1][1],z=g[T][1],K=u(G,z),Y=u(z,G);K>=Y?(K>=G.length/2||K>=z.length/2)&&(g.splice(T,0,[e,z.substring(0,K)]),g[T-1][1]=G.substring(0,G.length-K),g[T+1][1]=z.substring(K),T++):(Y>=G.length/2||Y>=z.length/2)&&(g.splice(T,0,[e,G.substring(0,Y)]),g[T-1][0]=t,g[T-1][1]=z.substring(0,z.length-Y),g[T+1][0]=n,g[T+1][1]=G.substring(Y),T++),T++}T++}}var d=/[^a-zA-Z0-9]/,f=/\s/,y=/[\r\n]/,N=/\n\r?\n$/,w=/^\r?\n\r?\n/;function L(g){function C(Y,F){if(!Y||!F)return 6;var ct=Y.charAt(Y.length-1),ut=F.charAt(0),Z=ct.match(d),nt=ut.match(d),Q=Z&&ct.match(f),et=nt&&ut.match(f),it=Q&&ct.match(y),st=et&&ut.match(y),pt=it&&Y.match(N),mt=st&&F.match(w);return pt||mt?5:it||st?4:Z&&!Q&&et?3:Q||et?2:Z||nt?1:0}for(var x=1;x<g.length-1;){if(g[x-1][0]==e&&g[x+1][0]==e){var O=g[x-1][1],S=g[x][1],T=g[x+1][1],q=h(O,S);if(q){var M=S.substring(S.length-q);O=O.substring(0,O.length-q),S=M+S.substring(0,S.length-q),T=M+T}for(var P=O,R=S,G=T,z=C(O,S)+C(S,T);S.charAt(0)===T.charAt(0);){O+=S.charAt(0),S=S.substring(1)+T.charAt(0),T=T.substring(1);var K=C(O,S)+C(S,T);K>=z&&(z=K,P=O,R=S,G=T)}g[x-1][1]!=P&&(P?g[x-1][1]=P:(g.splice(x-1,1),x--),g[x][1]=R,G?g[x+1][1]=G:(g.splice(x+1,1),x--))}x++}}function I(g,C){g.push([e,""]);for(var x=0,O=0,S=0,T="",q="",M;x<g.length;){if(x<g.length-1&&!g[x][1]){g.splice(x,1);continue}switch(g[x][0]){case t:S++,q+=g[x][1],x++;break;case n:O++,T+=g[x][1],x++;break;case e:var P=x-S-O-1;if(C){if(P>=0&&V(g[P][1])){var R=g[P][1].slice(-1);if(g[P][1]=g[P][1].slice(0,-1),T=R+T,q=R+q,!g[P][1]){g.splice(P,1),x--;var G=P-1;g[G]&&g[G][0]===t&&(S++,q=g[G][1]+q,G--),g[G]&&g[G][0]===n&&(O++,T=g[G][1]+T,G--),P=G}}if(j(g[x][1])){var R=g[x][1].charAt(0);g[x][1]=g[x][1].slice(1),T+=R,q+=R}}if(x<g.length-1&&!g[x][1]){g.splice(x,1);break}if(T.length>0||q.length>0){T.length>0&&q.length>0&&(M=a(q,T),M!==0&&(P>=0?g[P][1]+=q.substring(0,M):(g.splice(0,0,[e,q.substring(0,M)]),x++),q=q.substring(M),T=T.substring(M)),M=h(q,T),M!==0&&(g[x][1]=q.substring(q.length-M)+g[x][1],q=q.substring(0,q.length-M),T=T.substring(0,T.length-M)));var z=S+O;T.length===0&&q.length===0?(g.splice(x-z,z),x=x-z):T.length===0?(g.splice(x-z,z,[t,q]),x=x-z+1):q.length===0?(g.splice(x-z,z,[n,T]),x=x-z+1):(g.splice(x-z,z,[n,T],[t,q]),x=x-z+2)}x!==0&&g[x-1][0]===e?(g[x-1][1]+=g[x][1],g.splice(x,1)):x++,S=0,O=0,T="",q="";break}}g[g.length-1][1]===""&&g.pop();var K=!1;for(x=1;x<g.length-1;)g[x-1][0]===e&&g[x+1][0]===e&&(g[x][1].substring(g[x][1].length-g[x-1][1].length)===g[x-1][1]?(g[x][1]=g[x-1][1]+g[x][1].substring(0,g[x][1].length-g[x-1][1].length),g[x+1][1]=g[x-1][1]+g[x+1][1],g.splice(x-1,1),K=!0):g[x][1].substring(0,g[x+1][1].length)==g[x+1][1]&&(g[x-1][1]+=g[x+1][1],g[x][1]=g[x][1].substring(g[x+1][1].length)+g[x+1][1],g.splice(x+1,1),K=!0)),x++;K&&I(g,C)}function B(g){return g>=55296&&g<=56319}function X(g){return g>=56320&&g<=57343}function j(g){return X(g.charCodeAt(0))}function V(g){return B(g.charCodeAt(g.length-1))}function tt(g){for(var C=[],x=0;x<g.length;x++)g[x][1].length>0&&C.push(g[x]);return C}function J(g,C,x,O){return V(g)||j(O)?null:tt([[e,g],[n,C],[t,x],[e,O]])}function dt(g,C,x){var O=typeof x=="number"?{index:x,length:0}:x.oldRange,S=typeof x=="number"?null:x.newRange,T=g.length,q=C.length;if(O.length===0&&(S===null||S.length===0)){var M=O.index,P=g.slice(0,M),R=g.slice(M),G=S?S.index:null;t:{var z=M+q-T;if(G!==null&&G!==z||z<0||z>q)break t;var K=C.slice(0,z),Y=C.slice(z);if(Y!==R)break t;var F=Math.min(M,z),ct=P.slice(0,F),ut=K.slice(0,F);if(ct!==ut)break t;var Z=P.slice(F),nt=K.slice(F);return J(ct,Z,nt,R)}t:{if(G!==null&&G!==M)break t;var Q=M,K=C.slice(0,Q),Y=C.slice(Q);if(K!==P)break t;var et=Math.min(T-Q,q-Q),it=R.slice(R.length-et),st=Y.slice(Y.length-et);if(it!==st)break t;var Z=R.slice(0,R.length-et),nt=Y.slice(0,Y.length-et);return J(P,Z,nt,it)}}if(O.length>0&&S&&S.length===0)t:{var ct=g.slice(0,O.index),it=g.slice(O.index+O.length),F=ct.length,et=it.length;if(q<F+et)break t;var ut=C.slice(0,F),st=C.slice(q-et);if(ct!==ut||it!==st)break t;var Z=g.slice(F,T-et),nt=C.slice(F,q-et);return J(ct,Z,nt,it)}return null}function ft(g,C,x,O){return s(g,C,x,O,!0)}return ft.INSERT=t,ft.DELETE=n,ft.EQUAL=e,bn=ft,bn}var Cs={exports:{}};Cs.exports;var vi;function ul(){return vi||(vi=1,(function(n,t){var e=200,s="__lodash_hash_undefined__",r=9007199254740991,i="[object Arguments]",o="[object Array]",a="[object Boolean]",u="[object Date]",h="[object Error]",b="[object Function]",v="[object GeneratorFunction]",d="[object Map]",f="[object Number]",y="[object Object]",N="[object Promise]",w="[object RegExp]",L="[object Set]",I="[object String]",B="[object Symbol]",X="[object WeakMap]",j="[object ArrayBuffer]",V="[object DataView]",tt="[object Float32Array]",J="[object Float64Array]",dt="[object Int8Array]",ft="[object Int16Array]",g="[object Int32Array]",C="[object Uint8Array]",x="[object Uint8ClampedArray]",O="[object Uint16Array]",S="[object Uint32Array]",T=/[\\^$.*+?()[\]{}|]/g,q=/\w*$/,M=/^\[object .+?Constructor\]$/,P=/^(?:0|[1-9]\d*)$/,R={};R[i]=R[o]=R[j]=R[V]=R[a]=R[u]=R[tt]=R[J]=R[dt]=R[ft]=R[g]=R[d]=R[f]=R[y]=R[w]=R[L]=R[I]=R[B]=R[C]=R[x]=R[O]=R[S]=!0,R[h]=R[b]=R[X]=!1;var G=typeof ye=="object"&&ye&&ye.Object===Object&&ye,z=typeof self=="object"&&self&&self.Object===Object&&self,K=G||z||Function("return this")(),Y=t&&!t.nodeType&&t,F=Y&&!0&&n&&!n.nodeType&&n,ct=F&&F.exports===Y;function ut(l,c){return l.set(c[0],c[1]),l}function Z(l,c){return l.add(c),l}function nt(l,c){for(var p=-1,E=l?l.length:0;++p<E&&c(l[p],p,l)!==!1;);return l}function Q(l,c){for(var p=-1,E=c.length,W=l.length;++p<E;)l[W+p]=c[p];return l}function et(l,c,p,E){for(var W=-1,$=l?l.length:0;++W<$;)p=c(p,l[W],W,l);return p}function it(l,c){for(var p=-1,E=Array(l);++p<l;)E[p]=c(p);return E}function st(l,c){return l==null?void 0:l[c]}function pt(l){var c=!1;if(l!=null&&typeof l.toString!="function")try{c=!!(l+"")}catch{}return c}function mt(l){var c=-1,p=Array(l.size);return l.forEach(function(E,W){p[++c]=[W,E]}),p}function pe(l,c){return function(p){return l(c(p))}}function Fs(l){var c=-1,p=Array(l.size);return l.forEach(function(E){p[++c]=E}),p}var Cr=Array.prototype,Sr=Function.prototype,je=Object.prototype,us=K["__core-js_shared__"],$s=(function(){var l=/[^.]+$/.exec(us&&us.keys&&us.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),Hs=Sr.toString,Qt=je.hasOwnProperty,Me=je.toString,qr=RegExp("^"+Hs.call(Qt).replace(T,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ae=ct?K.Buffer:void 0,Be=K.Symbol,hs=K.Uint8Array,It=pe(Object.getPrototypeOf,Object),zs=Object.create,Vs=je.propertyIsEnumerable,kr=Cr.splice,ds=Object.getOwnPropertySymbols,De=Ae?Ae.isBuffer:void 0,Gs=pe(Object.keys,Object),Ue=$t(K,"DataView"),we=$t(K,"Map"),Ft=$t(K,"Promise"),Pe=$t(K,"Set"),fs=$t(K,"WeakMap"),Te=$t(Object,"create"),ps=Ct(Ue),Le=Ct(we),gs=Ct(Ft),ms=Ct(Pe),bs=Ct(fs),ge=Be?Be.prototype:void 0,Ks=ge?ge.valueOf:void 0;function le(l){var c=-1,p=l?l.length:0;for(this.clear();++c<p;){var E=l[c];this.set(E[0],E[1])}}function Or(){this.__data__=Te?Te(null):{}}function Ir(l){return this.has(l)&&delete this.__data__[l]}function Rr(l){var c=this.__data__;if(Te){var p=c[l];return p===s?void 0:p}return Qt.call(c,l)?c[l]:void 0}function Zs(l){var c=this.__data__;return Te?c[l]!==void 0:Qt.call(c,l)}function ys(l,c){var p=this.__data__;return p[l]=Te&&c===void 0?s:c,this}le.prototype.clear=Or,le.prototype.delete=Ir,le.prototype.get=Rr,le.prototype.has=Zs,le.prototype.set=ys;function vt(l){var c=-1,p=l?l.length:0;for(this.clear();++c<p;){var E=l[c];this.set(E[0],E[1])}}function _r(){this.__data__=[]}function jr(l){var c=this.__data__,p=$e(c,l);if(p<0)return!1;var E=c.length-1;return p==E?c.pop():kr.call(c,p,1),!0}function Mr(l){var c=this.__data__,p=$e(c,l);return p<0?void 0:c[p][1]}function Br(l){return $e(this.__data__,l)>-1}function Dr(l,c){var p=this.__data__,E=$e(p,l);return E<0?p.push([l,c]):p[E][1]=c,this}vt.prototype.clear=_r,vt.prototype.delete=jr,vt.prototype.get=Mr,vt.prototype.has=Br,vt.prototype.set=Dr;function Et(l){var c=-1,p=l?l.length:0;for(this.clear();++c<p;){var E=l[c];this.set(E[0],E[1])}}function Ur(){this.__data__={hash:new le,map:new(we||vt),string:new le}}function Pr(l){return Se(this,l).delete(l)}function Fr(l){return Se(this,l).get(l)}function $r(l){return Se(this,l).has(l)}function Hr(l,c){return Se(this,l).set(l,c),this}Et.prototype.clear=Ur,Et.prototype.delete=Pr,Et.prototype.get=Fr,Et.prototype.has=$r,Et.prototype.set=Hr;function St(l){this.__data__=new vt(l)}function zr(){this.__data__=new vt}function Vr(l){return this.__data__.delete(l)}function Gr(l){return this.__data__.get(l)}function Kr(l){return this.__data__.has(l)}function Zr(l,c){var p=this.__data__;if(p instanceof vt){var E=p.__data__;if(!we||E.length<e-1)return E.push([l,c]),this;p=this.__data__=new Et(E)}return p.set(l,c),this}St.prototype.clear=zr,St.prototype.delete=Vr,St.prototype.get=Gr,St.prototype.has=Kr,St.prototype.set=Zr;function Fe(l,c){var p=Es(l)||ze(l)?it(l.length,String):[],E=p.length,W=!!E;for(var $ in l)Qt.call(l,$)&&!(W&&($=="length"||cn($,E)))&&p.push($);return p}function Ws(l,c,p){var E=l[c];(!(Qt.call(l,c)&&tr(E,p))||p===void 0&&!(c in l))&&(l[c]=p)}function $e(l,c){for(var p=l.length;p--;)if(tr(l[p][0],c))return p;return-1}function Jt(l,c){return l&&Ns(c,ws(c),l)}function vs(l,c,p,E,W,$,lt){var rt;if(E&&(rt=$?E(l,W,$,lt):E(l)),rt!==void 0)return rt;if(!ee(l))return l;var gt=Es(l);if(gt){if(rt=on(l),!c)return rn(l,rt)}else{var at=ae(l),At=at==b||at==v;if(er(l))return He(l,c);if(at==y||at==i||At&&!$){if(pt(l))return $?l:{};if(rt=te(At?{}:l),!c)return nn(l,Jt(rt,l))}else{if(!R[at])return $?l:{};rt=an(l,at,vs,c)}}lt||(lt=new St);var qt=lt.get(l);if(qt)return qt;if(lt.set(l,rt),!gt)var bt=p?ln(l):ws(l);return nt(bt||l,function(wt,xt){bt&&(xt=wt,wt=l[xt]),Ws(rt,xt,vs(wt,c,p,E,xt,l,lt))}),rt}function Wr(l){return ee(l)?zs(l):{}}function Xr(l,c,p){var E=c(l);return Es(l)?E:Q(E,p(l))}function Yr(l){return Me.call(l)}function Qr(l){if(!ee(l)||hn(l))return!1;var c=As(l)||pt(l)?qr:M;return c.test(Ct(l))}function Jr(l){if(!Qs(l))return Gs(l);var c=[];for(var p in Object(l))Qt.call(l,p)&&p!="constructor"&&c.push(p);return c}function He(l,c){if(c)return l.slice();var p=new l.constructor(l.length);return l.copy(p),p}function xs(l){var c=new l.constructor(l.byteLength);return new hs(c).set(new hs(l)),c}function Ce(l,c){var p=c?xs(l.buffer):l.buffer;return new l.constructor(p,l.byteOffset,l.byteLength)}function Xs(l,c,p){var E=c?p(mt(l),!0):mt(l);return et(E,ut,new l.constructor)}function Ys(l){var c=new l.constructor(l.source,q.exec(l));return c.lastIndex=l.lastIndex,c}function tn(l,c,p){var E=c?p(Fs(l),!0):Fs(l);return et(E,Z,new l.constructor)}function en(l){return Ks?Object(Ks.call(l)):{}}function sn(l,c){var p=c?xs(l.buffer):l.buffer;return new l.constructor(p,l.byteOffset,l.length)}function rn(l,c){var p=-1,E=l.length;for(c||(c=Array(E));++p<E;)c[p]=l[p];return c}function Ns(l,c,p,E){p||(p={});for(var W=-1,$=c.length;++W<$;){var lt=c[W],rt=void 0;Ws(p,lt,rt===void 0?l[lt]:rt)}return p}function nn(l,c){return Ns(l,oe(l),c)}function ln(l){return Xr(l,ws,oe)}function Se(l,c){var p=l.__data__;return un(c)?p[typeof c=="string"?"string":"hash"]:p.map}function $t(l,c){var p=st(l,c);return Qr(p)?p:void 0}var oe=ds?pe(ds,Object):fn,ae=Yr;(Ue&&ae(new Ue(new ArrayBuffer(1)))!=V||we&&ae(new we)!=d||Ft&&ae(Ft.resolve())!=N||Pe&&ae(new Pe)!=L||fs&&ae(new fs)!=X)&&(ae=function(l){var c=Me.call(l),p=c==y?l.constructor:void 0,E=p?Ct(p):void 0;if(E)switch(E){case ps:return V;case Le:return d;case gs:return N;case ms:return L;case bs:return X}return c});function on(l){var c=l.length,p=l.constructor(c);return c&&typeof l[0]=="string"&&Qt.call(l,"index")&&(p.index=l.index,p.input=l.input),p}function te(l){return typeof l.constructor=="function"&&!Qs(l)?Wr(It(l)):{}}function an(l,c,p,E){var W=l.constructor;switch(c){case j:return xs(l);case a:case u:return new W(+l);case V:return Ce(l,E);case tt:case J:case dt:case ft:case g:case C:case x:case O:case S:return sn(l,E);case d:return Xs(l,E,p);case f:case I:return new W(l);case w:return Ys(l);case L:return tn(l,E,p);case B:return en(l)}}function cn(l,c){return c=c??r,!!c&&(typeof l=="number"||P.test(l))&&l>-1&&l%1==0&&l<c}function un(l){var c=typeof l;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?l!=="__proto__":l===null}function hn(l){return!!$s&&$s in l}function Qs(l){var c=l&&l.constructor,p=typeof c=="function"&&c.prototype||je;return l===p}function Ct(l){if(l!=null){try{return Hs.call(l)}catch{}try{return l+""}catch{}}return""}function Js(l){return vs(l,!0,!0)}function tr(l,c){return l===c||l!==l&&c!==c}function ze(l){return dn(l)&&Qt.call(l,"callee")&&(!Vs.call(l,"callee")||Me.call(l)==i)}var Es=Array.isArray;function Ve(l){return l!=null&&sr(l.length)&&!As(l)}function dn(l){return rr(l)&&Ve(l)}var er=De||pn;function As(l){var c=ee(l)?Me.call(l):"";return c==b||c==v}function sr(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=r}function ee(l){var c=typeof l;return!!l&&(c=="object"||c=="function")}function rr(l){return!!l&&typeof l=="object"}function ws(l){return Ve(l)?Fe(l):Jr(l)}function fn(){return[]}function pn(){return!1}n.exports=Js})(Cs,Cs.exports)),Cs.exports}var Ss={exports:{}};Ss.exports;var xi;function hl(){return xi||(xi=1,(function(n,t){var e=200,s="__lodash_hash_undefined__",r=1,i=2,o=9007199254740991,a="[object Arguments]",u="[object Array]",h="[object AsyncFunction]",b="[object Boolean]",v="[object Date]",d="[object Error]",f="[object Function]",y="[object GeneratorFunction]",N="[object Map]",w="[object Number]",L="[object Null]",I="[object Object]",B="[object Promise]",X="[object Proxy]",j="[object RegExp]",V="[object Set]",tt="[object String]",J="[object Symbol]",dt="[object Undefined]",ft="[object WeakMap]",g="[object ArrayBuffer]",C="[object DataView]",x="[object Float32Array]",O="[object Float64Array]",S="[object Int8Array]",T="[object Int16Array]",q="[object Int32Array]",M="[object Uint8Array]",P="[object Uint8ClampedArray]",R="[object Uint16Array]",G="[object Uint32Array]",z=/[\\^$.*+?()[\]{}|]/g,K=/^\[object .+?Constructor\]$/,Y=/^(?:0|[1-9]\d*)$/,F={};F[x]=F[O]=F[S]=F[T]=F[q]=F[M]=F[P]=F[R]=F[G]=!0,F[a]=F[u]=F[g]=F[b]=F[C]=F[v]=F[d]=F[f]=F[N]=F[w]=F[I]=F[j]=F[V]=F[tt]=F[ft]=!1;var ct=typeof ye=="object"&&ye&&ye.Object===Object&&ye,ut=typeof self=="object"&&self&&self.Object===Object&&self,Z=ct||ut||Function("return this")(),nt=t&&!t.nodeType&&t,Q=nt&&!0&&n&&!n.nodeType&&n,et=Q&&Q.exports===nt,it=et&&ct.process,st=(function(){try{return it&&it.binding&&it.binding("util")}catch{}})(),pt=st&&st.isTypedArray;function mt(l,c){for(var p=-1,E=l==null?0:l.length,W=0,$=[];++p<E;){var lt=l[p];c(lt,p,l)&&($[W++]=lt)}return $}function pe(l,c){for(var p=-1,E=c.length,W=l.length;++p<E;)l[W+p]=c[p];return l}function Fs(l,c){for(var p=-1,E=l==null?0:l.length;++p<E;)if(c(l[p],p,l))return!0;return!1}function Cr(l,c){for(var p=-1,E=Array(l);++p<l;)E[p]=c(p);return E}function Sr(l){return function(c){return l(c)}}function je(l,c){return l.has(c)}function us(l,c){return l==null?void 0:l[c]}function $s(l){var c=-1,p=Array(l.size);return l.forEach(function(E,W){p[++c]=[W,E]}),p}function Hs(l,c){return function(p){return l(c(p))}}function Qt(l){var c=-1,p=Array(l.size);return l.forEach(function(E){p[++c]=E}),p}var Me=Array.prototype,qr=Function.prototype,Ae=Object.prototype,Be=Z["__core-js_shared__"],hs=qr.toString,It=Ae.hasOwnProperty,zs=(function(){var l=/[^.]+$/.exec(Be&&Be.keys&&Be.keys.IE_PROTO||"");return l?"Symbol(src)_1."+l:""})(),Vs=Ae.toString,kr=RegExp("^"+hs.call(It).replace(z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ds=et?Z.Buffer:void 0,De=Z.Symbol,Gs=Z.Uint8Array,Ue=Ae.propertyIsEnumerable,we=Me.splice,Ft=De?De.toStringTag:void 0,Pe=Object.getOwnPropertySymbols,fs=ds?ds.isBuffer:void 0,Te=Hs(Object.keys,Object),ps=oe(Z,"DataView"),Le=oe(Z,"Map"),gs=oe(Z,"Promise"),ms=oe(Z,"Set"),bs=oe(Z,"WeakMap"),ge=oe(Object,"create"),Ks=Ct(ps),le=Ct(Le),Or=Ct(gs),Ir=Ct(ms),Rr=Ct(bs),Zs=De?De.prototype:void 0,ys=Zs?Zs.valueOf:void 0;function vt(l){var c=-1,p=l==null?0:l.length;for(this.clear();++c<p;){var E=l[c];this.set(E[0],E[1])}}function _r(){this.__data__=ge?ge(null):{},this.size=0}function jr(l){var c=this.has(l)&&delete this.__data__[l];return this.size-=c?1:0,c}function Mr(l){var c=this.__data__;if(ge){var p=c[l];return p===s?void 0:p}return It.call(c,l)?c[l]:void 0}function Br(l){var c=this.__data__;return ge?c[l]!==void 0:It.call(c,l)}function Dr(l,c){var p=this.__data__;return this.size+=this.has(l)?0:1,p[l]=ge&&c===void 0?s:c,this}vt.prototype.clear=_r,vt.prototype.delete=jr,vt.prototype.get=Mr,vt.prototype.has=Br,vt.prototype.set=Dr;function Et(l){var c=-1,p=l==null?0:l.length;for(this.clear();++c<p;){var E=l[c];this.set(E[0],E[1])}}function Ur(){this.__data__=[],this.size=0}function Pr(l){var c=this.__data__,p=He(c,l);if(p<0)return!1;var E=c.length-1;return p==E?c.pop():we.call(c,p,1),--this.size,!0}function Fr(l){var c=this.__data__,p=He(c,l);return p<0?void 0:c[p][1]}function $r(l){return He(this.__data__,l)>-1}function Hr(l,c){var p=this.__data__,E=He(p,l);return E<0?(++this.size,p.push([l,c])):p[E][1]=c,this}Et.prototype.clear=Ur,Et.prototype.delete=Pr,Et.prototype.get=Fr,Et.prototype.has=$r,Et.prototype.set=Hr;function St(l){var c=-1,p=l==null?0:l.length;for(this.clear();++c<p;){var E=l[c];this.set(E[0],E[1])}}function zr(){this.size=0,this.__data__={hash:new vt,map:new(Le||Et),string:new vt}}function Vr(l){var c=$t(this,l).delete(l);return this.size-=c?1:0,c}function Gr(l){return $t(this,l).get(l)}function Kr(l){return $t(this,l).has(l)}function Zr(l,c){var p=$t(this,l),E=p.size;return p.set(l,c),this.size+=p.size==E?0:1,this}St.prototype.clear=zr,St.prototype.delete=Vr,St.prototype.get=Gr,St.prototype.has=Kr,St.prototype.set=Zr;function Fe(l){var c=-1,p=l==null?0:l.length;for(this.__data__=new St;++c<p;)this.add(l[c])}function Ws(l){return this.__data__.set(l,s),this}function $e(l){return this.__data__.has(l)}Fe.prototype.add=Fe.prototype.push=Ws,Fe.prototype.has=$e;function Jt(l){var c=this.__data__=new Et(l);this.size=c.size}function vs(){this.__data__=new Et,this.size=0}function Wr(l){var c=this.__data__,p=c.delete(l);return this.size=c.size,p}function Xr(l){return this.__data__.get(l)}function Yr(l){return this.__data__.has(l)}function Qr(l,c){var p=this.__data__;if(p instanceof Et){var E=p.__data__;if(!Le||E.length<e-1)return E.push([l,c]),this.size=++p.size,this;p=this.__data__=new St(E)}return p.set(l,c),this.size=p.size,this}Jt.prototype.clear=vs,Jt.prototype.delete=Wr,Jt.prototype.get=Xr,Jt.prototype.has=Yr,Jt.prototype.set=Qr;function Jr(l,c){var p=ze(l),E=!p&&tr(l),W=!p&&!E&&Ve(l),$=!p&&!E&&!W&&rr(l),lt=p||E||W||$,rt=lt?Cr(l.length,String):[],gt=rt.length;for(var at in l)It.call(l,at)&&!(lt&&(at=="length"||W&&(at=="offset"||at=="parent")||$&&(at=="buffer"||at=="byteLength"||at=="byteOffset")||an(at,gt)))&&rt.push(at);return rt}function He(l,c){for(var p=l.length;p--;)if(Js(l[p][0],c))return p;return-1}function xs(l,c,p){var E=c(l);return ze(l)?E:pe(E,p(l))}function Ce(l){return l==null?l===void 0?dt:L:Ft&&Ft in Object(l)?ae(l):Qs(l)}function Xs(l){return ee(l)&&Ce(l)==a}function Ys(l,c,p,E,W){return l===c?!0:l==null||c==null||!ee(l)&&!ee(c)?l!==l&&c!==c:tn(l,c,p,E,Ys,W)}function tn(l,c,p,E,W,$){var lt=ze(l),rt=ze(c),gt=lt?u:te(l),at=rt?u:te(c);gt=gt==a?I:gt,at=at==a?I:at;var At=gt==I,qt=at==I,bt=gt==at;if(bt&&Ve(l)){if(!Ve(c))return!1;lt=!0,At=!1}if(bt&&!At)return $||($=new Jt),lt||rr(l)?Ns(l,c,p,E,W,$):nn(l,c,gt,p,E,W,$);if(!(p&r)){var wt=At&&It.call(l,"__wrapped__"),xt=qt&&It.call(c,"__wrapped__");if(wt||xt){var me=wt?l.value():l,ce=xt?c.value():c;return $||($=new Jt),W(me,ce,p,E,$)}}return bt?($||($=new Jt),ln(l,c,p,E,W,$)):!1}function en(l){if(!sr(l)||un(l))return!1;var c=er(l)?kr:K;return c.test(Ct(l))}function sn(l){return ee(l)&&As(l.length)&&!!F[Ce(l)]}function rn(l){if(!hn(l))return Te(l);var c=[];for(var p in Object(l))It.call(l,p)&&p!="constructor"&&c.push(p);return c}function Ns(l,c,p,E,W,$){var lt=p&r,rt=l.length,gt=c.length;if(rt!=gt&&!(lt&&gt>rt))return!1;var at=$.get(l);if(at&&$.get(c))return at==c;var At=-1,qt=!0,bt=p&i?new Fe:void 0;for($.set(l,c),$.set(c,l);++At<rt;){var wt=l[At],xt=c[At];if(E)var me=lt?E(xt,wt,At,c,l,$):E(wt,xt,At,l,c,$);if(me!==void 0){if(me)continue;qt=!1;break}if(bt){if(!Fs(c,function(ce,qe){if(!je(bt,qe)&&(wt===ce||W(wt,ce,p,E,$)))return bt.push(qe)})){qt=!1;break}}else if(!(wt===xt||W(wt,xt,p,E,$))){qt=!1;break}}return $.delete(l),$.delete(c),qt}function nn(l,c,p,E,W,$,lt){switch(p){case C:if(l.byteLength!=c.byteLength||l.byteOffset!=c.byteOffset)return!1;l=l.buffer,c=c.buffer;case g:return!(l.byteLength!=c.byteLength||!$(new Gs(l),new Gs(c)));case b:case v:case w:return Js(+l,+c);case d:return l.name==c.name&&l.message==c.message;case j:case tt:return l==c+"";case N:var rt=$s;case V:var gt=E&r;if(rt||(rt=Qt),l.size!=c.size&&!gt)return!1;var at=lt.get(l);if(at)return at==c;E|=i,lt.set(l,c);var At=Ns(rt(l),rt(c),E,W,$,lt);return lt.delete(l),At;case J:if(ys)return ys.call(l)==ys.call(c)}return!1}function ln(l,c,p,E,W,$){var lt=p&r,rt=Se(l),gt=rt.length,at=Se(c),At=at.length;if(gt!=At&&!lt)return!1;for(var qt=gt;qt--;){var bt=rt[qt];if(!(lt?bt in c:It.call(c,bt)))return!1}var wt=$.get(l);if(wt&&$.get(c))return wt==c;var xt=!0;$.set(l,c),$.set(c,l);for(var me=lt;++qt<gt;){bt=rt[qt];var ce=l[bt],qe=c[bt];if(E)var ii=lt?E(qe,ce,bt,c,l,$):E(ce,qe,bt,l,c,$);if(!(ii===void 0?ce===qe||W(ce,qe,p,E,$):ii)){xt=!1;break}me||(me=bt=="constructor")}if(xt&&!me){var nr=l.constructor,ir=c.constructor;nr!=ir&&"constructor"in l&&"constructor"in c&&!(typeof nr=="function"&&nr instanceof nr&&typeof ir=="function"&&ir instanceof ir)&&(xt=!1)}return $.delete(l),$.delete(c),xt}function Se(l){return xs(l,ws,on)}function $t(l,c){var p=l.__data__;return cn(c)?p[typeof c=="string"?"string":"hash"]:p.map}function oe(l,c){var p=us(l,c);return en(p)?p:void 0}function ae(l){var c=It.call(l,Ft),p=l[Ft];try{l[Ft]=void 0;var E=!0}catch{}var W=Vs.call(l);return E&&(c?l[Ft]=p:delete l[Ft]),W}var on=Pe?function(l){return l==null?[]:(l=Object(l),mt(Pe(l),function(c){return Ue.call(l,c)}))}:fn,te=Ce;(ps&&te(new ps(new ArrayBuffer(1)))!=C||Le&&te(new Le)!=N||gs&&te(gs.resolve())!=B||ms&&te(new ms)!=V||bs&&te(new bs)!=ft)&&(te=function(l){var c=Ce(l),p=c==I?l.constructor:void 0,E=p?Ct(p):"";if(E)switch(E){case Ks:return C;case le:return N;case Or:return B;case Ir:return V;case Rr:return ft}return c});function an(l,c){return c=c??o,!!c&&(typeof l=="number"||Y.test(l))&&l>-1&&l%1==0&&l<c}function cn(l){var c=typeof l;return c=="string"||c=="number"||c=="symbol"||c=="boolean"?l!=="__proto__":l===null}function un(l){return!!zs&&zs in l}function hn(l){var c=l&&l.constructor,p=typeof c=="function"&&c.prototype||Ae;return l===p}function Qs(l){return Vs.call(l)}function Ct(l){if(l!=null){try{return hs.call(l)}catch{}try{return l+""}catch{}}return""}function Js(l,c){return l===c||l!==l&&c!==c}var tr=Xs((function(){return arguments})())?Xs:function(l){return ee(l)&&It.call(l,"callee")&&!Ue.call(l,"callee")},ze=Array.isArray;function Es(l){return l!=null&&As(l.length)&&!er(l)}var Ve=fs||pn;function dn(l,c){return Ys(l,c)}function er(l){if(!sr(l))return!1;var c=Ce(l);return c==f||c==y||c==h||c==X}function As(l){return typeof l=="number"&&l>-1&&l%1==0&&l<=o}function sr(l){var c=typeof l;return l!=null&&(c=="object"||c=="function")}function ee(l){return l!=null&&typeof l=="object"}var rr=pt?Sr(pt):sn;function ws(l){return Es(l)?Jr(l):rn(l)}function fn(){return[]}function pn(){return!1}n.exports=dn})(Ss,Ss.exports)),Ss.exports}var or={},Ni;function ic(){if(Ni)return or;Ni=1,Object.defineProperty(or,"__esModule",{value:!0});const n=ul(),t=hl();var e;return(function(s){function r(u={},h={},b=!1){typeof u!="object"&&(u={}),typeof h!="object"&&(h={});let v=n(h);b||(v=Object.keys(v).reduce((d,f)=>(v[f]!=null&&(d[f]=v[f]),d),{}));for(const d in u)u[d]!==void 0&&h[d]===void 0&&(v[d]=u[d]);return Object.keys(v).length>0?v:void 0}s.compose=r;function i(u={},h={}){typeof u!="object"&&(u={}),typeof h!="object"&&(h={});const b=Object.keys(u).concat(Object.keys(h)).reduce((v,d)=>(t(u[d],h[d])||(v[d]=h[d]===void 0?null:h[d]),v),{});return Object.keys(b).length>0?b:void 0}s.diff=i;function o(u={},h={}){u=u||{};const b=Object.keys(h).reduce((v,d)=>(h[d]!==u[d]&&u[d]!==void 0&&(v[d]=h[d]),v),{});return Object.keys(u).reduce((v,d)=>(u[d]!==h[d]&&h[d]===void 0&&(v[d]=null),v),b)}s.invert=o;function a(u,h,b=!1){if(typeof u!="object")return h;if(typeof h!="object")return;if(!b)return h;const v=Object.keys(h).reduce((d,f)=>(u[f]===void 0&&(d[f]=h[f]),d),{});return Object.keys(v).length>0?v:void 0}s.transform=a})(e||(e={})),or.default=e,or}var ar={},Ei;function dl(){if(Ei)return ar;Ei=1,Object.defineProperty(ar,"__esModule",{value:!0});var n;return(function(t){function e(s){return typeof s.delete=="number"?s.delete:typeof s.retain=="number"?s.retain:typeof s.retain=="object"&&s.retain!==null?1:typeof s.insert=="string"?s.insert.length:1}t.length=e})(n||(n={})),ar.default=n,ar}var cr={},Ai;function lc(){if(Ai)return cr;Ai=1,Object.defineProperty(cr,"__esModule",{value:!0});const n=dl();class t{constructor(s){this.ops=s,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(s){s||(s=1/0);const r=this.ops[this.index];if(r){const i=this.offset,o=n.default.length(r);if(s>=o-i?(s=o-i,this.index+=1,this.offset=0):this.offset+=s,typeof r.delete=="number")return{delete:s};{const a={};return r.attributes&&(a.attributes=r.attributes),typeof r.retain=="number"?a.retain=s:typeof r.retain=="object"&&r.retain!==null?a.retain=r.retain:typeof r.insert=="string"?a.insert=r.insert.substr(i,s):a.insert=r.insert,a}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?n.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const s=this.ops[this.index];return s?typeof s.delete=="number"?"delete":typeof s.retain=="number"||typeof s.retain=="object"&&s.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const s=this.offset,r=this.index,i=this.next(),o=this.ops.slice(this.index);return this.offset=s,this.index=r,[i].concat(o)}}else return[]}}return cr.default=t,cr}var wi;function oc(){return wi||(wi=1,(function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMap=t.OpIterator=t.Op=void 0;const e=nc(),s=ul(),r=hl(),i=ic();t.AttributeMap=i.default;const o=dl();t.Op=o.default;const a=lc();t.OpIterator=a.default;const u="\0",h=(v,d)=>{if(typeof v!="object"||v===null)throw new Error(`cannot retain a ${typeof v}`);if(typeof d!="object"||d===null)throw new Error(`cannot retain a ${typeof d}`);const f=Object.keys(v)[0];if(!f||f!==Object.keys(d)[0])throw new Error(`embed types not matched: ${f} != ${Object.keys(d)[0]}`);return[f,v[f],d[f]]};class b{constructor(d){Array.isArray(d)?this.ops=d:d!=null&&Array.isArray(d.ops)?this.ops=d.ops:this.ops=[]}static registerEmbed(d,f){this.handlers[d]=f}static unregisterEmbed(d){delete this.handlers[d]}static getHandler(d){const f=this.handlers[d];if(!f)throw new Error(`no handlers for embed type "${d}"`);return f}insert(d,f){const y={};return typeof d=="string"&&d.length===0?this:(y.insert=d,f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(y.attributes=f),this.push(y))}delete(d){return d<=0?this:this.push({delete:d})}retain(d,f){if(typeof d=="number"&&d<=0)return this;const y={retain:d};return f!=null&&typeof f=="object"&&Object.keys(f).length>0&&(y.attributes=f),this.push(y)}push(d){let f=this.ops.length,y=this.ops[f-1];if(d=s(d),typeof y=="object"){if(typeof d.delete=="number"&&typeof y.delete=="number")return this.ops[f-1]={delete:y.delete+d.delete},this;if(typeof y.delete=="number"&&d.insert!=null&&(f-=1,y=this.ops[f-1],typeof y!="object"))return this.ops.unshift(d),this;if(r(d.attributes,y.attributes)){if(typeof d.insert=="string"&&typeof y.insert=="string")return this.ops[f-1]={insert:y.insert+d.insert},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this;if(typeof d.retain=="number"&&typeof y.retain=="number")return this.ops[f-1]={retain:y.retain+d.retain},typeof d.attributes=="object"&&(this.ops[f-1].attributes=d.attributes),this}}return f===this.ops.length?this.ops.push(d):this.ops.splice(f,0,d),this}chop(){const d=this.ops[this.ops.length-1];return d&&typeof d.retain=="number"&&!d.attributes&&this.ops.pop(),this}filter(d){return this.ops.filter(d)}forEach(d){this.ops.forEach(d)}map(d){return this.ops.map(d)}partition(d){const f=[],y=[];return this.forEach(N=>{(d(N)?f:y).push(N)}),[f,y]}reduce(d,f){return this.ops.reduce(d,f)}changeLength(){return this.reduce((d,f)=>f.insert?d+o.default.length(f):f.delete?d-f.delete:d,0)}length(){return this.reduce((d,f)=>d+o.default.length(f),0)}slice(d=0,f=1/0){const y=[],N=new a.default(this.ops);let w=0;for(;w<f&&N.hasNext();){let L;w<d?L=N.next(d-w):(L=N.next(f-w),y.push(L)),w+=o.default.length(L)}return new b(y)}compose(d){const f=new a.default(this.ops),y=new a.default(d.ops),N=[],w=y.peek();if(w!=null&&typeof w.retain=="number"&&w.attributes==null){let I=w.retain;for(;f.peekType()==="insert"&&f.peekLength()<=I;)I-=f.peekLength(),N.push(f.next());w.retain-I>0&&y.next(w.retain-I)}const L=new b(N);for(;f.hasNext()||y.hasNext();)if(y.peekType()==="insert")L.push(y.next());else if(f.peekType()==="delete")L.push(f.next());else{const I=Math.min(f.peekLength(),y.peekLength()),B=f.next(I),X=y.next(I);if(X.retain){const j={};if(typeof B.retain=="number")j.retain=typeof X.retain=="number"?I:X.retain;else if(typeof X.retain=="number")B.retain==null?j.insert=B.insert:j.retain=B.retain;else{const tt=B.retain==null?"insert":"retain",[J,dt,ft]=h(B[tt],X.retain),g=b.getHandler(J);j[tt]={[J]:g.compose(dt,ft,tt==="retain")}}const V=i.default.compose(B.attributes,X.attributes,typeof B.retain=="number");if(V&&(j.attributes=V),L.push(j),!y.hasNext()&&r(L.ops[L.ops.length-1],j)){const tt=new b(f.rest());return L.concat(tt).chop()}}else typeof X.delete=="number"&&(typeof B.retain=="number"||typeof B.retain=="object"&&B.retain!==null)&&L.push(X)}return L.chop()}concat(d){const f=new b(this.ops.slice());return d.ops.length>0&&(f.push(d.ops[0]),f.ops=f.ops.concat(d.ops.slice(1))),f}diff(d,f){if(this.ops===d.ops)return new b;const y=[this,d].map(B=>B.map(X=>{if(X.insert!=null)return typeof X.insert=="string"?X.insert:u;const j=B===d?"on":"with";throw new Error("diff() called "+j+" non-document")}).join("")),N=new b,w=e(y[0],y[1],f,!0),L=new a.default(this.ops),I=new a.default(d.ops);return w.forEach(B=>{let X=B[1].length;for(;X>0;){let j=0;switch(B[0]){case e.INSERT:j=Math.min(I.peekLength(),X),N.push(I.next(j));break;case e.DELETE:j=Math.min(X,L.peekLength()),L.next(j),N.delete(j);break;case e.EQUAL:j=Math.min(L.peekLength(),I.peekLength(),X);const V=L.next(j),tt=I.next(j);r(V.insert,tt.insert)?N.retain(j,i.default.diff(V.attributes,tt.attributes)):N.push(tt).delete(j);break}X-=j}}),N.chop()}eachLine(d,f=`
`){const y=new a.default(this.ops);let N=new b,w=0;for(;y.hasNext();){if(y.peekType()!=="insert")return;const L=y.peek(),I=o.default.length(L)-y.peekLength(),B=typeof L.insert=="string"?L.insert.indexOf(f,I)-I:-1;if(B<0)N.push(y.next());else if(B>0)N.push(y.next(B));else{if(d(N,y.next(1).attributes||{},w)===!1)return;w+=1,N=new b}}N.length()>0&&d(N,{},w)}invert(d){const f=new b;return this.reduce((y,N)=>{if(N.insert)f.delete(o.default.length(N));else{if(typeof N.retain=="number"&&N.attributes==null)return f.retain(N.retain),y+N.retain;if(N.delete||typeof N.retain=="number"){const w=N.delete||N.retain;return d.slice(y,y+w).forEach(I=>{N.delete?f.push(I):N.retain&&N.attributes&&f.retain(o.default.length(I),i.default.invert(N.attributes,I.attributes))}),y+w}else if(typeof N.retain=="object"&&N.retain!==null){const w=d.slice(y,y+1),L=new a.default(w.ops).next(),[I,B,X]=h(N.retain,L.insert),j=b.getHandler(I);return f.retain({[I]:j.invert(B,X)},i.default.invert(N.attributes,L.attributes)),y+1}}return y},0),f.chop()}transform(d,f=!1){if(f=!!f,typeof d=="number")return this.transformPosition(d,f);const y=d,N=new a.default(this.ops),w=new a.default(y.ops),L=new b;for(;N.hasNext()||w.hasNext();)if(N.peekType()==="insert"&&(f||w.peekType()!=="insert"))L.retain(o.default.length(N.next()));else if(w.peekType()==="insert")L.push(w.next());else{const I=Math.min(N.peekLength(),w.peekLength()),B=N.next(I),X=w.next(I);if(B.delete)continue;if(X.delete)L.push(X);else{const j=B.retain,V=X.retain;let tt=typeof V=="object"&&V!==null?V:I;if(typeof j=="object"&&j!==null&&typeof V=="object"&&V!==null){const J=Object.keys(j)[0];if(J===Object.keys(V)[0]){const dt=b.getHandler(J);dt&&(tt={[J]:dt.transform(j[J],V[J],f)})}}L.retain(tt,i.default.transform(B.attributes,X.attributes,f))}}return L.chop()}transformPosition(d,f=!1){f=!!f;const y=new a.default(this.ops);let N=0;for(;y.hasNext()&&N<=d;){const w=y.peekLength(),L=y.peekType();if(y.next(),L==="delete"){d-=Math.min(w,d-N);continue}else L==="insert"&&(N<d||!f)&&(d+=w);N+=w}return d}}b.Op=o.default,b.OpIterator=a.default,b.AttributeMap=i.default,b.handlers={},t.default=b,n.exports=b,n.exports.default=b})(lr,lr.exports)),lr.exports}var Bt=oc();const D=Wi(Bt);class Xt extends Ot{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}Xt.blotName="break";Xt.tagName="BR";let Zt=class extends vr{};const ac={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function wr(n){return n.replace(/[&<>"']/g,t=>ac[t])}const se=class se extends Kn{static compare(t,e){const s=se.order.indexOf(t),r=se.order.indexOf(e);return s>=0||r>=0?s-r:t===e?0:t<e?-1:1}formatAt(t,e,s,r){if(se.compare(this.statics.blotName,s)<0&&this.scroll.query(s,U.BLOT)){const i=this.isolate(t,e);r&&i.wrap(s,r)}else super.formatAt(t,e,s,r)}optimize(t){if(super.optimize(t),this.parent instanceof se&&se.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}};k(se,"allowedChildren",[se,Xt,Ot,Zt]),k(se,"order",["cursor","inline","link","underline","strike","italic","bold","script","code"]);let ie=se;const Ti=1;class Nt extends Rs{constructor(){super(...arguments);k(this,"cache",{})}delta(){return this.cache.delta==null&&(this.cache.delta=fl(this)),this.cache.delta}deleteAt(e,s){super.deleteAt(e,s),this.cache={}}formatAt(e,s,r,i){s<=0||(this.scroll.query(r,U.BLOCK)?e+s===this.length()&&this.format(r,i):super.formatAt(e,Math.min(s,this.length()-e-1),r,i),this.cache={})}insertAt(e,s,r){if(r!=null){super.insertAt(e,s,r),this.cache={};return}if(s.length===0)return;const i=s.split(`
`),o=i.shift();o.length>0&&(e<this.length()-1||this.children.tail==null?super.insertAt(Math.min(e,this.length()-1),o):this.children.tail.insertAt(this.children.tail.length(),o),this.cache={});let a=this;i.reduce((u,h)=>(a=a.split(u,!0),a.insertAt(0,h),h.length),e+o.length)}insertBefore(e,s){const{head:r}=this.children;super.insertBefore(e,s),r instanceof Xt&&r.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Ti),this.cache.length}moveChildren(e,s){super.moveChildren(e,s),this.cache={}}optimize(e){super.optimize(e),this.cache={}}path(e){return super.path(e,!0)}removeChild(e){super.removeChild(e),this.cache={}}split(e){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(s&&(e===0||e>=this.length()-Ti)){const i=this.clone();return e===0?(this.parent.insertBefore(i,this),this):(this.parent.insertBefore(i,this.next),i)}const r=super.split(e,s);return this.cache={},r}}Nt.blotName="block";Nt.tagName="P";Nt.defaultChild=Xt;Nt.allowedChildren=[Xt,ie,Ot,Zt];let Mt=class extends Ot{attach(){super.attach(),this.attributes=new Er(this.domNode)}delta(){return new D().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,e){const s=this.scroll.query(t,U.BLOCK_ATTRIBUTE);s!=null&&this.attributes.attribute(s,e)}formatAt(t,e,s,r){this.format(s,r)}insertAt(t,e,s){if(s!=null){super.insertAt(t,e,s);return}const r=e.split(`
`),i=r.pop(),o=r.map(u=>{const h=this.scroll.create(Nt.blotName);return h.insertAt(0,u),h}),a=this.split(t);o.forEach(u=>{this.parent.insertBefore(u,a)}),i&&this.parent.insertBefore(this.scroll.create("text",i),a)}};Mt.scope=U.BLOCK_BLOT;function fl(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(Tt).reduce((e,s)=>s.length()===0?e:e.insert(s.value(),_t(s,{},t)),new D).insert(`
`,_t(n))}function _t(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(t={...t,...n.formats()},e&&delete t["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?t:_t(n.parent,t,e)}const Rt=class Rt extends Ot{static value(){}constructor(t,e,s){super(t,e),this.selection=s,this.textNode=document.createTextNode(Rt.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(t,e){if(this.savedLength!==0){super.format(t,e);return}let s=this,r=0;for(;s!=null&&s.statics.scope!==U.BLOCK_BLOT;)r+=s.offset(s.parent),s=s.parent;s!=null&&(this.savedLength=Rt.CONTENTS.length,s.optimize(),s.formatAt(r,Rt.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const t=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof Zt?this.prev:null,s=e?e.length():0,r=this.next instanceof Zt?this.next:null,i=r?r.text:"",{textNode:o}=this,a=o.data.split(Rt.CONTENTS).join("");o.data=Rt.CONTENTS;let u;if(e)u=e,(a||r)&&(e.insertAt(e.length(),a+i),r&&r.remove());else if(r)u=r,r.insertAt(0,a);else{const h=document.createTextNode(a);u=this.scroll.create(h),this.parent.insertBefore(u,this)}if(this.remove(),t){const h=(d,f)=>e&&d===e.domNode?f:d===o?s+f-1:r&&d===r.domNode?s+a.length+f:null,b=h(t.start.node,t.start.offset),v=h(t.end.node,t.end.offset);if(b!==null&&v!==null)return{startNode:u.domNode,startOffset:b,endNode:u.domNode,endOffset:v}}return null}update(t,e){if(t.some(s=>s.type==="characterData"&&s.target===this.textNode)){const s=this.restore();s&&(e.range=s)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if(e.domNode.tagName==="A"){this.savedLength=Rt.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}};k(Rt,"blotName","cursor"),k(Rt,"className","ql-cursor"),k(Rt,"tagName","span"),k(Rt,"CONTENTS","\uFEFF");let is=Rt;var yn={exports:{}},Li;function cc(){return Li||(Li=1,(function(n){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function r(u,h,b){this.fn=u,this.context=h,this.once=b||!1}function i(u,h,b,v,d){if(typeof b!="function")throw new TypeError("The listener must be a function");var f=new r(b,v||u,d),y=e?e+h:h;return u._events[y]?u._events[y].fn?u._events[y]=[u._events[y],f]:u._events[y].push(f):(u._events[y]=f,u._eventsCount++),u}function o(u,h){--u._eventsCount===0?u._events=new s:delete u._events[h]}function a(){this._events=new s,this._eventsCount=0}a.prototype.eventNames=function(){var h=[],b,v;if(this._eventsCount===0)return h;for(v in b=this._events)t.call(b,v)&&h.push(e?v.slice(1):v);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(b)):h},a.prototype.listeners=function(h){var b=e?e+h:h,v=this._events[b];if(!v)return[];if(v.fn)return[v.fn];for(var d=0,f=v.length,y=new Array(f);d<f;d++)y[d]=v[d].fn;return y},a.prototype.listenerCount=function(h){var b=e?e+h:h,v=this._events[b];return v?v.fn?1:v.length:0},a.prototype.emit=function(h,b,v,d,f,y){var N=e?e+h:h;if(!this._events[N])return!1;var w=this._events[N],L=arguments.length,I,B;if(w.fn){switch(w.once&&this.removeListener(h,w.fn,void 0,!0),L){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,b),!0;case 3:return w.fn.call(w.context,b,v),!0;case 4:return w.fn.call(w.context,b,v,d),!0;case 5:return w.fn.call(w.context,b,v,d,f),!0;case 6:return w.fn.call(w.context,b,v,d,f,y),!0}for(B=1,I=new Array(L-1);B<L;B++)I[B-1]=arguments[B];w.fn.apply(w.context,I)}else{var X=w.length,j;for(B=0;B<X;B++)switch(w[B].once&&this.removeListener(h,w[B].fn,void 0,!0),L){case 1:w[B].fn.call(w[B].context);break;case 2:w[B].fn.call(w[B].context,b);break;case 3:w[B].fn.call(w[B].context,b,v);break;case 4:w[B].fn.call(w[B].context,b,v,d);break;default:if(!I)for(j=1,I=new Array(L-1);j<L;j++)I[j-1]=arguments[j];w[B].fn.apply(w[B].context,I)}}return!0},a.prototype.on=function(h,b,v){return i(this,h,b,v,!1)},a.prototype.once=function(h,b,v){return i(this,h,b,v,!0)},a.prototype.removeListener=function(h,b,v,d){var f=e?e+h:h;if(!this._events[f])return this;if(!b)return o(this,f),this;var y=this._events[f];if(y.fn)y.fn===b&&(!d||y.once)&&(!v||y.context===v)&&o(this,f);else{for(var N=0,w=[],L=y.length;N<L;N++)(y[N].fn!==b||d&&!y[N].once||v&&y[N].context!==v)&&w.push(y[N]);w.length?this._events[f]=w.length===1?w[0]:w:o(this,f)}return this},a.prototype.removeAllListeners=function(h){var b;return h?(b=e?e+h:h,this._events[b]&&o(this,b)):(this._events=new s,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=e,a.EventEmitter=a,n.exports=a})(yn)),yn.exports}var uc=cc();const hc=Wi(uc),On=new WeakMap,In=["error","warn","log","info"];let Rn="warn";function pl(n){if(Rn&&In.indexOf(n)<=In.indexOf(Rn)){for(var t=arguments.length,e=new Array(t>1?t-1:0),s=1;s<t;s++)e[s-1]=arguments[s];console[n](...e)}}function fe(n){return In.reduce((t,e)=>(t[e]=pl.bind(console,e,n),t),{})}fe.level=n=>{Rn=n};pl.level=fe.level;const vn=fe("quill:events"),dc=["selectionchange","mousedown","mouseup","click"];dc.forEach(n=>{document.addEventListener(n,function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];Array.from(document.querySelectorAll(".ql-container")).forEach(r=>{const i=On.get(r);i&&i.emitter&&i.emitter.handleDOM(...e)})})});class _ extends hc{constructor(){super(),this.domListeners={},this.on("error",vn.error)}emit(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return vn.log.call(vn,...e),super.emit(...e)}handleDOM(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),r=1;r<e;r++)s[r-1]=arguments[r];(this.domListeners[t.type]||[]).forEach(i=>{let{node:o,handler:a}=i;(t.target===o||o.contains(t.target))&&a(t,...s)})}listenDOM(t,e,s){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:e,handler:s})}}k(_,"events",{EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"}),k(_,"sources",{API:"api",SILENT:"silent",USER:"user"});const xn=fe("quill:selection");class ke{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=t,this.length=e}}class fc{constructor(t,e){this.emitter=e,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new ke(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,_.sources.USER),1)}),this.emitter.on(_.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const s=this.getNativeRange();s!=null&&s.start.node!==this.cursor.textNode&&this.emitter.once(_.events.SCROLL_UPDATE,(r,i)=>{try{this.root.contains(s.start.node)&&this.root.contains(s.end.node)&&this.setNativeRange(s.start.node,s.start.offset,s.end.node,s.end.offset);const o=i.some(a=>a.type==="characterData"||a.type==="childList"||a.type==="attributes"&&a.target===this.root);this.update(o?_.sources.SILENT:r)}catch{}})}),this.emitter.on(_.events.SCROLL_OPTIMIZE,(s,r)=>{if(r.range){const{startNode:i,startOffset:o,endNode:a,endOffset:u}=r.range;this.setNativeRange(i,o,a,u),this.update(_.sources.SILENT)}}),this.update(_.sources.SILENT)}handleComposition(){this.emitter.on(_.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(_.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const t=this.cursor.restore();if(!t)return;setTimeout(()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(_.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,e){this.scroll.update();const s=this.getNativeRange();if(!(s==null||!s.native.collapsed||this.scroll.query(t,U.BLOCK))){if(s.start.node!==this.cursor.textNode){const r=this.scroll.find(s.start.node,!1);if(r==null)return;if(r instanceof Tt){const i=r.split(s.start.offset);r.parent.insertBefore(this.cursor,i)}else r.insertBefore(this.cursor,s.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.scroll.length();t=Math.min(t,s-1),e=Math.min(t+e,s-1)-t;let r,[i,o]=this.scroll.leaf(t);if(i==null)return null;if(e>0&&o===i.length()){const[b]=this.scroll.leaf(t+1);if(b){const[v]=this.scroll.line(t),[d]=this.scroll.line(t+1);v===d&&(i=b,o=0)}}[r,o]=i.position(o,!0);const a=document.createRange();if(e>0)return a.setStart(r,o),[i,o]=this.scroll.leaf(t+e),i==null?null:([r,o]=i.position(o,!0),a.setEnd(r,o),a.getBoundingClientRect());let u="left",h;if(r instanceof Text){if(!r.data.length)return null;o<r.data.length?(a.setStart(r,o),a.setEnd(r,o+1)):(a.setStart(r,o-1),a.setEnd(r,o),u="right"),h=a.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;h=i.domNode.getBoundingClientRect(),o>0&&(u="right")}return{bottom:h.top+h.height,height:h.height,left:h[u],right:h[u],top:h.top,width:0}}getNativeRange(){const t=document.getSelection();if(t==null||t.rangeCount<=0)return null;const e=t.getRangeAt(0);if(e==null)return null;const s=this.normalizeNative(e);return xn.info("getNativeRange",s),s}getRange(){const t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];const e=this.getNativeRange();return e==null?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Nn(this.root,document.activeElement)}normalizedToRange(t){const e=[[t.start.node,t.start.offset]];t.native.collapsed||e.push([t.end.node,t.end.offset]);const s=e.map(o=>{const[a,u]=o,h=this.scroll.find(a,!0),b=h.offset(this.scroll);return u===0?b:h instanceof Tt?b+h.index(a,u):b+h.length()}),r=Math.min(Math.max(...s),this.scroll.length()-1),i=Math.min(r,...s);return new ke(i,r-i)}normalizeNative(t){if(!Nn(this.root,t.startContainer)||!t.collapsed&&!Nn(this.root,t.endContainer))return null;const e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach(s=>{let{node:r,offset:i}=s;for(;!(r instanceof Text)&&r.childNodes.length>0;)if(r.childNodes.length>i)r=r.childNodes[i],i=0;else if(r.childNodes.length===i)r=r.lastChild,r instanceof Text?i=r.data.length:r.childNodes.length>0?i=r.childNodes.length:i=r.childNodes.length+1;else break;s.node=r,s.offset=i}),e}rangeToNative(t){const e=this.scroll.length(),s=(r,i)=>{r=Math.min(e-1,r);const[o,a]=this.scroll.leaf(r);return o?o.position(a,i):[null,-1]};return[...s(t.index,!1),...s(t.index+t.length,!0)]}setNativeRange(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(xn.info("setNativeRange",t,e,s,r),t!=null&&(this.root.parentNode==null||t.parentNode==null||s.parentNode==null))return;const o=document.getSelection();if(o!=null)if(t!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:a}=this.getNativeRange()||{};if(a==null||i||t!==a.startContainer||e!==a.startOffset||s!==a.endContainer||r!==a.endOffset){t instanceof Element&&t.tagName==="BR"&&(e=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),s instanceof Element&&s.tagName==="BR"&&(r=Array.from(s.parentNode.childNodes).indexOf(s),s=s.parentNode);const u=document.createRange();u.setStart(t,e),u.setEnd(s,r),o.removeAllRanges(),o.addRange(u)}}else o.removeAllRanges(),this.root.blur()}setRange(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.sources.API;if(typeof e=="string"&&(s=e,e=!1),xn.info("setRange",t),t!=null){const r=this.rangeToNative(t);this.setNativeRange(...r,e)}else this.setNativeRange(null);this.update(s)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.sources.USER;const e=this.lastRange,[s,r]=this.getRange();if(this.lastRange=s,this.lastNative=r,this.lastRange!=null&&(this.savedRange=this.lastRange),!Gn(e,this.lastRange)){if(!this.composing&&r!=null&&r.native.collapsed&&r.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const i=[_.events.SELECTION_CHANGE,es(this.lastRange),es(e),t];this.emitter.emit(_.events.EDITOR_CHANGE,...i),t!==_.sources.SILENT&&this.emitter.emit(...i)}}}function Nn(n,t){try{t.parentNode}catch{return!1}return n.contains(t)}const pc=/^[ -~]*$/;class gc{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const s=Ci(t),r=new D;return bc(s.ops.slice()).reduce((o,a)=>{const u=Bt.Op.length(a);let h=a.attributes||{},b=!1,v=!1;if(a.insert!=null){if(r.retain(u),typeof a.insert=="string"){const y=a.insert;v=!y.endsWith(`
`)&&(e<=o||!!this.scroll.descendant(Mt,o)[0]),this.scroll.insertAt(o,y);const[N,w]=this.scroll.line(o);let L=Ne({},_t(N));if(N instanceof Nt){const[I]=N.descendant(Tt,w);I&&(L=Ne(L,_t(I)))}h=Bt.AttributeMap.diff(L,h)||{}}else if(typeof a.insert=="object"){const y=Object.keys(a.insert)[0];if(y==null)return o;const N=this.scroll.query(y,U.INLINE)!=null;if(N)(e<=o||this.scroll.descendant(Mt,o)[0])&&(v=!0);else if(o>0){const[w,L]=this.scroll.descendant(Tt,o-1);w instanceof Zt?w.value()[L]!==`
`&&(b=!0):w instanceof Ot&&w.statics.scope===U.INLINE_BLOT&&(b=!0)}if(this.scroll.insertAt(o,y,a.insert[y]),N){const[w]=this.scroll.descendant(Tt,o);if(w){const L=Ne({},_t(w));h=Bt.AttributeMap.diff(L,h)||{}}}}e+=u}else if(r.push(a),a.retain!==null&&typeof a.retain=="object"){const y=Object.keys(a.retain)[0];if(y==null)return o;this.scroll.updateEmbedAt(o,y,a.retain[y])}Object.keys(h).forEach(y=>{this.scroll.formatAt(o,u,y,h[y])});const d=b?1:0,f=v?1:0;return e+=d+f,r.retain(d),r.delete(f),o+u+d+f},0),r.reduce((o,a)=>typeof a.delete=="number"?(this.scroll.deleteAt(o,a.delete),o):o+Bt.Op.length(a),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(s)}deleteText(t,e){return this.scroll.deleteAt(t,e),this.update(new D().retain(t).delete(e))}formatLine(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(s).forEach(i=>{this.scroll.lines(t,Math.max(e,1)).forEach(o=>{o.format(i,s[i])})}),this.scroll.optimize();const r=new D().retain(t).retain(e,es(s));return this.update(r)}formatText(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s).forEach(i=>{this.scroll.formatAt(t,e,i,s[i])});const r=new D().retain(t).retain(e,es(s));return this.update(r)}getContents(t,e){return this.delta.slice(t,t+e)}getDelta(){return this.scroll.lines().reduce((t,e)=>t.concat(e.delta()),new D)}getFormat(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=[],r=[];e===0?this.scroll.path(t).forEach(a=>{const[u]=a;u instanceof Nt?s.push(u):u instanceof Tt&&r.push(u)}):(s=this.scroll.lines(t,e),r=this.scroll.descendants(Tt,t,e));const[i,o]=[s,r].map(a=>{const u=a.shift();if(u==null)return{};let h=_t(u);for(;Object.keys(h).length>0;){const b=a.shift();if(b==null)return h;h=mc(_t(b),h)}return h});return{...i,...o}}getHTML(t,e){const[s,r]=this.scroll.line(t);if(s){const i=s.length();return s.length()>=r+e&&!(r===0&&e===i)?_s(s,r,e,!0):_s(this.scroll,t,e,!0)}return""}getText(t,e){return this.getContents(t,e).filter(s=>typeof s.insert=="string").map(s=>s.insert).join("")}insertContents(t,e){const s=Ci(e),r=new D().retain(t).concat(s);return this.scroll.insertContents(t,s),this.update(r)}insertEmbed(t,e,s){return this.scroll.insertAt(t,e,s),this.update(new D().retain(t).insert({[e]:s}))}insertText(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(t,e),Object.keys(s).forEach(r=>{this.scroll.formatAt(t,e.length,r,s[r])}),this.update(new D().retain(t).insert(e,es(s)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const t=this.scroll.children.head;if((t==null?void 0:t.statics.blotName)!==Nt.blotName)return!1;const e=t;return e.children.length>1?!1:e.children.head instanceof Xt}removeFormat(t,e){const s=this.getText(t,e),[r,i]=this.scroll.line(t+e);let o=0,a=new D;r!=null&&(o=r.length()-i,a=r.delta().slice(i,i+o-1).insert(`
`));const h=this.getContents(t,e+o).diff(new D().insert(s).concat(a)),b=new D().retain(t).concat(h);return this.applyDelta(b)}update(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const r=this.delta;if(e.length===1&&e[0].type==="characterData"&&e[0].target.data.match(pc)&&this.scroll.find(e[0].target)){const i=this.scroll.find(e[0].target),o=_t(i),a=i.offset(this.scroll),u=e[0].oldValue.replace(is.CONTENTS,""),h=new D().insert(u),b=new D().insert(i.value()),v=s&&{oldRange:Si(s.oldRange,-a),newRange:Si(s.newRange,-a)};t=new D().retain(a).concat(h.diff(b,v)).reduce((f,y)=>y.insert?f.insert(y.insert,o):f.push(y),new D),this.delta=r.compose(t)}else this.delta=this.getDelta(),(!t||!Gn(r.compose(t),this.delta))&&(t=r.diff(this.delta,s));return t}}function Xe(n,t,e){if(n.length===0){const[f]=En(e.pop());return t<=0?`</li></${f}>`:`</li></${f}>${Xe([],t-1,e)}`}const[{child:s,offset:r,length:i,indent:o,type:a},...u]=n,[h,b]=En(a);if(o>t)return e.push(a),o===t+1?`<${h}><li${b}>${_s(s,r,i)}${Xe(u,o,e)}`:`<${h}><li>${Xe(n,t+1,e)}`;const v=e[e.length-1];if(o===t&&a===v)return`</li><li${b}>${_s(s,r,i)}${Xe(u,o,e)}`;const[d]=En(e.pop());return`</li></${d}>${Xe(n,t-1,e)}`}function _s(n,t,e){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(t,e);if(n instanceof Zt)return wr(n.value().slice(t,t+e)).replaceAll(" ","&nbsp;");if(n instanceof Kt){if(n.statics.blotName==="list-container"){const h=[];return n.children.forEachAt(t,e,(b,v,d)=>{const f="formats"in b&&typeof b.formats=="function"?b.formats():{};h.push({child:b,offset:v,length:d,indent:f.indent||0,type:f.list})}),Xe(h,-1,[])}const r=[];if(n.children.forEachAt(t,e,(h,b,v)=>{r.push(_s(h,b,v))}),s||n.statics.blotName==="list")return r.join("");const{outerHTML:i,innerHTML:o}=n.domNode,[a,u]=i.split(`>${o}<`);return a==="<table"?`<table style="border: 1px solid #000;">${r.join("")}<${u}`:`${a}>${r.join("")}<${u}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function mc(n,t){return Object.keys(t).reduce((e,s)=>{if(n[s]==null)return e;const r=t[s];return r===n[s]?e[s]=r:Array.isArray(r)?r.indexOf(n[s])<0?e[s]=r.concat([n[s]]):e[s]=r:e[s]=[r,n[s]],e},{})}function En(n){const t=n==="ordered"?"ol":"ul";switch(n){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function Ci(n){return n.reduce((t,e)=>{if(typeof e.insert=="string"){const s=e.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return t.insert(s,e.attributes)}return t.push(e)},new D)}function Si(n,t){let{index:e,length:s}=n;return new ke(e+t,s)}function bc(n){const t=[];return n.forEach(e=>{typeof e.insert=="string"?e.insert.split(`
`).forEach((r,i)=>{i&&t.push({insert:`
`,attributes:e.attributes}),r&&t.push({insert:r,attributes:e.attributes})}):t.push(e)}),t}class Yt{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=t,this.options=e}}k(Yt,"DEFAULTS",{});const ur="\uFEFF";let Wn=class extends Ot{constructor(t,e){super(t,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(s=>{this.contentNode.appendChild(s)}),this.leftGuard=document.createTextNode(ur),this.rightGuard=document.createTextNode(ur),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,e){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,e)}restore(t){let e=null,s;const r=t.data.split(ur).join("");if(t===this.leftGuard)if(this.prev instanceof Zt){const i=this.prev.length();this.prev.insertAt(i,r),e={startNode:this.prev.domNode,startOffset:i+r.length}}else s=document.createTextNode(r),this.parent.insertBefore(this.scroll.create(s),this),e={startNode:s,startOffset:r.length};else t===this.rightGuard&&(this.next instanceof Zt?(this.next.insertAt(0,r),e={startNode:this.next.domNode,startOffset:r.length}):(s=document.createTextNode(r),this.parent.insertBefore(this.scroll.create(s),this.next),e={startNode:s,startOffset:r.length}));return t.data=ur,e}update(t,e){t.forEach(s=>{if(s.type==="characterData"&&(s.target===this.leftGuard||s.target===this.rightGuard)){const r=this.restore(s.target);r&&(e.range=r)}})}};class yc{constructor(t,e){k(this,"isComposing",!1);this.scroll=t,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",t=>{this.isComposing||this.handleCompositionStart(t)}),this.scroll.domNode.addEventListener("compositionend",t=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(t)})})}handleCompositionStart(t){const e=t.target instanceof Node?this.scroll.find(t.target,!0):null;e&&!(e instanceof Wn)&&(this.emitter.emit(_.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit(_.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit(_.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit(_.events.COMPOSITION_END,t),this.isComposing=!1}}const Os=class Os{constructor(t,e){k(this,"modules",{});this.quill=t,this.options=e}init(){Object.keys(this.options.modules).forEach(t=>{this.modules[t]==null&&this.addModule(t)})}addModule(t){const e=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}};k(Os,"DEFAULTS",{modules:{}}),k(Os,"themes",{default:Os});let ls=Os;const vc=n=>n.parentElement||n.getRootNode().host||null,xc=n=>{const t=n.getBoundingClientRect(),e="offsetWidth"in n&&Math.abs(t.width)/n.offsetWidth||1,s="offsetHeight"in n&&Math.abs(t.height)/n.offsetHeight||1;return{top:t.top,right:t.left+n.clientWidth*e,bottom:t.top+n.clientHeight*s,left:t.left}},hr=n=>{const t=parseInt(n,10);return Number.isNaN(t)?0:t},qi=(n,t,e,s,r,i)=>n<e&&t>s?0:n<e?-(e-n+r):t>s?t-n>s-e?n+r-e:t-s+i:0,Nc=(n,t)=>{var i,o,a;const e=n.ownerDocument;let s=t,r=n;for(;r;){const u=r===e.body,h=u?{top:0,right:((i=window.visualViewport)==null?void 0:i.width)??e.documentElement.clientWidth,bottom:((o=window.visualViewport)==null?void 0:o.height)??e.documentElement.clientHeight,left:0}:xc(r),b=getComputedStyle(r),v=qi(s.left,s.right,h.left,h.right,hr(b.scrollPaddingLeft),hr(b.scrollPaddingRight)),d=qi(s.top,s.bottom,h.top,h.bottom,hr(b.scrollPaddingTop),hr(b.scrollPaddingBottom));if(v||d)if(u)(a=e.defaultView)==null||a.scrollBy(v,d);else{const{scrollLeft:f,scrollTop:y}=r;d&&(r.scrollTop+=d),v&&(r.scrollLeft+=v);const N=r.scrollLeft-f,w=r.scrollTop-y;s={left:s.left-N,top:s.top-w,right:s.right-N,bottom:s.bottom-w}}r=u||b.position==="fixed"?null:vc(r)}},Ec=100,Ac=["block","break","cursor","inline","scroll","text"],wc=(n,t,e)=>{const s=new ns;return Ac.forEach(r=>{const i=t.query(r);i&&s.register(i)}),n.forEach(r=>{let i=t.query(r);i||e.error(`Cannot register "${r}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(s.register(i),i="blotName"in i?i.requiredContainer??null:null,o+=1,o>Ec){e.error(`Cycle detected in registering blot requiredContainer: "${r}"`);break}}),s},rs=fe("quill"),dr=new ns;Kt.uiClass="ql-ui";const zt=class zt{static debug(t){t===!0&&(t="log"),fe.level(t)}static find(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return On.get(t)||dr.find(t,e)}static import(t){return this.imports[t]==null&&rs.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const t=arguments.length<=0?void 0:arguments[0],e=!!(!(arguments.length<=1)&&arguments[1]),s="attrName"in t?t.attrName:t.blotName;typeof s=="string"?this.register(`formats/${s}`,t,e):Object.keys(t).forEach(r=>{this.register(r,t[r],e)})}else{const t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],s=!!(!(arguments.length<=2)&&arguments[2]);this.imports[t]!=null&&!s&&rs.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&e&&typeof e!="boolean"&&e.blotName!=="abstract"&&dr.register(e),typeof e.register=="function"&&e.register(dr)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=Tc(t,e),this.container=this.options.container,this.container==null){rs.error("Invalid Quill container",t);return}this.options.debug&&zt.debug(this.options.debug);const s=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",On.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new _;const r=Zn.blotName,i=this.options.registry.query(r);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${r}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new gc(this.scroll),this.selection=new fc(this.scroll,this.emitter),this.composition=new yc(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(_.events.EDITOR_CHANGE,o=>{o===_.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(_.events.SCROLL_UPDATE,(o,a)=>{const u=this.selection.lastRange,[h]=this.selection.getRange(),b=u&&h?{oldRange:u,newRange:h}:void 0;Ht.call(this,()=>this.editor.update(null,a,b),o)}),this.emitter.on(_.events.SCROLL_EMBED_UPDATE,(o,a)=>{const u=this.selection.lastRange,[h]=this.selection.getRange(),b=u&&h?{oldRange:u,newRange:h}:void 0;Ht.call(this,()=>{const v=new D().retain(o.offset(this)).retain({[o.statics.blotName]:a});return this.editor.update(v,[],b)},zt.sources.USER)}),s){const o=this.clipboard.convert({html:`${s}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof t=="string"){const s=t;t=document.createElement("div"),t.classList.add(s)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,s){return[t,e,,s]=ue(t,e,s),Ht.call(this,()=>this.editor.deleteText(t,e),s,t,-1*e)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;const e=t();return this.allowReadOnlyEdits=!1,e}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.sources.API;return Ht.call(this,()=>{const r=this.getSelection(!0);let i=new D;if(r==null)return i;if(this.scroll.query(t,U.BLOCK))i=this.editor.formatLine(r.index,r.length,{[t]:e});else{if(r.length===0)return this.selection.format(t,e),i;i=this.editor.formatText(r.index,r.length,{[t]:e})}return this.setSelection(r,_.sources.SILENT),i},s)}formatLine(t,e,s,r,i){let o;return[t,e,o,i]=ue(t,e,s,r,i),Ht.call(this,()=>this.editor.formatLine(t,e,o),i,t,0)}formatText(t,e,s,r,i){let o;return[t,e,o,i]=ue(t,e,s,r,i),Ht.call(this,()=>this.editor.formatText(t,e,o),i,t,0)}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=null;if(typeof t=="number"?s=this.selection.getBounds(t,e):s=this.selection.getBounds(t.index,t.length),!s)return null;const r=this.container.getBoundingClientRect();return{bottom:s.bottom-r.top,height:s.height,left:s.left-r.left,right:s.right-r.left,top:s.top-r.top,width:s.width}}getContents(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-t;return[t,e]=ue(t,e),this.editor.getContents(t,e)}getFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof t=="number"?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof t!="number"?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e??this.getLength()-t),[t,e]=ue(t,e),this.editor.getHTML(t,e)}getText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e??this.getLength()-t),[t,e]=ue(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,s){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:zt.sources.API;return Ht.call(this,()=>this.editor.insertEmbed(t,e,s),r,t)}insertText(t,e,s,r,i){let o;return[t,,o,i]=ue(t,0,s,r,i),Ht.call(this,()=>this.editor.insertText(t,e,o),i,t,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(t,e,s){return[t,e,,s]=ue(t,e,s),Ht.call(this,()=>this.editor.removeFormat(t,e),s,t)}scrollRectIntoView(t){Nc(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const t=this.selection.lastRange,e=t&&this.selection.getBounds(t.index,t.length);e&&this.scrollRectIntoView(e)}setContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.sources.API;return Ht.call(this,()=>{t=new D(t);const s=this.getLength(),r=this.editor.deleteText(0,s),i=this.editor.insertContents(0,t),o=this.editor.deleteText(this.getLength()-1,1);return r.compose(i).compose(o)},e)}setSelection(t,e,s){t==null?this.selection.setRange(null,e||zt.sources.API):([t,e,,s]=ue(t,e,s),this.selection.setRange(new ke(Math.max(0,t),e),s),s!==_.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.sources.API;const s=new D().insert(t);return this.setContents(s,e)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.sources.USER;const e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.sources.API;return Ht.call(this,()=>(t=new D(t),this.editor.applyDelta(t)),e,!0)}};k(zt,"DEFAULTS",{bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:dr,theme:"default"}),k(zt,"events",_.events),k(zt,"sources",_.sources),k(zt,"version","2.0.3"),k(zt,"imports",{delta:D,parchment:rc,"core/module":Yt,"core/theme":ls});let A=zt;function ki(n){return typeof n=="string"?document.querySelector(n):n}function An(n){return Object.entries(n??{}).reduce((t,e)=>{let[s,r]=e;return{...t,[s]:r===!0?{}:r}},{})}function Oi(n){return Object.fromEntries(Object.entries(n).filter(t=>t[1]!==void 0))}function Tc(n,t){const e=ki(n);if(!e)throw new Error("Invalid Quill container");const r=!t.theme||t.theme===A.DEFAULTS.theme?ls:A.import(`themes/${t.theme}`);if(!r)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);const{modules:i,...o}=A.DEFAULTS,{modules:a,...u}=r.DEFAULTS;let h=An(t.modules);h!=null&&h.toolbar&&h.toolbar.constructor!==Object&&(h={...h,toolbar:{container:h.toolbar}});const b=Ne({},An(i),An(a),h),v={...o,...Oi(u),...Oi(t)};let d=t.registry;return d?t.formats&&rs.warn('Ignoring "formats" option because "registry" is specified'):d=t.formats?wc(t.formats,v.registry,rs):v.registry,{...v,registry:d,container:e,theme:r,modules:Object.entries(b).reduce((f,y)=>{let[N,w]=y;if(!w)return f;const L=A.import(`modules/${N}`);return L==null?(rs.error(`Cannot load ${N} module. Are you sure you registered it?`),f):{...f,[N]:Ne({},L.DEFAULTS||{},w)}},{}),bounds:ki(v.bounds)}}function Ht(n,t,e,s){if(!this.isEnabled()&&t===_.sources.USER&&!this.allowReadOnlyEdits)return new D;let r=e==null?null:this.getSelection();const i=this.editor.delta,o=n();if(r!=null&&(e===!0&&(e=r.index),s==null?r=Ii(r,o,t):s!==0&&(r=Ii(r,e,s,t)),this.setSelection(r,_.sources.SILENT)),o.length()>0){const a=[_.events.TEXT_CHANGE,o,i,t];this.emitter.emit(_.events.EDITOR_CHANGE,...a),t!==_.sources.SILENT&&this.emitter.emit(...a)}return o}function ue(n,t,e,s,r){let i={};return typeof n.index=="number"&&typeof n.length=="number"?typeof t!="number"?(r=s,s=e,e=t,t=n.length,n=n.index):(t=n.length,n=n.index):typeof t!="number"&&(r=s,s=e,e=t,t=0),typeof e=="object"?(i=e,r=s):typeof e=="string"&&(s!=null?i[e]=s:r=e),r=r||_.sources.API,[n,t,i,r]}function Ii(n,t,e,s){const r=typeof e=="number"?e:0;if(n==null)return null;let i,o;return t&&typeof t.transformPosition=="function"?[i,o]=[n.index,n.index+n.length].map(a=>t.transformPosition(a,s!==_.sources.USER)):[i,o]=[n.index,n.index+n.length].map(a=>a<t||a===t&&s===_.sources.USER?a:r>=0?a+r:Math.max(t,a+r)),new ke(i,o-i)}class Oe extends Ar{}function Ri(n){return n instanceof Nt||n instanceof Mt}function _i(n){return typeof n.updateContent=="function"}class Ye extends Zn{constructor(t,e,s){let{emitter:r}=s;super(t,e),this.emitter=r,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit(_.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit(_.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,e){this.emitter.emit(_.events.SCROLL_EMBED_UPDATE,t,e)}deleteAt(t,e){const[s,r]=this.line(t),[i]=this.line(t+e);if(super.deleteAt(t,e),i!=null&&s!==i&&r>0){if(s instanceof Mt||i instanceof Mt){this.optimize();return}const o=i.children.head instanceof Xt?null:i.children.head;s.moveChildren(i,o),s.remove()}this.optimize()}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,e,s,r){super.formatAt(t,e,s,r),this.optimize()}insertAt(t,e,s){if(t>=this.length())if(s==null||this.scroll.query(e,U.BLOCK)==null){const r=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(r),s==null&&e.endsWith(`
`)?r.insertAt(0,e.slice(0,-1),s):r.insertAt(0,e,s)}else{const r=this.scroll.create(e,s);this.appendChild(r)}else super.insertAt(t,e,s);this.optimize()}insertBefore(t,e){if(t.statics.scope===U.INLINE_BLOT){const s=this.scroll.create(this.statics.defaultChild.blotName);s.appendChild(t),super.insertBefore(s,e)}else super.insertBefore(t,e)}insertContents(t,e){const s=this.deltaToRenderBlocks(e.concat(new D().insert(`
`))),r=s.pop();if(r==null)return;this.batchStart();const i=s.shift();if(i){const u=i.type==="block"&&(i.delta.length()===0||!this.descendant(Mt,t)[0]&&t<this.length()),h=i.type==="block"?i.delta:new D().insert({[i.key]:i.value});wn(this,t,h);const b=i.type==="block"?1:0,v=t+h.length()+b;u&&this.insertAt(v-1,`
`);const d=_t(this.line(t)[0]),f=Bt.AttributeMap.diff(d,i.attributes)||{};Object.keys(f).forEach(y=>{this.formatAt(v-1,1,y,f[y])}),t=v}let[o,a]=this.children.find(t);if(s.length&&(o&&(o=o.split(a),a=0),s.forEach(u=>{if(u.type==="block"){const h=this.createBlock(u.attributes,o||void 0);wn(h,0,u.delta)}else{const h=this.create(u.key,u.value);this.insertBefore(h,o||void 0),Object.keys(u.attributes).forEach(b=>{h.format(b,u.attributes[b])})}})),r.type==="block"&&r.delta.length()){const u=o?o.offset(o.scroll)+a:this.length();wn(this,u,r.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(t){const e=this.path(t).pop();if(!e)return[null,-1];const[s,r]=e;return s instanceof Tt?[s,r]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(Ri,t)}lines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const s=(r,i,o)=>{let a=[],u=o;return r.children.forEachAt(i,o,(h,b,v)=>{Ri(h)?a.push(h):h instanceof Ar&&(a=a.concat(s(h,b,u))),u-=v}),a};return s(this,t,e)}optimize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(t,e),t.length>0&&this.emitter.emit(_.events.SCROLL_OPTIMIZE,t,e))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch){Array.isArray(t)&&(this.batch=this.batch.concat(t));return}let e=_.sources.USER;typeof t=="string"&&(e=t),Array.isArray(t)||(t=this.observer.takeRecords()),t=t.filter(s=>{let{target:r}=s;const i=this.find(r,!0);return i&&!_i(i)}),t.length>0&&this.emitter.emit(_.events.SCROLL_BEFORE_UPDATE,e,t),super.update(t.concat([])),t.length>0&&this.emitter.emit(_.events.SCROLL_UPDATE,e,t)}updateEmbedAt(t,e,s){const[r]=this.descendant(i=>i instanceof Mt,t);r&&r.statics.blotName===e&&_i(r)&&r.updateContent(s)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){const e=[];let s=new D;return t.forEach(r=>{const i=r==null?void 0:r.insert;if(i)if(typeof i=="string"){const o=i.split(`
`);o.slice(0,-1).forEach(u=>{s.insert(u,r.attributes),e.push({type:"block",delta:s,attributes:r.attributes??{}}),s=new D});const a=o[o.length-1];a&&s.insert(a,r.attributes)}else{const o=Object.keys(i)[0];if(!o)return;this.query(o,U.INLINE)?s.push(r):(s.length()&&e.push({type:"block",delta:s,attributes:{}}),s=new D,e.push({type:"blockEmbed",key:o,value:i[o],attributes:r.attributes??{}}))}}),s.length()&&e.push({type:"block",delta:s,attributes:{}}),e}createBlock(t,e){let s;const r={};Object.entries(t).forEach(a=>{let[u,h]=a;this.query(u,U.BLOCK&U.BLOT)!=null?s=u:r[u]=h});const i=this.create(s||this.statics.defaultChild.blotName,s?t[s]:void 0);this.insertBefore(i,e||void 0);const o=i.length();return Object.entries(r).forEach(a=>{let[u,h]=a;i.formatAt(0,o,u,h)}),i}}k(Ye,"blotName","scroll"),k(Ye,"className","ql-editor"),k(Ye,"tagName","DIV"),k(Ye,"defaultChild",Nt),k(Ye,"allowedChildren",[Nt,Mt,Oe]);function wn(n,t,e){e.reduce((s,r)=>{const i=Bt.Op.length(r);let o=r.attributes||{};if(r.insert!=null){if(typeof r.insert=="string"){const a=r.insert;n.insertAt(s,a);const[u]=n.descendant(Tt,s),h=_t(u);o=Bt.AttributeMap.diff(h,o)||{}}else if(typeof r.insert=="object"){const a=Object.keys(r.insert)[0];if(a==null)return s;if(n.insertAt(s,a,r.insert[a]),n.scroll.query(a,U.INLINE)!=null){const[h]=n.descendant(Tt,s),b=_t(h);o=Bt.AttributeMap.diff(b,o)||{}}}}return Object.keys(o).forEach(a=>{n.formatAt(s,i,a,o[a])}),s+i},t)}const Xn={scope:U.BLOCK,whitelist:["right","center","justify"]},Lc=new ne("align","align",Xn),gl=new Wt("align","ql-align",Xn),ml=new Ee("align","text-align",Xn);class bl extends Ee{value(t){let e=super.value(t);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map(r=>`00${parseInt(r,10).toString(16)}`.slice(-2)).join("")}`):e}}const Cc=new Wt("color","ql-color",{scope:U.INLINE}),Yn=new bl("color","color",{scope:U.INLINE}),Sc=new Wt("background","ql-bg",{scope:U.INLINE}),Qn=new bl("background","background-color",{scope:U.INLINE});class Ie extends Oe{static create(t){const e=super.create(t);return e.setAttribute("spellcheck","false"),e}code(t,e){return this.children.map(s=>s.length()<=1?"":s.domNode.innerText).join(`
`).slice(t,t+e)}html(t,e){return`<pre>
${wr(this.code(t,e))}
</pre>`}}class Lt extends Nt{static register(){A.register(Ie)}}k(Lt,"TAB","  ");class Jn extends ie{}Jn.blotName="code";Jn.tagName="CODE";Lt.blotName="code-block";Lt.className="ql-code-block";Lt.tagName="DIV";Ie.blotName="code-block-container";Ie.className="ql-code-block-container";Ie.tagName="DIV";Ie.allowedChildren=[Lt];Lt.allowedChildren=[Zt,Xt,is];Lt.requiredContainer=Ie;const ti={scope:U.BLOCK,whitelist:["rtl"]},yl=new ne("direction","dir",ti),vl=new Wt("direction","ql-direction",ti),xl=new Ee("direction","direction",ti),Nl={scope:U.INLINE,whitelist:["serif","monospace"]},El=new Wt("font","ql-font",Nl);class qc extends Ee{value(t){return super.value(t).replace(/["']/g,"")}}const Al=new qc("font","font-family",Nl),wl=new Wt("size","ql-size",{scope:U.INLINE,whitelist:["small","large","huge"]}),Tl=new Ee("size","font-size",{scope:U.INLINE,whitelist:["10px","18px","32px"]}),kc=fe("quill:keyboard"),Oc=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Tr extends Yt{static match(t,e){return["altKey","ctrlKey","metaKey","shiftKey"].some(s=>!!e[s]!==t[s]&&e[s]!==null)?!1:e.key===t.key||e.key===t.which}constructor(t,e){super(t,e),this.bindings={},Object.keys(this.options.bindings).forEach(s=>{this.options.bindings[s]&&this.addBinding(this.options.bindings[s])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=Rc(t);if(r==null){kc.warn("Attempted to add invalid keyboard binding",r);return}typeof e=="function"&&(e={handler:e}),typeof s=="function"&&(s={handler:s}),(Array.isArray(r.key)?r.key:[r.key]).forEach(o=>{const a={...r,key:o,...e,...s};this.bindings[a.key]=this.bindings[a.key]||[],this.bindings[a.key].push(a)})}listen(){this.quill.root.addEventListener("keydown",t=>{if(t.defaultPrevented||t.isComposing||t.keyCode===229&&(t.key==="Enter"||t.key==="Backspace"))return;const r=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter(L=>Tr.match(t,L));if(r.length===0)return;const i=A.find(t.target,!0);if(i&&i.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[a,u]=this.quill.getLine(o.index),[h,b]=this.quill.getLeaf(o.index),[v,d]=o.length===0?[h,b]:this.quill.getLeaf(o.index+o.length),f=h instanceof vr?h.value().slice(0,b):"",y=v instanceof vr?v.value().slice(d):"",N={collapsed:o.length===0,empty:o.length===0&&a.length()<=1,format:this.quill.getFormat(o),line:a,offset:u,prefix:f,suffix:y,event:t};r.some(L=>{if(L.collapsed!=null&&L.collapsed!==N.collapsed||L.empty!=null&&L.empty!==N.empty||L.offset!=null&&L.offset!==N.offset)return!1;if(Array.isArray(L.format)){if(L.format.every(I=>N.format[I]==null))return!1}else if(typeof L.format=="object"&&!Object.keys(L.format).every(I=>L.format[I]===!0?N.format[I]!=null:L.format[I]===!1?N.format[I]==null:Gn(L.format[I],N.format[I])))return!1;return L.prefix!=null&&!L.prefix.test(N.prefix)||L.suffix!=null&&!L.suffix.test(N.suffix)?!1:L.handler.call(this,o,N,L)!==!0})&&t.preventDefault()})}handleBackspace(t,e){const s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(t.index===0||this.quill.getLength()<=1)return;let r={};const[i]=this.quill.getLine(t.index);let o=new D().retain(t.index-s).delete(s);if(e.offset===0){const[a]=this.quill.getLine(t.index-1);if(a&&!(a.statics.blotName==="block"&&a.length()<=1)){const h=i.formats(),b=this.quill.getFormat(t.index-1,1);if(r=Bt.AttributeMap.diff(h,b)||{},Object.keys(r).length>0){const v=new D().retain(t.index+i.length()-2).retain(1,r);o=o.compose(v)}}}this.quill.updateContents(o,A.sources.USER),this.quill.focus()}handleDelete(t,e){const s=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(t.index>=this.quill.getLength()-s)return;let r={};const[i]=this.quill.getLine(t.index);let o=new D().retain(t.index).delete(s);if(e.offset>=i.length()-1){const[a]=this.quill.getLine(t.index+1);if(a){const u=i.formats(),h=this.quill.getFormat(t.index,1);r=Bt.AttributeMap.diff(u,h)||{},Object.keys(r).length>0&&(o=o.retain(a.length()-1).retain(1,r))}}this.quill.updateContents(o,A.sources.USER),this.quill.focus()}handleDeleteRange(t){ei({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,e){const s=Object.keys(e.format).reduce((i,o)=>(this.quill.scroll.query(o,U.BLOCK)&&!Array.isArray(e.format[o])&&(i[o]=e.format[o]),i),{}),r=new D().retain(t.index).delete(t.length).insert(`
`,s);this.quill.updateContents(r,A.sources.USER),this.quill.setSelection(t.index+1,A.sources.SILENT),this.quill.focus()}}const Ic={bindings:{bold:Tn("bold"),italic:Tn("italic"),underline:Tn("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","+1",A.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","-1",A.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,t){t.format.indent!=null?this.quill.format("indent","-1",A.sources.USER):t.format.list!=null&&this.quill.format("list",!1,A.sources.USER)}},"indent code-block":ji(!0),"outdent code-block":ji(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,A.sources.USER)}},tab:{key:"Tab",handler(n,t){if(t.format.table)return!0;this.quill.history.cutoff();const e=new D().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(e,A.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,A.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,A.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,t){const e={list:!1};t.format.indent&&(e.indent=!1),this.quill.formatLine(n.index,n.length,e,A.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[t,e]=this.quill.getLine(n.index),s={...t.formats(),list:"checked"},r=new D().retain(n.index).insert(`
`,s).retain(t.length()-e-1).retain(1,{list:"unchecked"});this.quill.updateContents(r,A.sources.USER),this.quill.setSelection(n.index+1,A.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,t){const[e,s]=this.quill.getLine(n.index),r=new D().retain(n.index).insert(`
`,t.format).retain(e.length()-s-1).retain(1,{header:null});this.quill.updateContents(r,A.sources.USER),this.quill.setSelection(n.index+1,A.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const t=this.quill.getModule("table");if(t){const[e,s,r,i]=t.getTable(n),o=_c(e,s,r,i);if(o==null)return;let a=e.offset();if(o<0){const u=new D().retain(a).insert(`
`);this.quill.updateContents(u,A.sources.USER),this.quill.setSelection(n.index+1,n.length,A.sources.SILENT)}else if(o>0){a+=e.length();const u=new D().retain(a).insert(`
`);this.quill.updateContents(u,A.sources.USER),this.quill.setSelection(a,A.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,t){const{event:e,line:s}=t,r=s.offset(this.quill.scroll);e.shiftKey?this.quill.setSelection(r-1,A.sources.USER):this.quill.setSelection(r+s.length(),A.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,t){if(this.quill.scroll.query("list")==null)return!0;const{length:e}=t.prefix,[s,r]=this.quill.getLine(n.index);if(r>e)return!0;let i;switch(t.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(n.index," ",A.sources.USER),this.quill.history.cutoff();const o=new D().retain(n.index-r).delete(e+1).retain(s.length()-2-r).retain(1,{list:i});return this.quill.updateContents(o,A.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-e,A.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[t,e]=this.quill.getLine(n.index);let s=2,r=t;for(;r!=null&&r.length()<=1&&r.formats()["code-block"];)if(r=r.prev,s-=1,s<=0){const i=new D().retain(n.index+t.length()-e-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,A.sources.USER),this.quill.setSelection(n.index-1,A.sources.SILENT),!1}return!0}},"embed left":fr("ArrowLeft",!1),"embed left shift":fr("ArrowLeft",!0),"embed right":fr("ArrowRight",!1),"embed right shift":fr("ArrowRight",!0),"table down":Mi(!1),"table up":Mi(!0)}};Tr.DEFAULTS=Ic;function ji(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(t,e){let{event:s}=e;const r=this.quill.scroll.query("code-block"),{TAB:i}=r;if(t.length===0&&!s.shiftKey){this.quill.insertText(t.index,i,A.sources.USER),this.quill.setSelection(t.index+i.length,A.sources.SILENT);return}const o=t.length===0?this.quill.getLines(t.index,1):this.quill.getLines(t);let{index:a,length:u}=t;o.forEach((h,b)=>{n?(h.insertAt(0,i),b===0?a+=i.length:u+=i.length):h.domNode.textContent.startsWith(i)&&(h.deleteAt(0,i.length),b===0?a-=i.length:u-=i.length)}),this.quill.update(A.sources.USER),this.quill.setSelection(a,u,A.sources.SILENT)}}}function fr(n,t){return{key:n,shiftKey:t,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(s){let{index:r}=s;n==="ArrowRight"&&(r+=s.length+1);const[i]=this.quill.getLeaf(r);return i instanceof Ot?(n==="ArrowLeft"?t?this.quill.setSelection(s.index-1,s.length+1,A.sources.USER):this.quill.setSelection(s.index-1,A.sources.USER):t?this.quill.setSelection(s.index,s.length+1,A.sources.USER):this.quill.setSelection(s.index+s.length+1,A.sources.USER),!1):!0}}}function Tn(n){return{key:n[0],shortKey:!0,handler(t,e){this.quill.format(n,!e.format[n],A.sources.USER)}}}function Mi(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,e){const s=n?"prev":"next",r=e.line,i=r.parent[s];if(i!=null){if(i.statics.blotName==="table-row"){let o=i.children.head,a=r;for(;a.prev!=null;)a=a.prev,o=o.next;const u=o.offset(this.quill.scroll)+Math.min(e.offset,o.length()-1);this.quill.setSelection(u,0,A.sources.USER)}}else{const o=r.table()[s];o!=null&&(n?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,A.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,A.sources.USER))}return!1}}}function Rc(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=es(n);else return null;return n.shortKey&&(n[Oc]=n.shortKey,delete n.shortKey),n}function ei(n){let{quill:t,range:e}=n;const s=t.getLines(e);let r={};if(s.length>1){const i=s[0].formats(),o=s[s.length-1].formats();r=Bt.AttributeMap.diff(o,i)||{}}t.deleteText(e,A.sources.USER),Object.keys(r).length>0&&t.formatLine(e.index,1,r,A.sources.USER),t.setSelection(e.index,A.sources.SILENT)}function _c(n,t,e,s){return t.prev==null&&t.next==null?e.prev==null&&e.next==null?s===0?-1:1:e.prev==null?-1:1:t.prev==null?-1:t.next==null?1:null}const jc=/font-weight:\s*normal/,Mc=["P","OL","UL"],Bi=n=>n&&Mc.includes(n.tagName),Bc=n=>{Array.from(n.querySelectorAll("br")).filter(t=>Bi(t.previousElementSibling)&&Bi(t.nextElementSibling)).forEach(t=>{var e;(e=t.parentNode)==null||e.removeChild(t)})},Dc=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(t=>{var e;return(e=t.getAttribute("style"))==null?void 0:e.match(jc)}).forEach(t=>{var s;const e=n.createDocumentFragment();e.append(...t.childNodes),(s=t.parentNode)==null||s.replaceChild(e,t)})};function Uc(n){n.querySelector('[id^="docs-internal-guid-"]')&&(Dc(n),Bc(n))}const Pc=/\bmso-list:[^;]*ignore/i,Fc=/\bmso-list:[^;]*\bl(\d+)/i,$c=/\bmso-list:[^;]*\blevel(\d+)/i,Hc=(n,t)=>{const e=n.getAttribute("style"),s=e==null?void 0:e.match(Fc);if(!s)return null;const r=Number(s[1]),i=e==null?void 0:e.match($c),o=i?Number(i[1]):1,a=new RegExp(`@list l${r}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),u=t.match(a),h=u&&u[1]==="bullet"?"bullet":"ordered";return{id:r,indent:o,type:h,element:n}},zc=n=>{var o,a;const t=Array.from(n.querySelectorAll("[style*=mso-list]")),e=[],s=[];t.forEach(u=>{(u.getAttribute("style")||"").match(Pc)?e.push(u):s.push(u)}),e.forEach(u=>{var h;return(h=u.parentNode)==null?void 0:h.removeChild(u)});const r=n.documentElement.innerHTML,i=s.map(u=>Hc(u,r)).filter(u=>u);for(;i.length;){const u=[];let h=i.shift();for(;h;)u.push(h),h=i.length&&((o=i[0])==null?void 0:o.element)===h.element.nextElementSibling&&i[0].id===h.id?i.shift():null;const b=document.createElement("ul");u.forEach(f=>{const y=document.createElement("li");y.setAttribute("data-list",f.type),f.indent>1&&y.setAttribute("class",`ql-indent-${f.indent-1}`),y.innerHTML=f.element.innerHTML,b.appendChild(y)});const v=(a=u[0])==null?void 0:a.element,{parentNode:d}=v??{};v&&(d==null||d.replaceChild(b,v)),u.slice(1).forEach(f=>{let{element:y}=f;d==null||d.removeChild(y)})}};function Vc(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&zc(n)}const Gc=[Vc,Uc],Kc=n=>{n.documentElement&&Gc.forEach(t=>{t(n)})},Zc=fe("quill:clipboard"),Wc=[[Node.TEXT_NODE,ou],[Node.TEXT_NODE,Ui],["br",tu],[Node.ELEMENT_NODE,Ui],[Node.ELEMENT_NODE,Jc],[Node.ELEMENT_NODE,Qc],[Node.ELEMENT_NODE,iu],["li",ru],["ol, ul",nu],["pre",eu],["tr",lu],["b",Ln("bold")],["i",Ln("italic")],["strike",Ln("strike")],["style",su]],Xc=[Lc,yl].reduce((n,t)=>(n[t.keyName]=t,n),{}),Di=[ml,Qn,Yn,xl,Al,Tl].reduce((n,t)=>(n[t.keyName]=t,n),{});class Ll extends Yt{constructor(t,e){super(t,e),this.quill.root.addEventListener("copy",s=>this.onCaptureCopy(s,!1)),this.quill.root.addEventListener("cut",s=>this.onCaptureCopy(s,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],Wc.concat(this.options.matchers??[]).forEach(s=>{let[r,i]=s;this.addMatcher(r,i)})}addMatcher(t,e){this.matchers.push([t,e])}convert(t){let{html:e,text:s}=t,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(r[Lt.blotName])return new D().insert(s||"",{[Lt.blotName]:r[Lt.blotName]});if(!e)return new D().insert(s||"",r);const i=this.convertHTML(e);return Bs(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||r.table)?i.compose(new D().retain(i.length()-1).delete(1)):i}normalizeHTML(t){Kc(t)}convertHTML(t){const e=new DOMParser().parseFromString(t,"text/html");this.normalizeHTML(e);const s=e.body,r=new WeakMap,[i,o]=this.prepareMatching(s,r);return si(this.quill.scroll,s,i,o,r)}dangerouslyPasteHTML(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:A.sources.API;if(typeof t=="string"){const r=this.convert({html:t,text:""});this.quill.setContents(r,e),this.quill.setSelection(0,A.sources.SILENT)}else{const r=this.convert({html:e,text:""});this.quill.updateContents(new D().retain(t).concat(r),s),this.quill.setSelection(t+r.length(),A.sources.SILENT)}}onCaptureCopy(t){var o,a;let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.defaultPrevented)return;t.preventDefault();const[s]=this.quill.selection.getRange();if(s==null)return;const{html:r,text:i}=this.onCopy(s,e);(o=t.clipboardData)==null||o.setData("text/plain",i),(a=t.clipboardData)==null||a.setData("text/html",r),e&&ei({range:s,quill:this.quill})}normalizeURIList(t){return t.split(/\r?\n/).filter(e=>e[0]!=="#").join(`
`)}onCapturePaste(t){var o,a,u,h,b;if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();const e=this.quill.getSelection(!0);if(e==null)return;const s=(o=t.clipboardData)==null?void 0:o.getData("text/html");let r=(a=t.clipboardData)==null?void 0:a.getData("text/plain");if(!s&&!r){const v=(u=t.clipboardData)==null?void 0:u.getData("text/uri-list");v&&(r=this.normalizeURIList(v))}const i=Array.from(((h=t.clipboardData)==null?void 0:h.files)||[]);if(!s&&i.length>0){this.quill.uploader.upload(e,i);return}if(s&&i.length>0){const v=new DOMParser().parseFromString(s,"text/html");if(v.body.childElementCount===1&&((b=v.body.firstElementChild)==null?void 0:b.tagName)==="IMG"){this.quill.uploader.upload(e,i);return}}this.onPaste(e,{html:s,text:r})}onCopy(t){const e=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:e}}onPaste(t,e){let{text:s,html:r}=e;const i=this.quill.getFormat(t.index),o=this.convert({text:s,html:r},i);Zc.log("onPaste",o,{text:s,html:r});const a=new D().retain(t.index).delete(t.length).concat(o);this.quill.updateContents(a,A.sources.USER),this.quill.setSelection(a.length()-t.length,A.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,e){const s=[],r=[];return this.matchers.forEach(i=>{const[o,a]=i;switch(o){case Node.TEXT_NODE:r.push(a);break;case Node.ELEMENT_NODE:s.push(a);break;default:Array.from(t.querySelectorAll(o)).forEach(u=>{if(e.has(u)){const h=e.get(u);h==null||h.push(a)}else e.set(u,[a])});break}}),[s,r]}}k(Ll,"DEFAULTS",{matchers:[]});function Re(n,t,e,s){return s.query(t)?n.reduce((r,i)=>{if(!i.insert)return r;if(i.attributes&&i.attributes[t])return r.push(i);const o=e?{[t]:e}:{};return r.insert(i.insert,{...o,...i.attributes})},new D):n}function Bs(n,t){let e="";for(let s=n.ops.length-1;s>=0&&e.length<t.length;--s){const r=n.ops[s];if(typeof r.insert!="string")break;e=r.insert+e}return e.slice(-1*t.length)===t}function ve(n,t){if(!(n instanceof Element))return!1;const e=t.query(n);return e&&e.prototype instanceof Ot?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function Yc(n,t){return n.previousElementSibling&&n.nextElementSibling&&!ve(n.previousElementSibling,t)&&!ve(n.nextElementSibling,t)}const pr=new WeakMap;function Cl(n){return n==null?!1:(pr.has(n)||(n.tagName==="PRE"?pr.set(n,!0):pr.set(n,Cl(n.parentNode))),pr.get(n))}function si(n,t,e,s,r){return t.nodeType===t.TEXT_NODE?s.reduce((i,o)=>o(t,i,n),new D):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((i,o)=>{let a=si(n,o,e,s,r);return o.nodeType===t.ELEMENT_NODE&&(a=e.reduce((u,h)=>h(o,u,n),a),a=(r.get(o)||[]).reduce((u,h)=>h(o,u,n),a)),i.concat(a)},new D):new D}function Ln(n){return(t,e,s)=>Re(e,n,!0,s)}function Qc(n,t,e){const s=ne.keys(n),r=Wt.keys(n),i=Ee.keys(n),o={};return s.concat(r).concat(i).forEach(a=>{let u=e.query(a,U.ATTRIBUTE);u!=null&&(o[u.attrName]=u.value(n),o[u.attrName])||(u=Xc[a],u!=null&&(u.attrName===a||u.keyName===a)&&(o[u.attrName]=u.value(n)||void 0),u=Di[a],u!=null&&(u.attrName===a||u.keyName===a)&&(u=Di[a],o[u.attrName]=u.value(n)||void 0))}),Object.entries(o).reduce((a,u)=>{let[h,b]=u;return Re(a,h,b,e)},t)}function Jc(n,t,e){const s=e.query(n);if(s==null)return t;if(s.prototype instanceof Ot){const r={},i=s.value(n);if(i!=null)return r[s.blotName]=i,new D().insert(r,s.formats(n,e))}else if(s.prototype instanceof Rs&&!Bs(t,`
`)&&t.insert(`
`),"blotName"in s&&"formats"in s&&typeof s.formats=="function")return Re(t,s.blotName,s.formats(n,e),e);return t}function tu(n,t){return Bs(t,`
`)||t.insert(`
`),t}function eu(n,t,e){const s=e.query("code-block"),r=s&&"formats"in s&&typeof s.formats=="function"?s.formats(n,e):!0;return Re(t,"code-block",r,e)}function su(){return new D}function ru(n,t,e){const s=e.query(n);if(s==null||s.blotName!=="list"||!Bs(t,`
`))return t;let r=-1,i=n.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(r+=1),i=i.parentNode;return r<=0?t:t.reduce((o,a)=>a.insert?a.attributes&&typeof a.attributes.indent=="number"?o.push(a):o.insert(a.insert,{indent:r,...a.attributes||{}}):o,new D)}function nu(n,t,e){const s=n;let r=s.tagName==="OL"?"ordered":"bullet";const i=s.getAttribute("data-checked");return i&&(r=i==="true"?"checked":"unchecked"),Re(t,"list",r,e)}function Ui(n,t,e){if(!Bs(t,`
`)){if(ve(n,e)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return t.insert(`
`);if(t.length()>0&&n.nextSibling){let s=n.nextSibling;for(;s!=null;){if(ve(s,e))return t.insert(`
`);const r=e.query(s);if(r&&r.prototype instanceof Mt)return t.insert(`
`);s=s.firstChild}}}return t}function iu(n,t,e){var i;const s={},r=n.style||{};return r.fontStyle==="italic"&&(s.italic=!0),r.textDecoration==="underline"&&(s.underline=!0),r.textDecoration==="line-through"&&(s.strike=!0),((i=r.fontWeight)!=null&&i.startsWith("bold")||parseInt(r.fontWeight,10)>=700)&&(s.bold=!0),t=Object.entries(s).reduce((o,a)=>{let[u,h]=a;return Re(o,u,h,e)},t),parseFloat(r.textIndent||0)>0?new D().insert("	").concat(t):t}function lu(n,t,e){var r,i;const s=((r=n.parentElement)==null?void 0:r.tagName)==="TABLE"?n.parentElement:(i=n.parentElement)==null?void 0:i.parentElement;if(s!=null){const a=Array.from(s.querySelectorAll("tr")).indexOf(n)+1;return Re(t,"table",a,e)}return t}function ou(n,t,e){var r;let s=n.data;if(((r=n.parentElement)==null?void 0:r.tagName)==="O:P")return t.insert(s.trim());if(!Cl(n)){if(s.trim().length===0&&s.includes(`
`)&&!Yc(n,e))return t;s=s.replace(/[^\S\u00a0]/g," "),s=s.replace(/ {2,}/g," "),(n.previousSibling==null&&n.parentElement!=null&&ve(n.parentElement,e)||n.previousSibling instanceof Element&&ve(n.previousSibling,e))&&(s=s.replace(/^ /,"")),(n.nextSibling==null&&n.parentElement!=null&&ve(n.parentElement,e)||n.nextSibling instanceof Element&&ve(n.nextSibling,e))&&(s=s.replace(/ $/,"")),s=s.replaceAll(""," ")}return t.insert(s)}class Sl extends Yt{constructor(e,s){super(e,s);k(this,"lastRecorded",0);k(this,"ignoreChange",!1);k(this,"stack",{undo:[],redo:[]});k(this,"currentRange",null);this.quill.on(A.events.EDITOR_CHANGE,(r,i,o,a)=>{r===A.events.SELECTION_CHANGE?i&&a!==A.sources.SILENT&&(this.currentRange=i):r===A.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||a===A.sources.USER?this.record(i,o):this.transform(i)),this.currentRange=_n(this.currentRange,i))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",r=>{r.inputType==="historyUndo"?(this.undo(),r.preventDefault()):r.inputType==="historyRedo"&&(this.redo(),r.preventDefault())})}change(e,s){if(this.stack[e].length===0)return;const r=this.stack[e].pop();if(!r)return;const i=this.quill.getContents(),o=r.delta.invert(i);this.stack[s].push({delta:o,range:_n(r.range,o)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(r.delta,A.sources.USER),this.ignoreChange=!1,this.restoreSelection(r)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(e,s){if(e.ops.length===0)return;this.stack.redo=[];let r=e.invert(s),i=this.currentRange;const o=Date.now();if(this.lastRecorded+this.options.delay>o&&this.stack.undo.length>0){const a=this.stack.undo.pop();a&&(r=r.compose(a.delta),i=a.range)}else this.lastRecorded=o;r.length()!==0&&(this.stack.undo.push({delta:r,range:i}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(e){Pi(this.stack.undo,e),Pi(this.stack.redo,e)}undo(){this.change("undo","redo")}restoreSelection(e){if(e.range)this.quill.setSelection(e.range,A.sources.USER);else{const s=cu(this.quill.scroll,e.delta);this.quill.setSelection(s,A.sources.USER)}}}k(Sl,"DEFAULTS",{delay:1e3,maxStack:100,userOnly:!1});function Pi(n,t){let e=t;for(let s=n.length-1;s>=0;s-=1){const r=n[s];n[s]={delta:e.transform(r.delta,!0),range:r.range&&_n(r.range,e)},e=r.delta.transform(e),n[s].delta.length()===0&&n.splice(s,1)}}function au(n,t){const e=t.ops[t.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(s=>n.query(s,U.BLOCK)!=null):!1}function cu(n,t){const e=t.reduce((r,i)=>r+(i.delete||0),0);let s=t.length()-e;return au(n,t)&&(s-=1),s}function _n(n,t){if(!n)return n;const e=t.transformPosition(n.index),s=t.transformPosition(n.index+n.length);return{index:e,length:s-e}}class ql extends Yt{constructor(t,e){super(t,e),t.root.addEventListener("drop",s=>{var o;s.preventDefault();let r=null;if(document.caretRangeFromPoint)r=document.caretRangeFromPoint(s.clientX,s.clientY);else if(document.caretPositionFromPoint){const a=document.caretPositionFromPoint(s.clientX,s.clientY);r=document.createRange(),r.setStart(a.offsetNode,a.offset),r.setEnd(a.offsetNode,a.offset)}const i=r&&t.selection.normalizeNative(r);if(i){const a=t.selection.normalizedToRange(i);(o=s.dataTransfer)!=null&&o.files&&this.upload(a,s.dataTransfer.files)}})}upload(t,e){const s=[];Array.from(e).forEach(r=>{var i;r&&((i=this.options.mimetypes)!=null&&i.includes(r.type))&&s.push(r)}),s.length>0&&this.options.handler.call(this,t,s)}}ql.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,t){if(!this.quill.scroll.query("image"))return;const e=t.map(s=>new Promise(r=>{const i=new FileReader;i.onload=()=>{r(i.result)},i.readAsDataURL(s)}));Promise.all(e).then(s=>{const r=s.reduce((i,o)=>i.insert({image:o}),new D().retain(n.index).delete(n.length));this.quill.updateContents(r,_.sources.USER),this.quill.setSelection(n.index+s.length,_.sources.SILENT)})}};const uu=["insertText","insertReplacementText"];class hu extends Yt{constructor(t,e){super(t,e),t.root.addEventListener("beforeinput",s=>{this.handleBeforeInput(s)}),/Android/i.test(navigator.userAgent)||t.on(A.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(t){ei({range:t,quill:this.quill})}replaceText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t.length===0)return!1;if(e){const s=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents(new D().retain(t.index).insert(e,s),A.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+e.length,0,A.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!uu.includes(t.inputType))return;const e=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!e||e.collapsed===!0)return;const s=du(t);if(s==null)return;const r=this.quill.selection.normalizeNative(e),i=r?this.quill.selection.normalizedToRange(r):null;i&&this.replaceText(i,s)&&t.preventDefault()}handleCompositionStart(){const t=this.quill.getSelection();t&&this.replaceText(t)}}function du(n){var t;return typeof n.data=="string"?n.data:(t=n.dataTransfer)!=null&&t.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const fu=/Mac/i.test(navigator.platform),pu=100,gu=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||fu&&n.key==="a"&&n.ctrlKey===!0);class mu extends Yt{constructor(e,s){super(e,s);k(this,"isListening",!1);k(this,"selectionChangeDeadline",0);this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(e,s){let{line:r,event:i}=s;if(!(r instanceof Kt)||!r.uiNode)return!0;const o=getComputedStyle(r.domNode).direction==="rtl";return o&&i.key!=="ArrowRight"||!o&&i.key!=="ArrowLeft"?!0:(this.quill.setSelection(e.index-1,e.length+(i.shiftKey?1:0),A.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",e=>{!e.defaultPrevented&&gu(e)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+pu,this.isListening)return;this.isListening=!0;const e=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",e,{once:!0})}handleSelectionChange(){const e=document.getSelection();if(!e)return;const s=e.getRangeAt(0);if(s.collapsed!==!0||s.startOffset!==0)return;const r=this.quill.scroll.find(s.startContainer);if(!(r instanceof Kt)||!r.uiNode)return;const i=document.createRange();i.setStartAfter(r.uiNode),i.setEndAfter(r.uiNode),e.removeAllRanges(),e.addRange(i)}}A.register({"blots/block":Nt,"blots/block/embed":Mt,"blots/break":Xt,"blots/container":Oe,"blots/cursor":is,"blots/embed":Wn,"blots/inline":ie,"blots/scroll":Ye,"blots/text":Zt,"modules/clipboard":Ll,"modules/history":Sl,"modules/keyboard":Tr,"modules/uploader":ql,"modules/input":hu,"modules/uiNode":mu});class bu extends Wt{add(t,e){let s=0;if(e==="+1"||e==="-1"){const r=this.value(t)||0;s=e==="+1"?r+1:r-1}else typeof e=="number"&&(s=e);return s===0?(this.remove(t),!0):super.add(t,s.toString())}canAdd(t,e){return super.canAdd(t,e)||super.canAdd(t,parseInt(e,10))}value(t){return parseInt(super.value(t),10)||void 0}}const yu=new bu("indent","ql-indent",{scope:U.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class jn extends Nt{}k(jn,"blotName","blockquote"),k(jn,"tagName","blockquote");class Mn extends Nt{static formats(t){return this.tagName.indexOf(t.tagName)+1}}k(Mn,"blotName","header"),k(Mn,"tagName",["H1","H2","H3","H4","H5","H6"]);class Ds extends Oe{}Ds.blotName="list-container";Ds.tagName="OL";class Us extends Nt{static create(t){const e=super.create();return e.setAttribute("data-list",t),e}static formats(t){return t.getAttribute("data-list")||void 0}static register(){A.register(Ds)}constructor(t,e){super(t,e);const s=e.ownerDocument.createElement("span"),r=i=>{if(!t.isEnabled())return;const o=this.statics.formats(e,t);o==="checked"?(this.format("list","unchecked"),i.preventDefault()):o==="unchecked"&&(this.format("list","checked"),i.preventDefault())};s.addEventListener("mousedown",r),s.addEventListener("touchstart",r),this.attachUI(s)}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(t,e)}}Us.blotName="list";Us.tagName="LI";Ds.allowedChildren=[Us];Us.requiredContainer=Ds;class js extends ie{static create(){return super.create()}static formats(){return!0}optimize(t){super.optimize(t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}k(js,"blotName","bold"),k(js,"tagName",["STRONG","B"]);class Bn extends js{}k(Bn,"blotName","italic"),k(Bn,"tagName",["EM","I"]);class xe extends ie{static create(t){const e=super.create(t);return e.setAttribute("href",this.sanitize(t)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){return kl(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,e){t!==this.statics.blotName||!e?super.format(t,e):this.domNode.setAttribute("href",this.constructor.sanitize(e))}}k(xe,"blotName","link"),k(xe,"tagName","A"),k(xe,"SANITIZED_URL","about:blank"),k(xe,"PROTOCOL_WHITELIST",["http","https","mailto","tel","sms"]);function kl(n,t){const e=document.createElement("a");e.href=n;const s=e.href.slice(0,e.href.indexOf(":"));return t.indexOf(s)>-1}class Dn extends ie{static create(t){return t==="super"?document.createElement("sup"):t==="sub"?document.createElement("sub"):super.create(t)}static formats(t){if(t.tagName==="SUB")return"sub";if(t.tagName==="SUP")return"super"}}k(Dn,"blotName","script"),k(Dn,"tagName",["SUB","SUP"]);class Un extends js{}k(Un,"blotName","strike"),k(Un,"tagName",["S","STRIKE"]);class Pn extends ie{}k(Pn,"blotName","underline"),k(Pn,"tagName","U");class mr extends Wn{static create(t){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const e=super.create(t);return typeof t=="string"&&(window.katex.render(t,e,{throwOnError:!1,errorColor:"#f00"}),e.setAttribute("data-value",t)),e}static value(t){return t.getAttribute("data-value")}html(){const{formula:t}=this.value();return`<span>${t}</span>`}}k(mr,"blotName","formula"),k(mr,"className","ql-formula"),k(mr,"tagName","SPAN");const Fi=["alt","height","width"];class Fn extends Ot{static create(t){const e=super.create(t);return typeof t=="string"&&e.setAttribute("src",this.sanitize(t)),e}static formats(t){return Fi.reduce((e,s)=>(t.hasAttribute(s)&&(e[s]=t.getAttribute(s)),e),{})}static match(t){return/\.(jpe?g|gif|png)$/.test(t)||/^data:image\/.+;base64/.test(t)}static sanitize(t){return kl(t,["http","https","data"])?t:"//:0"}static value(t){return t.getAttribute("src")}format(t,e){Fi.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}}k(Fn,"blotName","image"),k(Fn,"tagName","IMG");const $i=["height","width"];class br extends Mt{static create(t){const e=super.create(t);return e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","true"),e.setAttribute("src",this.sanitize(t)),e}static formats(t){return $i.reduce((e,s)=>(t.hasAttribute(s)&&(e[s]=t.getAttribute(s)),e),{})}static sanitize(t){return xe.sanitize(t)}static value(t){return t.getAttribute("src")}format(t,e){$i.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}html(){const{video:t}=this.value();return`<a href="${t}">${t}</a>`}}k(br,"blotName","video"),k(br,"className","ql-video"),k(br,"tagName","IFRAME");const qs=new Wt("code-token","hljs",{scope:U.INLINE});class he extends ie{static formats(t,e){for(;t!=null&&t!==e.domNode;){if(t.classList&&t.classList.contains(Lt.className))return super.formats(t,e);t=t.parentNode}}constructor(t,e,s){super(t,e,s),qs.add(this.domNode,s)}format(t,e){t!==he.blotName?super.format(t,e):e?qs.add(this.domNode,e):(qs.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),qs.value(this.domNode)||this.unwrap()}}he.blotName="code-token";he.className="ql-token";class jt extends Lt{static create(t){const e=super.create(t);return typeof t=="string"&&e.setAttribute("data-language",t),e}static formats(t){return t.getAttribute("data-language")||"plain"}static register(){}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-language",e):super.format(t,e)}replaceWith(t,e){return this.formatAt(0,this.length(),he.blotName,!1),super.replaceWith(t,e)}}class ks extends Ie{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(t,e){t===jt.blotName&&(this.forceNext=!0,this.children.forEach(s=>{s.format(t,e)}))}formatAt(t,e,s,r){s===jt.blotName&&(this.forceNext=!0),super.formatAt(t,e,s,r)}highlight(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const r=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,i=jt.formats(this.children.head.domNode);if(e||this.forceNext||this.cachedText!==r){if(r.trim().length>0||this.cachedText==null){const o=this.children.reduce((u,h)=>u.concat(fl(h,!1)),new D),a=t(r,i);o.diff(a).reduce((u,h)=>{let{retain:b,attributes:v}=h;return b?(v&&Object.keys(v).forEach(d=>{[jt.blotName,he.blotName].includes(d)&&this.formatAt(u,b,d,v[d])}),u+b):u},0)}this.cachedText=r,this.forceNext=!1}}html(t,e){const[s]=this.children.find(t);return`<pre data-language="${s?jt.formats(s.domNode):"plain"}">
${wr(this.code(t,e))}
</pre>`}optimize(t){if(super.optimize(t),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const e=jt.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}ks.allowedChildren=[jt];jt.requiredContainer=ks;jt.allowedChildren=[he,is,Zt,Xt];const vu=(n,t,e)=>{if(typeof n.versionString=="string"){const s=n.versionString.split(".")[0];if(parseInt(s,10)>=11)return n.highlight(e,{language:t}).value}return n.highlight(t,e).value};class Ol extends Yt{static register(){A.register(he,!0),A.register(jt,!0),A.register(ks,!0)}constructor(t,e){if(super(t,e),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((s,r)=>{let{key:i}=r;return s[i]=!0,s},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(A.events.SCROLL_BLOT_MOUNT,t=>{if(!(t instanceof ks))return;const e=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(s=>{let{key:r,label:i}=s;const o=e.ownerDocument.createElement("option");o.textContent=i,o.setAttribute("value",r),e.appendChild(o)}),e.addEventListener("change",()=>{t.format(jt.blotName,e.value),this.quill.root.focus(),this.highlight(t,!0)}),t.uiNode==null&&(t.attachUI(e),t.children.head&&(e.value=jt.formats(t.children.head.domNode)))})}initTimer(){let t=null;this.quill.on(A.events.SCROLL_OPTIMIZE,()=>{t&&clearTimeout(t),t=setTimeout(()=>{this.highlight(),t=null},this.options.interval)})}highlight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(A.sources.USER);const s=this.quill.getSelection();(t==null?this.quill.scroll.descendants(ks):[t]).forEach(i=>{i.highlight(this.highlightBlot,e)}),this.quill.update(A.sources.SILENT),s!=null&&this.quill.setSelection(s,A.sources.SILENT)}highlightBlot(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(e=this.languages[e]?e:"plain",e==="plain")return wr(t).split(`
`).reduce((r,i,o)=>(o!==0&&r.insert(`
`,{[Lt.blotName]:e}),r.insert(i)),new D);const s=this.quill.root.ownerDocument.createElement("div");return s.classList.add(Lt.className),s.innerHTML=vu(this.options.hljs,e,t),si(this.quill.scroll,s,[(r,i)=>{const o=qs.value(r);return o?i.compose(new D().retain(i.length(),{[he.blotName]:o})):i}],[(r,i)=>r.data.split(`
`).reduce((o,a,u)=>(u!==0&&o.insert(`
`,{[Lt.blotName]:e}),o.insert(a)),i)],new WeakMap)}}Ol.DEFAULTS={hljs:window.hljs,interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};const Is=class Is extends Nt{static create(t){const e=super.create();return t?e.setAttribute("data-row",t):e.setAttribute("data-row",ri()),e}static formats(t){if(t.hasAttribute("data-row"))return t.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(t,e){t===Is.blotName&&e?this.domNode.setAttribute("data-row",e):super.format(t,e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}};k(Is,"blotName","table"),k(Is,"tagName","TD");let Gt=Is;class de extends Oe{checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const t=this.children.head.formats(),e=this.children.tail.formats(),s=this.next.children.head.formats(),r=this.next.children.tail.formats();return t.table===e.table&&t.table===s.table&&t.table===r.table}return!1}optimize(t){super.optimize(t),this.children.forEach(e=>{if(e.next==null)return;const s=e.formats(),r=e.next.formats();if(s.table!==r.table){const i=this.splitAfter(e);i&&i.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}k(de,"blotName","table-row"),k(de,"tagName","TR");class re extends Oe{}k(re,"blotName","table-body"),k(re,"tagName","TBODY");class os extends Oe{balanceCells(){const t=this.descendants(de),e=t.reduce((s,r)=>Math.max(r.children.length,s),0);t.forEach(s=>{new Array(e-s.children.length).fill(0).forEach(()=>{let r;s.children.head!=null&&(r=Gt.formats(s.children.head.domNode));const i=this.scroll.create(Gt.blotName,r);s.appendChild(i),i.optimize()})})}cells(t){return this.rows().map(e=>e.children.at(t))}deleteColumn(t){const[e]=this.descendant(re);e==null||e.children.head==null||e.children.forEach(s=>{const r=s.children.at(t);r!=null&&r.remove()})}insertColumn(t){const[e]=this.descendant(re);e==null||e.children.head==null||e.children.forEach(s=>{const r=s.children.at(t),i=Gt.formats(s.children.head.domNode),o=this.scroll.create(Gt.blotName,i);s.insertBefore(o,r)})}insertRow(t){const[e]=this.descendant(re);if(e==null||e.children.head==null)return;const s=ri(),r=this.scroll.create(de.blotName);e.children.head.children.forEach(()=>{const o=this.scroll.create(Gt.blotName,s);r.appendChild(o)});const i=e.children.at(t);e.insertBefore(r,i)}rows(){const t=this.children.head;return t==null?[]:t.children.map(e=>e)}}k(os,"blotName","table-container"),k(os,"tagName","TABLE");os.allowedChildren=[re];re.requiredContainer=os;re.allowedChildren=[de];de.requiredContainer=re;de.allowedChildren=[Gt];Gt.requiredContainer=de;function ri(){return`row-${Math.random().toString(36).slice(2,6)}`}class xu extends Yt{static register(){A.register(Gt),A.register(de),A.register(re),A.register(os)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(os).forEach(t=>{t.balanceCells()})}deleteColumn(){const[t,,e]=this.getTable();e!=null&&(t.deleteColumn(e.cellOffset()),this.quill.update(A.sources.USER))}deleteRow(){const[,t]=this.getTable();t!=null&&(t.remove(),this.quill.update(A.sources.USER))}deleteTable(){const[t]=this.getTable();if(t==null)return;const e=t.offset();t.remove(),this.quill.update(A.sources.USER),this.quill.setSelection(e,A.sources.SILENT)}getTable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(t==null)return[null,null,null,-1];const[e,s]=this.quill.getLine(t.index);if(e==null||e.statics.blotName!==Gt.blotName)return[null,null,null,-1];const r=e.parent;return[r.parent.parent,r,e,s]}insertColumn(t){const e=this.quill.getSelection();if(!e)return;const[s,r,i]=this.getTable(e);if(i==null)return;const o=i.cellOffset();s.insertColumn(o+t),this.quill.update(A.sources.USER);let a=r.rowOffset();t===0&&(a+=1),this.quill.setSelection(e.index+a,e.length,A.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(t){const e=this.quill.getSelection();if(!e)return;const[s,r,i]=this.getTable(e);if(i==null)return;const o=r.rowOffset();s.insertRow(o+t),this.quill.update(A.sources.USER),t>0?this.quill.setSelection(e,A.sources.SILENT):this.quill.setSelection(e.index+r.children.length,e.length,A.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(t,e){const s=this.quill.getSelection();if(s==null)return;const r=new Array(t).fill(0).reduce(i=>{const o=new Array(e).fill(`
`).join("");return i.insert(o,{table:ri()})},new D().retain(s.index));this.quill.updateContents(r,A.sources.USER),this.quill.setSelection(s.index,A.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(A.events.SCROLL_OPTIMIZE,t=>{t.some(e=>["TD","TR","TBODY","TABLE"].includes(e.target.tagName)?(this.quill.once(A.events.TEXT_CHANGE,(s,r,i)=>{i===A.sources.USER&&this.balanceTables()}),!0):!1)})}}const Hi=fe("quill:toolbar");class ni extends Yt{constructor(t,e){var s,r;if(super(t,e),Array.isArray(this.options.container)){const i=document.createElement("div");i.setAttribute("role","toolbar"),Nu(i,this.options.container),(r=(s=t.container)==null?void 0:s.parentNode)==null||r.insertBefore(i,t.container),this.container=i}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){Hi.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(i=>{var a;const o=(a=this.options.handlers)==null?void 0:a[i];o&&this.addHandler(i,o)}),Array.from(this.container.querySelectorAll("button, select")).forEach(i=>{this.attach(i)}),this.quill.on(A.events.EDITOR_CHANGE,()=>{const[i]=this.quill.selection.getRange();this.update(i)})}addHandler(t,e){this.handlers[t]=e}attach(t){let e=Array.from(t.classList).find(r=>r.indexOf("ql-")===0);if(!e)return;if(e=e.slice(3),t.tagName==="BUTTON"&&t.setAttribute("type","button"),this.handlers[e]==null&&this.quill.scroll.query(e)==null){Hi.warn("ignoring attaching to nonexistent format",e,t);return}const s=t.tagName==="SELECT"?"change":"click";t.addEventListener(s,r=>{let i;if(t.tagName==="SELECT"){if(t.selectedIndex<0)return;const a=t.options[t.selectedIndex];a.hasAttribute("selected")?i=!1:i=a.value||!1}else t.classList.contains("ql-active")?i=!1:i=t.value||!t.hasAttribute("value"),r.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[e]!=null)this.handlers[e].call(this,i);else if(this.quill.scroll.query(e).prototype instanceof Ot){if(i=prompt(`Enter ${e}`),!i)return;this.quill.updateContents(new D().retain(o.index).delete(o.length).insert({[e]:i}),A.sources.USER)}else this.quill.format(e,i,A.sources.USER);this.update(o)}),this.controls.push([e,t])}update(t){const e=t==null?{}:this.quill.getFormat(t);this.controls.forEach(s=>{const[r,i]=s;if(i.tagName==="SELECT"){let o=null;if(t==null)o=null;else if(e[r]==null)o=i.querySelector("option[selected]");else if(!Array.isArray(e[r])){let a=e[r];typeof a=="string"&&(a=a.replace(/"/g,'\\"')),o=i.querySelector(`option[value="${a}"]`)}o==null?(i.value="",i.selectedIndex=-1):o.selected=!0}else if(t==null)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){const o=e[r],a=o===i.getAttribute("value")||o!=null&&o.toString()===i.getAttribute("value")||o==null&&!i.getAttribute("value");i.classList.toggle("ql-active",a),i.setAttribute("aria-pressed",a.toString())}else{const o=e[r]!=null;i.classList.toggle("ql-active",o),i.setAttribute("aria-pressed",o.toString())}})}}ni.DEFAULTS={};function zi(n,t,e){const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add(`ql-${t}`),s.setAttribute("aria-pressed","false"),e!=null?(s.value=e,s.setAttribute("aria-label",`${t}: ${e}`)):s.setAttribute("aria-label",t),n.appendChild(s)}function Nu(n,t){Array.isArray(t[0])||(t=[t]),t.forEach(e=>{const s=document.createElement("span");s.classList.add("ql-formats"),e.forEach(r=>{if(typeof r=="string")zi(s,r);else{const i=Object.keys(r)[0],o=r[i];Array.isArray(o)?Eu(s,i,o):zi(s,i,o)}}),n.appendChild(s)})}function Eu(n,t,e){const s=document.createElement("select");s.classList.add(`ql-${t}`),e.forEach(r=>{const i=document.createElement("option");r!==!1?i.setAttribute("value",String(r)):i.setAttribute("selected","selected"),s.appendChild(i)}),n.appendChild(s)}ni.DEFAULTS={container:null,handlers:{clean(){const n=this.quill.getSelection();if(n!=null)if(n.length===0){const t=this.quill.getFormat();Object.keys(t).forEach(e=>{this.quill.scroll.query(e,U.INLINE)!=null&&this.quill.format(e,!1,A.sources.USER)})}else this.quill.removeFormat(n.index,n.length,A.sources.USER)},direction(n){const{align:t}=this.quill.getFormat();n==="rtl"&&t==null?this.quill.format("align","right",A.sources.USER):!n&&t==="right"&&this.quill.format("align",!1,A.sources.USER),this.quill.format("direction",n,A.sources.USER)},indent(n){const t=this.quill.getSelection(),e=this.quill.getFormat(t),s=parseInt(e.indent||0,10);if(n==="+1"||n==="-1"){let r=n==="+1"?1:-1;e.direction==="rtl"&&(r*=-1),this.quill.format("indent",s+r,A.sources.USER)}},link(n){n===!0&&(n=prompt("Enter link URL:")),this.quill.format("link",n,A.sources.USER)},list(n){const t=this.quill.getSelection(),e=this.quill.getFormat(t);n==="check"?e.list==="checked"||e.list==="unchecked"?this.quill.format("list",!1,A.sources.USER):this.quill.format("list","unchecked",A.sources.USER):this.quill.format("list",n,A.sources.USER)}}};const Au='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',wu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',Tu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',Lu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',Cu='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',Su='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',qu='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',ku='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',Vi='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',Ou='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',Iu='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',Ru='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',_u='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',ju='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',Mu='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Bu='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Du='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',Uu='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Pu='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',Fu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',$u='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',Hu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',zu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',Vu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',Gu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',Ku='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',Zu='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',Wu='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',Xu='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',Yu='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',Qu='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',Ju='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',th='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>',Ms={align:{"":Au,center:wu,right:Tu,justify:Lu},background:Cu,blockquote:Su,bold:qu,clean:ku,code:Vi,"code-block":Vi,color:Ou,direction:{"":Iu,rtl:Ru},formula:_u,header:{1:ju,2:Mu,3:Bu,4:Du,5:Uu,6:Pu},italic:Fu,image:$u,indent:{"+1":Hu,"-1":zu},link:Vu,list:{bullet:Gu,check:Ku,ordered:Zu},script:{sub:Wu,super:Xu},strike:Yu,table:Qu,underline:Ju,video:th},eh='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let Gi=0;function Ki(n,t){n.setAttribute(t,`${n.getAttribute(t)!=="true"}`)}class Lr{constructor(t){this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),Ki(this.label,"aria-expanded"),Ki(this.options,"aria-hidden")}buildItem(t){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const s=t.getAttribute("value");return s&&e.setAttribute("data-value",s),t.textContent&&e.setAttribute("data-label",t.textContent),e.addEventListener("click",()=>{this.selectItem(e,!0)}),e.addEventListener("keydown",r=>{switch(r.key){case"Enter":this.selectItem(e,!0),r.preventDefault();break;case"Escape":this.escape(),r.preventDefault();break}}),e}buildLabel(){const t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML=eh,t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}buildOptions(){const t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id=`ql-picker-options-${Gi}`,Gi+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,Array.from(this.select.options).forEach(e=>{const s=this.buildItem(e);t.appendChild(s),e.selected===!0&&this.selectItem(s)}),this.container.appendChild(t)}buildPicker(){Array.from(this.select.attributes).forEach(t=>{this.container.setAttribute(t.name,t.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.container.querySelector(".ql-selected");t!==s&&(s!=null&&s.classList.remove("ql-selected"),t!=null&&(t.classList.add("ql-selected"),this.select.selectedIndex=Array.from(t.parentNode.children).indexOf(t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let t;if(this.select.selectedIndex>-1){const s=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(s)}else this.selectItem(null);const e=t!=null&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}}class Il extends Lr{constructor(t,e){super(t),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(s=>{s.classList.add("ql-primary")})}buildItem(t){const e=super.buildItem(t);return e.style.backgroundColor=t.getAttribute("value")||"",e}selectItem(t,e){super.selectItem(t,e);const s=this.label.querySelector(".ql-color-label"),r=t&&t.getAttribute("data-value")||"";s&&(s.tagName==="line"?s.style.stroke=r:s.style.fill=r)}}class Rl extends Lr{constructor(t,e){super(t),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(s=>{s.innerHTML=e[s.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(t,e){super.selectItem(t,e);const s=t||this.defaultItem;if(s!=null){if(this.label.innerHTML===s.innerHTML)return;this.label.innerHTML=s.innerHTML}}}const sh=n=>{const{overflowY:t}=getComputedStyle(n,null);return t!=="visible"&&t!=="clip"};class _l{constructor(t,e){this.quill=t,this.boundsContainer=e||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,sh(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(t){const e=t.left+t.width/2-this.root.offsetWidth/2,s=t.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${s}px`,this.root.classList.remove("ql-flip");const r=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect();let o=0;if(i.right>r.right&&(o=r.right-i.right,this.root.style.left=`${e+o}px`),i.left<r.left&&(o=r.left-i.left,this.root.style.left=`${e+o}px`),i.bottom>r.bottom){const a=i.bottom-i.top,u=t.bottom-t.top+a;this.root.style.top=`${s-u}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const rh=[!1,"center","right","justify"],nh=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],ih=[!1,"serif","monospace"],lh=["1","2","3",!1],oh=["small",!1,"large","huge"];class Ps extends ls{constructor(t,e){super(t,e);const s=r=>{if(!document.body.contains(t.root)){document.body.removeEventListener("click",s);return}this.tooltip!=null&&!this.tooltip.root.contains(r.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(i=>{i.container.contains(r.target)||i.close()})};t.emitter.listenDOM("click",document.body,s)}addModule(t){const e=super.addModule(t);return t==="toolbar"&&this.extendToolbar(e),e}buildButtons(t,e){Array.from(t).forEach(s=>{(s.getAttribute("class")||"").split(/\s+/).forEach(i=>{if(i.startsWith("ql-")&&(i=i.slice(3),e[i]!=null))if(i==="direction")s.innerHTML=e[i][""]+e[i].rtl;else if(typeof e[i]=="string")s.innerHTML=e[i];else{const o=s.value||"";o!=null&&e[i][o]&&(s.innerHTML=e[i][o])}})})}buildPickers(t,e){this.pickers=Array.from(t).map(r=>{if(r.classList.contains("ql-align")&&(r.querySelector("option")==null&&Ls(r,rh),typeof e.align=="object"))return new Rl(r,e.align);if(r.classList.contains("ql-background")||r.classList.contains("ql-color")){const i=r.classList.contains("ql-background")?"background":"color";return r.querySelector("option")==null&&Ls(r,nh,i==="background"?"#ffffff":"#000000"),new Il(r,e[i])}return r.querySelector("option")==null&&(r.classList.contains("ql-font")?Ls(r,ih):r.classList.contains("ql-header")?Ls(r,lh):r.classList.contains("ql-size")&&Ls(r,oh)),new Lr(r)});const s=()=>{this.pickers.forEach(r=>{r.update()})};this.quill.on(_.events.EDITOR_CHANGE,s)}}Ps.DEFAULTS=Ne({},ls.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let n=this.container.querySelector("input.ql-image[type=file]");n==null&&(n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),n.classList.add("ql-image"),n.addEventListener("change",()=>{const t=this.quill.getSelection(!0);this.quill.uploader.upload(t,n.files),n.value=""}),this.container.appendChild(n)),n.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class jl extends _l{constructor(t,e){super(t,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",t=>{t.key==="Enter"?(this.save(),t.preventDefault()):t.key==="Escape"&&(this.cancel(),t.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;e!=null?this.textbox.value=e:t!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const s=this.quill.getBounds(this.quill.selection.savedRange);s!=null&&this.position(s),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${t}`)||""),this.root.setAttribute("data-mode",t)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:t}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",t,_.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",t,_.sources.USER)),this.quill.root.scrollTop=e;break}case"video":t=ah(t);case"formula":{if(!t)break;const e=this.quill.getSelection(!0);if(e!=null){const s=e.index+e.length;this.quill.insertEmbed(s,this.root.getAttribute("data-mode"),t,_.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(s+1," ",_.sources.USER),this.quill.setSelection(s+2,_.sources.USER)}break}}this.textbox.value="",this.hide()}}function ah(n){let t=n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return t?`${t[1]||"https"}://www.youtube.com/embed/${t[2]}?showinfo=0`:(t=n.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${t[1]||"https"}://player.vimeo.com/video/${t[2]}/`:n}function Ls(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t.forEach(s=>{const r=document.createElement("option");s===e?r.setAttribute("selected","selected"):r.setAttribute("value",String(s)),n.appendChild(r)})}const ch=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class Ml extends jl{constructor(t,e){super(t,e),this.quill.on(_.events.EDITOR_CHANGE,(s,r,i,o)=>{if(s===_.events.SELECTION_CHANGE)if(r!=null&&r.length>0&&o===_.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const a=this.quill.getLines(r.index,r.length);if(a.length===1){const u=this.quill.getBounds(r);u!=null&&this.position(u)}else{const u=a[a.length-1],h=this.quill.getIndex(u),b=Math.min(u.length()-1,r.index+r.length-h),v=this.quill.getBounds(new ke(h,b));v!=null&&this.position(v)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(_.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const t=this.quill.getSelection();if(t!=null){const e=this.quill.getBounds(t);e!=null&&this.position(e)}},1)})}cancel(){this.show()}position(t){const e=super.position(t),s=this.root.querySelector(".ql-tooltip-arrow");return s.style.marginLeft="",e!==0&&(s.style.marginLeft=`${-1*e-s.offsetWidth/2}px`),e}}k(Ml,"TEMPLATE",['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""));class Bl extends Ps{constructor(t,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=ch),super(t,e),this.quill.container.classList.add("ql-bubble")}extendToolbar(t){this.tooltip=new Ml(this.quill,this.options.bounds),t.container!=null&&(this.tooltip.root.appendChild(t.container),this.buildButtons(t.container.querySelectorAll("button"),Ms),this.buildPickers(t.container.querySelectorAll("select"),Ms))}}Bl.DEFAULTS=Ne({},Ps.DEFAULTS,{modules:{toolbar:{handlers:{link(n){n?this.quill.theme.tooltip.edit():this.quill.format("link",!1,A.sources.USER)}}}}});const uh=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class Dl extends jl{constructor(){super(...arguments);k(this,"preview",this.root.querySelector("a.ql-preview"))}listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",e=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),e.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",e=>{if(this.linkRange!=null){const s=this.linkRange;this.restoreFocus(),this.quill.formatText(s,"link",!1,_.sources.USER),delete this.linkRange}e.preventDefault(),this.hide()}),this.quill.on(_.events.SELECTION_CHANGE,(e,s,r)=>{if(e!=null){if(e.length===0&&r===_.sources.USER){const[i,o]=this.quill.scroll.descendant(xe,e.index);if(i!=null){this.linkRange=new ke(e.index-o,i.length());const a=xe.formats(i.domNode);this.preview.textContent=a,this.preview.setAttribute("href",a),this.show();const u=this.quill.getBounds(this.linkRange);u!=null&&this.position(u);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}k(Dl,"TEMPLATE",['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""));class Ul extends Ps{constructor(t,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=uh),super(t,e),this.quill.container.classList.add("ql-snow")}extendToolbar(t){t.container!=null&&(t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),Ms),this.buildPickers(t.container.querySelectorAll("select"),Ms),this.tooltip=new Dl(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(e,s)=>{t.handlers.link.call(t,!s.format.link)}))}}Ul.DEFAULTS=Ne({},Ps.DEFAULTS,{modules:{toolbar:{handlers:{link(n){if(n){const t=this.quill.getSelection();if(t==null||t.length===0)return;let e=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(e)&&e.indexOf("mailto:")!==0&&(e=`mailto:${e}`);const{tooltip:s}=this.quill.theme;s.edit("link",e)}else this.quill.format("link",!1,A.sources.USER)}}}}});A.register({"attributors/attribute/direction":yl,"attributors/class/align":gl,"attributors/class/background":Sc,"attributors/class/color":Cc,"attributors/class/direction":vl,"attributors/class/font":El,"attributors/class/size":wl,"attributors/style/align":ml,"attributors/style/background":Qn,"attributors/style/color":Yn,"attributors/style/direction":xl,"attributors/style/font":Al,"attributors/style/size":Tl},!0);A.register({"formats/align":gl,"formats/direction":vl,"formats/indent":yu,"formats/background":Qn,"formats/color":Yn,"formats/font":El,"formats/size":wl,"formats/blockquote":jn,"formats/code-block":Lt,"formats/header":Mn,"formats/list":Us,"formats/bold":js,"formats/code":Jn,"formats/italic":Bn,"formats/link":xe,"formats/script":Dn,"formats/strike":Un,"formats/underline":Pn,"formats/formula":mr,"formats/image":Fn,"formats/video":br,"modules/syntax":Ol,"modules/table":xu,"modules/toolbar":ni,"themes/bubble":Bl,"themes/snow":Ul,"ui/icons":Ms,"ui/picker":Lr,"ui/icon-picker":Rl,"ui/color-picker":Il,"ui/tooltip":_l},!0);const hh=({modules:n,formats:t,placeholder:e})=>{const s=H.useRef(null),[r,i]=H.useState(null);return H.useEffect(()=>{if(s.current){const o=new A(s.current,{modules:n,formats:t,placeholder:e});i(o)}},[]),{quillRef:s,quill:r,Quill:A}};var dh=n=>n.replace(/[\u00A0]/g," ");function fh({timeout:n=2e3}={}){const[t,e]=H.useState(null),[s,r]=H.useState(!1),[i,o]=H.useState(null),a=H.useCallback(()=>{i&&clearTimeout(i)},[i]),u=H.useCallback(v=>{a(),o(setTimeout(()=>r(!1),n)),r(v)},[a,n]),h=H.useCallback(v=>{if("clipboard"in navigator){const d=typeof v=="string"?dh(v):v;navigator.clipboard.writeText(d).then(()=>u(!0)).catch(f=>e(f))}else e(new Error("useClipboard: navigator.clipboard is not supported"))},[u]),b=H.useCallback(()=>{r(!1),e(null),a()},[a]);return{copy:h,reset:b,error:t,copied:s}}function ph(n){var t,e,s,r;const i=Xi(),[o,a]=Xl(n,gn.variantKeys),{ref:u,as:h,children:b,symbol:v="$",classNames:d,timeout:f,copyIcon:y,checkIcon:N,codeString:w,disableCopy:L=!1,disableTooltip:I=!1,hideCopyButton:B=!1,autoFocus:X=!1,hideSymbol:j=!1,onCopy:V,tooltipProps:tt={},copyButtonProps:J={},className:dt,...ft}=o,g=h||"div",C=typeof g=="string",x=(e=(t=n==null?void 0:n.disableAnimation)!=null?t:i==null?void 0:i.disableAnimation)!=null?e:!1,O={offset:15,delay:1e3,content:"Copy to clipboard",color:(r=n==null?void 0:n.color)!=null?r:(s=gn.defaultVariants)==null?void 0:s.color,isDisabled:o.disableCopy,...tt},S=Hl(u),T=H.useRef(null),{copy:q,copied:M}=fh({timeout:f}),P=b&&Array.isArray(b),{isFocusVisible:R,isFocused:G,focusProps:z}=Yl({autoFocus:X}),K=H.useMemo(()=>gn({...a,disableAnimation:x}),[Yi(a),x]),Y=H.useMemo(()=>{if(!v||typeof v!="string")return v;const Q=v.trim();return Q?`${Q} `:""},[v]),F=li(d==null?void 0:d.base,dt),ct=H.useCallback(()=>({className:K.base({class:F}),...Ql(ft,{enabled:C})}),[K,F,P,ft]),ut=H.useCallback(()=>{var Q;if(L)return;let et="";typeof b=="string"?et=b:Array.isArray(b)&&b.forEach(st=>{var pt,mt;const pe=typeof st=="string"?st:(mt=(pt=st==null?void 0:st.props)==null?void 0:pt.children)==null?void 0:mt.toString();pe&&(et+=pe+`
`)});const it=w||et||((Q=T.current)==null?void 0:Q.textContent)||"";q(it),V==null||V(it)},[q,w,L,V,b]),Z={"aria-label":typeof O.content=="string"?O.content:"Copy to clipboard",size:"sm",variant:"light",isDisabled:L,onPress:ut,isIconOnly:!0,...J},nt=H.useCallback(()=>({...Z,"data-copied":Jl(M),className:K.copyButton({class:li(d==null?void 0:d.copyButton)})}),[K,R,G,L,d==null?void 0:d.copyButton,Z,z]);return{Component:g,as:h,domRef:S,preRef:T,children:b,slots:K,classNames:d,copied:M,onCopy:ut,copyIcon:y,checkIcon:N,symbolBefore:Y,isMultiLine:P,isFocusVisible:R,hideCopyButton:B,disableCopy:L,disableTooltip:I,hideSymbol:j,tooltipProps:O,getSnippetProps:ct,getCopyButtonProps:nt}}var Pl=to((n,t)=>{const{Component:e,domRef:s,preRef:r,children:i,slots:o,classNames:a,copied:u,copyIcon:h=m.jsx(_o,{}),checkIcon:b=m.jsx(jo,{}),symbolBefore:v,disableCopy:d,disableTooltip:f,hideSymbol:y,hideCopyButton:N,tooltipProps:w,isMultiLine:L,onCopy:I,getSnippetProps:B,getCopyButtonProps:X}=ph({...n,ref:t}),j=H.useCallback(({children:J})=>m.jsx(yt,{...w,isDisabled:u||w.isDisabled,children:J}),[Yi(w)]),V=H.useMemo(()=>{if(N)return null;const J=b&&H.cloneElement(b,{className:o.checkIcon()}),dt=h&&H.cloneElement(h,{className:o.copyIcon()}),ft=m.jsxs(ot,{...X(),children:[J,dt]});return f?ft:m.jsx(j,{children:ft})},[o,a==null?void 0:a.copyButton,u,b,h,I,j,d,f,N]),tt=H.useMemo(()=>L&&i&&Array.isArray(i)?m.jsx("div",{className:o.content({class:a==null?void 0:a.content}),children:i.map((J,dt)=>m.jsxs("pre",{className:o.pre({class:a==null?void 0:a.pre}),children:[!y&&m.jsx("span",{className:o.symbol({class:a==null?void 0:a.symbol}),children:v}),J]},`${dt}-${J}`))}):m.jsxs("pre",{ref:r,className:o.pre({class:a==null?void 0:a.pre}),children:[!y&&m.jsx("span",{className:o.symbol({class:a==null?void 0:a.symbol}),children:v}),i]}),[i,y,L,v,a==null?void 0:a.pre,o]);return m.jsxs(e,{ref:s,...B(),children:[tt,V]})});Pl.displayName="HeroUI.Snippet";var gh=Pl;const mh=({messages:n})=>m.jsx(gh,{hideSymbol:!0,tooltipProps:{content:""},classNames:{copyButton:"self-start sticky top-0 right-0"},className:"bg-content1 h-96 overflow-y-scroll items-start",children:JSON.stringify(n,null,2).split(`
`).map((t,e)=>m.jsx("span",{className:"whitespace-pre-wrap break-all",children:t},e))}),_e=()=>{const n=po();return e=>{n.alert({title:"",size:"3xl",content:H.createElement(mh,{messages:e})})}};var kt=(n=>(n.GroupUpload="group_upload",n.GroupAdmin="group_admin",n.GroupDecrease="group_decrease",n.GroupIncrease="group_increase",n.GroupBan="group_ban",n.FriendAdd="friend_add",n.GroupRecall="group_recall",n.FriendRecall="friend_recall",n.Notify="notify",n.GroupMsgEmojiLike="group_msg_emoji_like",n.GroupMsgEmojiLikeLagrange="reaction",n.GroupEssence="essence",n.GroupCard="group_card",n))(kt||{});const ld=n=>{switch(n){case"message":return"";case"notice":return"";case"request":return"";case"meta_event":return"";case"message_sent":return"";default:return""}},od=n=>{switch(n){case"enable":return"";case"disable":return"";case"connect":return"";default:return""}},ad=n=>{switch(n){case"enable":return"success";case"disable":return"danger";case"connect":return"success";default:return"default"}},cd=n=>"post_type"in n,ud=n=>"status"in n&&"retcode"in n,hd=n=>{switch(n){case"ok":return"";case"failed":return"";case"async":return"";default:return""}},dd=n=>{switch(n){case"ok":return"success";case"failed":return"danger";case"async":return"warning";default:return"default"}},fd=n=>{switch(n){case kt.GroupUpload:return"";case kt.GroupAdmin:return"";case kt.GroupDecrease:return"";case kt.GroupIncrease:return"";case kt.GroupBan:return"";case kt.FriendAdd:return"";case kt.GroupRecall:return"";case kt.FriendRecall:return"";case kt.Notify:return"";case kt.GroupMsgEmojiLike:return"";case kt.GroupEssence:return"";case kt.GroupCard:return"";default:return""}},pd=n=>n.message_type==="group",bh=n=>{var e,s,r;let t={type:"text",data:{text:n.insert}};return typeof n.insert!="string"&&((e=n.insert)!=null&&e.image?t={type:"image",data:{file:n.insert.image.src}}:(s=n.insert)!=null&&s.emoji?t={type:"face",data:{id:n.insert.emoji.id}}:(r=n.insert)!=null&&r.reply&&(t={type:"reply",data:{id:n.insert.reply.messageId}})),t},as=n=>/^(http|https|file):\/\/.*/.test(n),yh=()=>{const[n,t]=H.useState(""),e=H.useRef(null),s=_e(),r=j=>{s([{type:"record",data:{file:j}}])},[i,o]=H.useState(!1),a=H.useRef(null),u=H.useRef([]),[h,b]=H.useState(null),[v,d]=H.useState(!1),f=H.useRef(null),[y,N]=H.useState(0),w=H.useRef(null);H.useEffect(()=>{var j;i?(navigator.mediaDevices.getUserMedia({audio:!0}).then(V=>{f.current=V;const tt=new MediaRecorder(V);a.current=tt,tt.start(),tt.ondataavailable=J=>{J.data.size>0&&u.current.push(J.data)},tt.onstop=()=>{if(u.current.length>0){const J=new Blob(u.current,{type:"audio/wav"}),dt=new FileReader;dt.readAsDataURL(J),dt.onloadend=()=>{const ft=dt.result;b(ft),d(!0)},u.current=[]}V.getTracks().forEach(J=>J.stop())}}),w.current=setInterval(()=>{N(V=>V+1)},1e3)):((j=a.current)==null||j.stop(),w.current&&(clearInterval(w.current),w.current=null))},[i]);const L=()=>{b(null),d(!1),N(0),o(!0)},I=()=>{o(!1)},B=()=>{h&&r(h)},X=j=>{const V=Math.floor(j/60),tt=j%60;return`${V}:${tt.toString().padStart(2,"0")}`};return m.jsxs(m.Fragment,{children:[m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(ai,{className:"text-xl"})})})})}),m.jsxs(Pt,{className:"flex-row gap-2 p-4",children:[m.jsx(yt,{content:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",onPress:()=>{var j;(j=e==null?void 0:e.current)==null||j.click()},children:m.jsx(xr,{})})}),m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{tooltip:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",children:m.jsx(Nr,{})})})})}),m.jsxs(Pt,{className:"flex-row gap-1 p-2",children:[m.jsx(Vt,{value:n,onChange:j=>t(j.target.value),placeholder:""}),m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>{if(!as(n)){cs.error("");return}r(n),t("")},children:m.jsx(go,{})})]})]}),m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",children:m.jsx(ai,{})})})})}),m.jsxs(Pt,{className:"flex-col gap-2 p-4",children:[m.jsxs("div",{className:"flex gap-2",children:[m.jsx(ot,{color:"primary",variant:"flat",onPress:i?I:L,children:i?"":""}),v&&h&&m.jsx(ot,{color:"primary",variant:"flat",onPress:B,children:""})]}),(i||h)&&m.jsxs("div",{className:"flex gap-1 items-center",children:[m.jsx("span",{className:eo("w-4 h-4 rounded-full",i?"animate-pulse bg-primary-400":"bg-success-400")}),m.jsxs("span",{children:[": ",X(y)]})]}),v&&h&&m.jsx("audio",{controls:!0,src:h})]})]})]})]}),m.jsx("input",{type:"file",ref:e,hidden:!0,accept:"audio/*",className:"hidden",onChange:j=>{var J;const V=(J=j.target.files)==null?void 0:J[0];if(!V)return;const tt=new FileReader;tt.readAsDataURL(V),tt.onload=dt=>{var g;const ft=(g=dt.target)==null?void 0:g.result;r(ft),j.target.value=""}}})]})},vh=()=>{const n=_e();return m.jsx(yt,{content:"",children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>{n([{type:"dice"}])},children:m.jsx(Ao,{className:"text-lg"})})})},Zi=ci.data.map(n=>({alt:n.QDes,src:ci.getUrl(n.QSid),id:n.QSid})),xh=({onInsertEmoji:n,onOpenChange:t})=>{const[e,s]=H.useState([]),[r,i]=H.useState(!1),o=H.useRef(null);H.useEffect(()=>{r&&(s([]),requestAnimationFrame(()=>a()))},[r]);const a=(u=0,h=10)=>{u<Zi.length&&(s(b=>[...b,...Zi.slice(u,u+h)]),requestAnimationFrame(()=>a(u+h,h)))};return m.jsx("div",{ref:o,children:m.jsxs(Dt,{portalContainer:o.current,shouldCloseOnScroll:!1,placement:"right-start",onOpenChange:u=>{t(u),i(u)},children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(vo,{className:"text-xl"})})})})}),m.jsx(Pt,{className:"grid grid-cols-8 gap-1 flex-wrap justify-start items-start overflow-y-auto max-w-full max-h-96 p-2",children:e.map(u=>m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>n(u),children:m.jsx(To,{src:u.src,alt:u.alt,className:"w-6 h-6"})},u.id))})]})})},Nh=()=>{const[n,t]=H.useState(""),e=H.useRef(null),s=_e(),r=i=>{s([{type:"file",data:{file:i}}])};return m.jsxs(m.Fragment,{children:[m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(mo,{className:"text-lg"})})})})}),m.jsxs(Pt,{className:"flex-row gap-2 p-4",children:[m.jsx(yt,{content:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",onPress:()=>{var i;(i=e==null?void 0:e.current)==null||i.click()},children:m.jsx(xr,{})})}),m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{tooltip:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",children:m.jsx(Nr,{})})})})}),m.jsxs(Pt,{className:"flex-row gap-1 p-2",children:[m.jsx(Vt,{value:n,onChange:i=>t(i.target.value),placeholder:""}),m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>{if(!as(n)){cs.error("");return}r(n),t("")},children:m.jsx(Lo,{})})]})]})]})]}),m.jsx("input",{type:"file",ref:e,hidden:!0,className:"hidden",onChange:i=>{var u;const o=(u=i.target.files)==null?void 0:u[0];if(!o)return;const a=new FileReader;a.readAsDataURL(o),a.onload=h=>{var v;const b=(v=h.target)==null?void 0:v.result;r(b),i.target.value=""}}})]})},Eh=({insertImage:n,onOpenChange:t})=>{const[e,s]=H.useState(""),r=H.useRef(null);return m.jsxs(m.Fragment,{children:[m.jsxs(Dt,{onOpenChange:t,children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(xo,{className:"text-xl"})})})})}),m.jsxs(Pt,{className:"flex-row gap-2 p-4",children:[m.jsx(yt,{content:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",onPress:()=>{var i;(i=r==null?void 0:r.current)==null||i.click()},children:m.jsx(xr,{})})}),m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{tooltip:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",children:m.jsx(Nr,{})})})})}),m.jsxs(Pt,{className:"flex-row gap-1 p-2",children:[m.jsx(Vt,{value:e,onChange:i=>s(i.target.value),placeholder:""}),m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>{if(!as(e)){cs.error("");return}n(e),s("")},children:m.jsx(No,{})})]})]})]})]}),m.jsx("input",{type:"file",ref:r,hidden:!0,accept:"image/*",className:"hidden",onChange:i=>{var u;const o=(u=i.target.files)==null?void 0:u[0];if(!o)return;const a=new FileReader;a.readAsDataURL(o),a.onload=h=>{var v;const b=(v=h.target)==null?void 0:v.result;n(b),i.target.value=""}}})]})},Ah=()=>{const[n,t]=H.useState(""),[e,s]=H.useState(new Set(["163"])),[r,i]=H.useState("default"),o=H.useRef(null),{control:a,handleSubmit:u,reset:h}=Oo({defaultValues:{url:"",audio:"",title:"",image:"",content:""}}),b=_e(),v=f=>{const y=[];f.type==="custom"?y.push({type:"music",data:{...f,type:"custom"}}):y.push({type:"music",data:f}),b(y)},d=f=>{v({type:"custom",...f}),h()};return m.jsx("div",{ref:o,className:"overflow-visible",children:m.jsxs(Dt,{placement:"right-start",shouldCloseOnScroll:!1,portalContainer:o.current,children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(bo,{className:"text-xl"})})})})}),m.jsx(Pt,{className:"gap-2 p-4",children:m.jsxs(So,{placement:"top",className:"w-96",fullWidth:!0,selectedKey:r,onSelectionChange:f=>{f!==null&&i(f)},children:[m.jsxs(ui,{title:"",className:"flex flex-col gap-2",children:[m.jsx(qo,{onClick:f=>f.stopPropagation(),"aria-label":"",selectedKeys:e,label:"",placeholder:"",items:[{name:"QQ",id:"qq"},{name:"",id:"163"},{name:"",id:"xm"}],onSelectionChange:s,children:f=>m.jsx(ko,{value:f.id,children:f.name},f.id)}),m.jsx(Vt,{value:n,onChange:f=>t(f.target.value),placeholder:"ID",label:"ID"}),m.jsxs(ot,{fullWidth:!0,size:"lg",color:"primary",variant:"flat",radius:"full",onPress:()=>{if(!n){cs.error("ID");return}v({type:Array.from(e)[0],id:n}),t("")},startContent:m.jsx(hi,{}),children:["",Array.from(e)[0]==="163"?"":"QQ",""]})]},"default"),m.jsx(ui,{title:"",className:"flex flex-col gap-2",children:m.jsxs(Mo,{onSubmit:u(d),className:"flex flex-col gap-2",validationBehavior:"native",children:[m.jsx(Ts,{name:"url",control:a,render:({field:f})=>m.jsx(Vt,{...f,isRequired:!0,validate:y=>as(y)?null:"URL",size:"sm",placeholder:"URL",label:"URL"})}),m.jsx(Ts,{name:"audio",control:a,render:({field:f})=>m.jsx(Vt,{...f,isRequired:!0,validate:y=>as(y)?null:"URL",size:"sm",placeholder:"URL",label:"URL"})}),m.jsx(Ts,{name:"title",control:a,render:({field:f})=>m.jsx(Vt,{...f,isRequired:!0,size:"sm",errorMessage:"",placeholder:"",label:""})}),m.jsx(Ts,{name:"image",control:a,render:({field:f})=>m.jsx(Vt,{...f,size:"sm",placeholder:"URL",label:"URL"})}),m.jsx(Ts,{name:"content",control:a,render:({field:f})=>m.jsx(Vt,{...f,size:"sm",placeholder:"",label:""})}),m.jsx(ot,{fullWidth:!0,size:"lg",color:"primary",variant:"flat",radius:"full",type:"submit",startContent:m.jsx(hi,{}),children:""})]})},"custom")]})})]})})},wh=({insertReply:n})=>{const[t,e]=H.useState("");return m.jsx(m.Fragment,{children:m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(wo,{className:"text-lg"})})})})}),m.jsxs(Pt,{className:"flex-row gap-2 p-4",children:[m.jsx(Vt,{placeholder:" ID",value:t,onChange:s=>{const r=s.target.value;/^(?:0|(?:-?[1-9]\d*))$/.test(r)&&e(r)}}),m.jsx(ot,{color:"primary",variant:"flat",radius:"full",isIconOnly:!0,onPress:()=>{n(t),e("")},children:m.jsx(Eo,{})})]})]})})};function Th(n){return Ro({attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 11.40625 6.96875 C 10.578125 6.953125 9.890625 7.125 9.46875 7.25 C 9.457031 7.25 9.449219 7.25 9.4375 7.25 L 6.9375 8.03125 C 4.003906 8.933594 2 11.652344 2 14.71875 L 2 20 C 2 23.855469 5.144531 27 9 27 L 18.90625 27 C 20.125 27.027344 21.304688 26.3125 21.78125 25.125 C 22.082031 24.371094 22.039063 23.578125 21.75 22.875 C 22.363281 22.550781 22.882813 22.027344 23.15625 21.34375 C 23.46875 20.558594 23.417969 19.722656 23.09375 19 L 27 19 C 28.644531 19 30 17.644531 30 16 C 30 14.355469 28.644531 13 27 13 L 25.46875 13 L 25.875 12.875 C 27.449219 12.398438 28.351563 10.699219 27.875 9.125 C 27.398438 7.550781 25.699219 6.648438 24.125 7.125 L 15.6875 9.71875 C 15.613281 9.53125 15.527344 9.328125 15.40625 9.125 C 14.90625 8.289063 13.894531 7.34375 12.28125 7.0625 C 11.980469 7.011719 11.683594 6.972656 11.40625 6.96875 Z M 25.125 9 C 25.515625 9.042969 25.847656 9.3125 25.96875 9.71875 C 26.132813 10.257813 25.820313 10.804688 25.28125 10.96875 L 18.4375 13.03125 L 18.78125 14.15625 L 18.78125 15 L 27 15 C 27.566406 15 28 15.433594 28 16 C 28 16.566406 27.566406 17 27 17 L 20.40625 17 L 17.78125 15.96875 C 17.402344 15.816406 17.011719 15.742188 16.625 15.75 L 16.09375 11.65625 L 24.71875 9.03125 C 24.855469 8.988281 24.996094 8.984375 25.125 9 Z M 11.375 9.03125 C 11.566406 9.03125 11.765625 9.03125 11.9375 9.0625 C 13.011719 9.25 13.425781 9.71875 13.6875 10.15625 C 13.949219 10.59375 13.96875 10.90625 13.96875 10.90625 C 13.96875 10.925781 13.96875 10.949219 13.96875 10.96875 L 14.8125 17.40625 C 14.820313 17.4375 14.832031 17.46875 14.84375 17.5 C 14.96875 18.027344 14.652344 18.53125 14.125 18.65625 C 13.800781 18.734375 13.636719 18.691406 13.46875 18.59375 C 13.300781 18.496094 13.09375 18.289063 12.9375 17.84375 L 11.6875 13 C 11.609375 12.703125 11.398438 12.460938 11.121094 12.339844 C 10.839844 12.21875 10.519531 12.230469 10.25 12.375 L 8.59375 13.28125 C 8.109375 13.546875 7.933594 14.15625 8.203125 14.640625 C 8.46875 15.125 9.078125 15.300781 9.5625 15.03125 L 10.0625 14.75 L 11.03125 18.4375 C 11.039063 18.46875 11.050781 18.5 11.0625 18.53125 C 11.332031 19.304688 11.792969 19.925781 12.4375 20.3125 C 12.964844 20.628906 13.578125 20.75 14.1875 20.6875 C 13.871094 20.980469 13.609375 21.355469 13.4375 21.78125 C 12.980469 22.925781 13.269531 24.183594 14.09375 25 L 9 25 C 6.226563 25 4 22.773438 4 20 L 4 14.71875 C 4 12.519531 5.429688 10.585938 7.53125 9.9375 L 10.03125 9.1875 C 10.234375 9.125 10.804688 9.03125 11.375 9.03125 Z M 16.8125 17.78125 C 16.886719 17.792969 16.957031 17.78125 17.03125 17.8125 L 20.75 19.3125 C 21.273438 19.523438 21.523438 20.070313 21.3125 20.59375 C 21.101563 21.117188 20.523438 21.367188 20 21.15625 L 16.28125 19.6875 C 16.226563 19.667969 16.203125 19.621094 16.15625 19.59375 C 16.550781 19.085938 16.804688 18.445313 16.8125 17.78125 Z M 16.1875 21.90625 C 16.320313 21.90625 16.460938 21.917969 16.59375 21.96875 L 17.9375 22.5 L 19.25 23.03125 L 19.375 23.0625 C 19.898438 23.273438 20.148438 23.851563 19.9375 24.375 C 19.785156 24.757813 19.445313 24.980469 19.0625 25 C 19.050781 25 19.042969 25 19.03125 25 C 18.898438 25.003906 18.757813 24.988281 18.625 24.9375 L 15.84375 23.8125 C 15.320313 23.601563 15.070313 23.023438 15.28125 22.5 C 15.386719 22.238281 15.578125 22.070313 15.8125 21.96875 C 15.929688 21.917969 16.054688 21.90625 16.1875 21.90625 Z"},child:[]}]})(n)}const Lh=()=>{const n=_e();return m.jsx(yt,{content:"",children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>{n([{type:"rps"}])},children:m.jsx(Th,{className:"text-2xl"})})})},Ch=()=>{const[n,t]=H.useState(""),e=H.useRef(null),s=_e(),r=i=>{s([{type:"video",data:{file:i}}])};return m.jsxs(m.Fragment,{children:[m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{children:m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",children:m.jsx(yo,{className:"text-xl"})})})})}),m.jsxs(Pt,{className:"flex-row gap-2 p-4",children:[m.jsx(yt,{content:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",onPress:()=>{var i;(i=e==null?void 0:e.current)==null||i.click()},children:m.jsx(xr,{})})}),m.jsxs(Dt,{children:[m.jsx(yt,{content:"",children:m.jsx("div",{className:"max-w-fit",children:m.jsx(Ut,{tooltip:"",children:m.jsx(ot,{className:"text-lg",color:"primary",isIconOnly:!0,variant:"flat",radius:"full",children:m.jsx(Nr,{})})})})}),m.jsxs(Pt,{className:"flex-row gap-1 p-2",children:[m.jsx(Vt,{value:n,onChange:i=>t(i.target.value),placeholder:""}),m.jsx(ot,{color:"primary",variant:"flat",isIconOnly:!0,radius:"full",onPress:()=>{if(!as(n)){cs.error("");return}r(n),t("")},children:m.jsx(Io,{})})]})]})]})]}),m.jsx("input",{type:"file",ref:e,hidden:!0,accept:"video/*",className:"hidden",onChange:i=>{var u;const o=(u=i.target.files)==null?void 0:u[0];if(!o)return;const a=new FileReader;a.readAsDataURL(o),a.onload=h=>{var v;const b=(v=h.target)==null?void 0:v.result;r(b),i.target.value=""}}})]})},Sh=A.import("blots/embed"),Qe=class Qe extends Sh{static create(t){const e=super.create(t);return e.setAttribute("alt",t.alt),e.setAttribute("src",t.src),e.setAttribute("data-id",t.id),e.classList.add(...Qe.classNames),e}static formats(t){return{alt:t.getAttribute("alt")??"",src:t.getAttribute("src")??"",id:t.getAttribute("data-id")??""}}static value(t){return{alt:t.getAttribute("alt")??"",src:t.getAttribute("src")??"",id:t.getAttribute("data-id")??""}}};k(Qe,"blotName","emoji"),k(Qe,"tagName","img"),k(Qe,"classNames",["w-6","h-6"]);let $n=Qe;const qh=A.import("blots/embed"),Je=class Je extends qh{static create(t){const e=super.create();return e.setAttribute("alt",t.alt),e.setAttribute("src",t.src),e.classList.add(...Je.classNames),e}static value(t){return{alt:t.getAttribute("alt")??"",src:t.getAttribute("src")??""}}};k(Je,"blotName","image"),k(Je,"tagName","img"),k(Je,"classNames",["max-w-48","max-h-48","align-bottom"]);let Hn=Je;const kh=A.import("blots/block/embed"),ts=class ts extends kh{static create(t){const e=super.create();e.setAttribute("data-message-id",t.messageId),e.setAttribute("contenteditable","false"),e.classList.add(...ts.classNames);const s=document.createElement("div");s.classList.add("text-sm","text-default-500","relative");const r=document.createElement("div");r.classList.add("w-3","h-3","absolute","top-0","right-0");const i='<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M15.9082 12.3714H20.5982C20.5182 17.0414 19.5982 17.8114 16.7282 19.5114C16.3982 19.7114 16.2882 20.1314 16.4882 20.4714C16.6882 20.8014 17.1082 20.9114 17.4482 20.7114C20.8282 18.7114 22.0082 17.4914 22.0082 11.6714V6.28141C22.0082 4.57141 20.6182 3.19141 18.9182 3.19141H15.9182C14.1582 3.19141 12.8282 4.52141 12.8282 6.28141V9.28141C12.8182 11.0414 14.1482 12.3714 15.9082 12.3714Z" fill="#292D32"></path> <path d="M5.09 12.3714H9.78C9.7 17.0414 8.78 17.8114 5.91 19.5114C5.58 19.7114 5.47 20.1314 5.67 20.4714C5.87 20.8014 6.29 20.9114 6.63 20.7114C10.01 18.7114 11.19 17.4914 11.19 11.6714V6.28141C11.19 4.57141 9.8 3.19141 8.1 3.19141H5.1C3.33 3.19141 2 4.52141 2 6.28141V9.28141C2 11.0414 3.33 12.3714 5.09 12.3714Z" fill="#292D32"></path> </g></svg>';return r.innerHTML=i,s.innerHTML=`ID${t.messageId}`,s.appendChild(r),e.appendChild(s),e}static value(t){return{messageId:t.getAttribute("data-message-id")||""}}};k(ts,"blotName","reply"),k(ts,"tagName","div"),k(ts,"classNames",["p-2","select-none","bg-default-100","rounded-md","pointer-events-none"]);let zn=ts;const Oh=()=>{const n=H.useRef(null),t=_e(),e=["image","emoji","reply"],s={toolbar:"#toolbar"},{quillRef:r,quill:i,Quill:o}=hh({modules:s,formats:e,placeholder:""});o&&!i&&(o.register("formats/emoji",$n),o.register("formats/image",Hn,!0),o.register("formats/reply",zn)),i&&(i.on("selection-change",d=>{var f;if(d){const N=i.getContents().ops[0];typeof(N==null?void 0:N.insert)!="string"&&((f=N==null?void 0:N.insert)!=null&&f.reply)&&d.index===0&&d.length!==i.getLength()&&i.setSelection(1,o.sources.SILENT)}}),i.on("text-change",()=>{var y;const f=i.getContents().ops[0];f&&typeof f.insert!="string"&&((y=f.insert)!=null&&y.reply)&&i.getLength()===1&&i.insertText(1,`
`,o.sources.SILENT)}),i.on("editor-change",d=>{var f;if(d==="text-change"){const N=i.getContents().ops[0];N&&typeof N.insert!="string"&&((f=N.insert)!=null&&f.reply)&&i.getLength()===1&&i.insertText(1,`
`,o.sources.SILENT)}}),i.root.addEventListener("compositionstart",()=>{var y;const f=i.getContents().ops[0];f&&typeof f.insert!="string"&&((y=f.insert)!=null&&y.reply)&&i.getLength()===1&&i.insertText(1,`
`,o.sources.SILENT)}));const a=d=>{if(d){const f=i==null?void 0:i.getSelection();f&&(n.current=f)}},u=d=>{const f=n.current||(i==null?void 0:i.getSelection());i==null||i.deleteText((f==null?void 0:f.index)||0,(f==null?void 0:f.length)||0),i==null||i.insertEmbed((f==null?void 0:f.index)||0,"image",{src:d,alt:""}),i==null||i.setSelection(((f==null?void 0:f.index)||0)+1,0)};function h(d){var L;if(!/^(?:0|(?:-?[1-9]\d*))$/.test(d)){cs.error("ID");return}const y=i==null?void 0:i.getContents(),N=y==null?void 0:y.ops[0],w=i==null?void 0:i.getSelection();if(N&&typeof N.insert!="string"&&((L=N.insert)!=null&&L.reply)){const I=i==null?void 0:i.getContents();I&&(I.ops[0]={insert:{reply:{messageId:d}}},i==null||i.setContents(I,o.sources.USER))}else i==null||i.insertEmbed(0,"reply",{messageId:d},o.sources.USER);i==null||i.setSelection(((w==null?void 0:w.index)||0)+1,0),i==null||i.blur()}const b=d=>{const f=n.current||(i==null?void 0:i.getSelection());i==null||i.deleteText((f==null?void 0:f.index)||0,(f==null?void 0:f.length)||0),i==null||i.insertEmbed((f==null?void 0:f.index)||0,"emoji",{alt:d.alt,src:d.src,id:d.id}),i==null||i.setSelection(((f==null?void 0:f.index)||0)+1,0)},v=()=>{var N;const d=i==null?void 0:i.getContents();return(((N=d==null?void 0:d.ops)==null?void 0:N.filter(w=>w.insert!==`
`))??[]).map(w=>bh(w))};return m.jsxs("div",{children:[m.jsx("div",{ref:r,className:"border border-default-200 rounded-md !mb-2 !text-base !h-64"}),m.jsxs("div",{id:"toolbar",className:"!border-none flex gap-2",children:[m.jsx(Eh,{insertImage:u,onOpenChange:a}),m.jsx(xh,{onInsertEmoji:b,onOpenChange:a}),m.jsx(wh,{insertReply:h}),m.jsx(Nh,{}),m.jsx(yh,{}),m.jsx(Ch,{}),m.jsx(Ah,{}),m.jsx(vh,{}),m.jsx(Lh,{}),m.jsx(ot,{color:"primary",onPress:()=>{const d=v();t(d)},className:"ml-auto",children:"JSON"})]})]})};function gd({children:n}){const{isOpen:t,onOpen:e,onOpenChange:s}=zl();return m.jsxs(m.Fragment,{children:[n?n(e):m.jsx(ot,{onPress:e,color:"primary",radius:"full",variant:"flat",size:"sm",className:"bg-primary/10 text-primary",children:""}),m.jsx(Vl,{size:"4xl",scrollBehavior:"inside",isOpen:t,onOpenChange:s,children:m.jsx(Gl,{children:r=>m.jsxs(m.Fragment,{children:[m.jsx(Kl,{className:"flex flex-col gap-1",children:""}),m.jsx(Zl,{className:"overflow-y-auto",children:m.jsx("div",{className:"overflow-y-auto",children:m.jsx(Oh,{})})}),m.jsx(Wl,{children:m.jsx(ot,{color:"primary",onPress:r,variant:"flat",children:""})})]})})})]})}export{gd as C,kt as O,ad as a,fd as b,hd as c,dd as d,ld as e,cd as f,od as g,ud as h,pd as i,gh as s};
