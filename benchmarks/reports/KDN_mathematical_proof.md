# KDN 扩散算子收敛性建模与推导 (Mathematical Modeling of KDN Convergence)

> **⚠️ 重要声明 (Important Note)**：
> 本文档并非严格意义上的“通用数学证明”，而是一个**基于强假设的收敛性推导**。其核心目的在于通过**数学建模**的方式，论证 KDN 算子在 PeroCore 预设的工程边界（如饱和常数、归一化权重等）内，能够产生稳定的逻辑收敛。
> 
> 在实际工程应用中，拓扑结构的复杂性与参数动态性可能超出本模型的简化假设。因此，本文应被视为对算法设计直觉的数学形式化阐述。

## 1. 模型定义与基本假设 (Model Definition & Hypotheses)

设 $V = \{v_1, v_2, \dots, v_n\}$ 为知识图谱中的节点集合。
设 $\mathbf{s}_t \in [0, C]^{n}$ 为 $t$ 时刻的激活状态向量，其中 $C = 2.0$ 为饱和常数。
邻接矩阵 $W \in [0, 1]^{n \times n}$ 表示节点间的连接强度，$W_{ij}$ 为边 $v_i \to v_j$ 的权重。
扩散衰减因子为 $\gamma \in (0, 1)$。

**假设 1 (归一化假设)**：
为了保证系统的稳定性，假设权重矩阵 $W$ 满足行归一化，即：
$$\forall i, \sum_{j=1}^n W_{ij} \leq 1$$

**假设 2 (正则性假设)**：
假设激活阈值 $\tau$ 不属于系统演化极限值的聚点集，即对所有 $i$，其极限值 $s_i^* \neq \tau$。该假设保证了激活状态在极限附近的离散稳定性。

KDN 状态转移函数 $f: [0, C]^n \to [0, C]^n$ 定义如下：
$$s_{t+1, j} = \min\left( C, s_{t, j} + \gamma \sum_{i \in \mathcal{A}_t} s_{t, i} \cdot W_{ij} \right)$$
其中 $\mathcal{A}_t = \{i \mid s_{t, i} \geq \tau\}$ 是 $t$ 时刻的激活节点集合，$\tau > 0$ 为激活阈值。

---

## 2. 收敛性推导 (Convergence Derivation)

**定理 1 (收敛性推论)**：在上述强假设下，对于任意初始状态 $\mathbf{s}_0 \geq 0$，由 KDN 算子生成的序列 $\{\mathbf{s}_t\}_{t=0}^\infty$ 必收敛。

**证明**：
1. **单调性**：增量项 $\Delta s_{t, j} \geq 0$，故 $s_{t+1, j} \geq s_{t, j}$，序列 $\{\mathbf{s}_t\}$ 单调不减。
2. **有界性**：由 $\min(C, \cdot)$ 定义可知 $s_{t, j} \leq C$。
3. **结论**：根据**单调收敛定理**，每一个分量 $s_{t, j}$ 必存在极限 $s^*_j \leq C$。

**定理 2 (稳定点存在性与极限唯一性)**：对于固定的初始状态 $\mathbf{s}_0$，其演化到达的极限点 $\mathbf{s}^*$ 是算子 $f$ 的不动点，且在该初始条件下唯一。

**证明**：
1. **激活集稳定性**：由于 $s_{t,i}$ 单调递增且收敛于 $s_i^*$：
   - 若 $s_i^* > \tau$，由极限定义可知 $\exists T_i, \forall t > T_i, s_{t,i} > \tau$。
   - 若 $s_i^* < \tau$，由单调性可知 $\forall t, s_{t,i} \leq s_i^* < \tau$。
   - 根据假设 2，$s_i^* \neq \tau$。因此存在有限步 $T = \max \{T_i\}$，使得 $\forall t > T$，激活集 $\mathcal{A}_t$ 恒等于稳定集 $\mathcal{A}^*$。
2. **不动点方程分析**：当 $t > T$ 时，考虑极限状态 $\mathbf{s}^*$：
   - **Case 1: $s_j^* < C$**：此时对于足够大的 $t$，$\min$ 函数取第二项。由 $s_{t+1,j} - s_{t,j} \to 0$ 可知增量项 $\gamma \sum_{i \in \mathcal{A}^*} s_i^* W_{ij} = 0$。
   - **Case 2: $s_j^* = C$**：此时方程变为 $C = \min(C, C + \text{增量})$。由于增量非负，该等式恒成立。
   综上所述，极限点 $\mathbf{s}^*$ 满足 $f(\mathbf{s}^*) = \mathbf{s}^*$。
3. **唯一性**：由于 $f$ 是确定性映射，给定 $\mathbf{s}_0$，其演化轨迹唯一，故极限点 $\mathbf{s}^*$ 唯一。

---

## 3. 结构稳定性分析 (Structural Stability Analysis)

**定理 3 (分段连续依赖性推导)**：定义参数空间 $\Theta = \{(W, \gamma) \mid W \text{ 满足归一化}, \gamma \in (0, 1)\}$。在激活集序列稳定的开集内，稳定点映射 $F: \Theta \to [0, C]^n$ 是分段连续的。

**证明**：
1. **分段线性区域**：在参数空间 $\Theta$ 的子集内，如果参数微扰不改变演化过程中任何节点的激活逻辑判定（即激活模式序列 $\{\mathcal{A}_t\}$ 保持不变），则最终的稳定点 $\mathbf{s}^*$ 是参数 $(W, \gamma)$ 的有限次连续复合函数（在不饱和区域为线性，在饱和区域为常数 $C$）。
2. **量化扰动分析**：设参数扰动为 $(\delta W, \delta \gamma)$。在激活模式不变的开集内，映射 $F$ 具有局部 Lipschitz 连续性。
3. **边界跳变分析**：当参数变化跨越激活阈值 $\tau$ 时，激活集 $\mathcal{A}$ 发生离散改变。然而，由于跳变发生在 $s_i \approx \tau$ 的临界点，且增量项受到 $\gamma$ 的调节，极限点 $\mathbf{s}^*$ 的位移幅度受到 $\mathcal{O}(\delta \gamma \cdot \tau)$ 的限制。因此，映射 $F$ 在参数空间上表现为**分段连续**，不会出现发散性的结构突变。

---

## 4. 讨论与注记 (Discussion & Notes)

- **关于不动点唯一性的补充**：虽然给定 $\mathbf{s}_0$ 极限唯一，但系统可能存在多个不动点。根据算子的单调性（若 $W \geq 0$），若 $\mathbf{s}_0 \leq \mathbf{s}'_0$，则对应的极限点满足 $\mathbf{s}^* \leq \mathbf{s}'^*$。
- **启发式类比**：不同于 Transformer 架构中可能出现的梯度爆炸（乘法累积），KDN 的加性扩散结构（Additive Structure）在本质上更具鲁棒性，扰动在迭代中呈线性或衰减性演化。
- **结论**：KDN 的数学建模确保了在满足上述强假设的情况下，认知扩散过程能够稳定地塌缩至确定的语义表示。这为 PeroCore 的工程实现提供了一种形式化的逻辑支撑，帮助开发者理解算法在极端边界下的行为。
